(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    272145,       5915]
NotebookOptionsPosition[    264039,       5771]
NotebookOutlinePosition[    264435,       5787]
CellTagsIndexPosition[    264392,       5784]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\[OpenCurlyDoubleQuote]Cube\[CloseCurlyDoubleQuote] in Space", "Chapter",
 CellChangeTimes->{{3.828989519346547*^9, 
  3.8289895244772253`*^9}},ExpressionUUID->"818c2ad3-6a9a-4903-ba69-\
c0dd7780c612"],

Cell[CellGroupData[{

Cell["Mesh Representation", "Subsubsection",
 CellChangeTimes->{{3.81904448654601*^9, 3.819044491661377*^9}, {
  3.8195587075161333`*^9, 
  3.819558723143505*^9}},ExpressionUUID->"0cf3efc0-a5a0-49a1-8a99-\
81d7273f1606"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getInitialNormals", "[", 
   RowBox[{"v_", ",", "f_", ",", 
    RowBox[{"returnNorms_", ":", "False"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "faces", ",", "face", ",", "points", ",", "bodyCenter", ",", 
      "faceCenter", ",", "norm", ",", "normals"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"bodyCenter", "=", 
      RowBox[{"Mean", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"normals", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"faces", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Map", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"face", "=", "#"}], ";", "\[IndentingNewLine]", 
         RowBox[{"points", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "face"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"faceCenter", "=", 
          RowBox[{"Mean", "[", "points", "]"}]}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"norm", "=", 
          RowBox[{"Cross", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"points", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"points", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"points", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "-", 
             RowBox[{"points", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"norm", ".", 
             RowBox[{"(", 
              RowBox[{"faceCenter", "-", "bodyCenter"}], ")"}]}], "<", "0"}], 
           ",", 
           RowBox[{
            RowBox[{"norm", "=", 
             RowBox[{"-", "norm"}]}], ";", 
            RowBox[{"face", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"face", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"face", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"face", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"normals", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"normals", ",", 
            RowBox[{"Normalize", "@", "norm"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"faces", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"faces", ",", "face"}], "]"}]}], ";"}], "&"}], ",", "f"}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"returnNorms", ",", "normals", ",", "faces"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.823536762939402*^9, 3.823537067164793*^9}, {
  3.823537403259488*^9, 3.823537534911757*^9}, {3.823537566148038*^9, 
  3.823537569373765*^9}, {3.8286273178360443`*^9, 3.828627334200823*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"57041e54-ee36-440f-92a4-46c3fe028804"],

Cell[BoxData[
 RowBox[{
  RowBox[{"initGetMeshCube", "[", "obj_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "poly", ",", "v", ",", "f", ",", "triangulated", ",", "face", ",", 
      "points", ",", "norm"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"poly", "=", 
      RowBox[{"CanonicalizePolyhedron", "@", 
       RowBox[{"BoundaryDiscretizeGraphics", "@", "obj"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"triangulated", "=", 
      RowBox[{"AugmentedPolyhedron", "[", 
       RowBox[{"poly", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v", ",", "f"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"triangulated", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"triangulated", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"v", ",", 
       RowBox[{"getInitialNormals", "[", 
        RowBox[{"v", ",", "f"}], "]"}]}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.823536590172162*^9, 3.823536601395411*^9}, {
  3.823537158710507*^9, 3.8235373910730143`*^9}, {3.823537616821455*^9, 
  3.823537641749093*^9}, {3.8286263056827087`*^9, 3.828626307591899*^9}, {
  3.828626467592228*^9, 3.828626601615263*^9}, {3.828626654098112*^9, 
  3.828626661805876*^9}, {3.828626828729248*^9, 3.82862684004489*^9}, {
  3.8289895341567717`*^9, 3.82898953483642*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"a844ee21-7da9-4555-b685-9e28ba3f7971"],

Cell[BoxData[
 RowBox[{
  RowBox[{"splitFaceCube", "[", 
   RowBox[{"verts_", ",", "faces_", ",", "faceNum_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "normal", ",", "mid1", ",", "mid2", ",", "mid3", ",", "startPoints", ",",
       "newPoints", ",", "pos", ",", "pos1", ",", "pos2", ",", "pos3", ",", 
      "pnts", ",", "fcs", ",", "face", ",", "newFaces", ",", "newNormal", ",",
       "facePoints", ",", "rotatedFaces", ",", "faceRotated"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"face", "=", 
      RowBox[{"faces", "[", 
       RowBox[{"[", "faceNum", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"startPoints", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"verts", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "face"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"normal", "=", 
      RowBox[{"Normalize", "@", 
       RowBox[{"Cross", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"startPoints", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"startPoints", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"startPoints", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "-", 
          RowBox[{"startPoints", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pos", "=", 
      RowBox[{
       RowBox[{"Length", "[", "verts", "]"}], "+", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"newPoints", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"mid1", "=", 
      RowBox[{"Midpoint", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"startPoints", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"startPoints", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pos1", "=", 
      RowBox[{"Position", "[", 
       RowBox[{"verts", ",", "mid1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"pos1", "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{
        RowBox[{"pos1", "=", "pos"}], ";", 
        RowBox[{"pos", "+=", "1"}], ";", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"newPoints", ",", "mid1"}], "]"}]}], ",", 
       RowBox[{"pos1", "=", 
        RowBox[{"pos1", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mid2", "=", 
      RowBox[{"Midpoint", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"startPoints", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"startPoints", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pos2", "=", 
      RowBox[{"Position", "[", 
       RowBox[{"verts", ",", "mid2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"pos2", "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{
        RowBox[{"pos2", "=", "pos"}], ";", 
        RowBox[{"pos", "+=", "1"}], ";", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"newPoints", ",", "mid2"}], "]"}]}], ",", 
       RowBox[{"pos2", "=", 
        RowBox[{"pos2", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mid3", "=", 
      RowBox[{"Midpoint", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"startPoints", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"startPoints", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pos3", "=", 
      RowBox[{"Position", "[", 
       RowBox[{"verts", ",", "mid3"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"pos3", "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{
        RowBox[{"pos3", "=", "pos"}], ";", 
        RowBox[{"pos", "+=", "1"}], ";", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"newPoints", ",", "mid3"}], "]"}]}], ",", 
       RowBox[{"pos3", "=", 
        RowBox[{"pos3", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pnts", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"verts", ",", "newPoints"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"newFaces", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pos1", ",", "pos2", ",", 
          RowBox[{"face", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"pos2", ",", "pos3", ",", 
          RowBox[{"face", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"pos1", ",", "pos3", ",", 
          RowBox[{"face", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"pos1", ",", "pos2", ",", "pos3"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rotatedFaces", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Map", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"facePoints", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"pnts", "[", 
             RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "#"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"newNormal", "=", 
          RowBox[{"Cross", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"facePoints", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"facePoints", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"facePoints", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "-", 
             RowBox[{"facePoints", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"newNormal", ".", "normal"}], "<", "0"}], ",", 
           RowBox[{"faceRotated", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ",", 
           RowBox[{"faceRotated", "=", "#"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"rotatedFaces", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"rotatedFaces", ",", "faceRotated"}], "]"}]}], ";"}], 
        "&"}], ",", "\[IndentingNewLine]", "newFaces"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"fcs", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"faces", "[", 
         RowBox[{"[", 
          RowBox[{";;", 
           RowBox[{"faceNum", "-", "1"}]}], "]"}], "]"}], ",", "rotatedFaces",
         ",", 
        RowBox[{"faces", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"faceNum", "+", "1"}], ";;"}], "]"}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"pnts", ",", "fcs"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.819560249530175*^9, 3.819560315092955*^9}, {
   3.819560380298793*^9, 3.819560391279855*^9}, 3.819561661064489*^9, {
   3.8195620017547493`*^9, 3.819562008784177*^9}, {3.8195626044476357`*^9, 
   3.8195626219622593`*^9}, {3.8195627273075657`*^9, 
   3.8195628337790937`*^9}, {3.819562876820756*^9, 3.81956297685093*^9}, {
   3.819563110993596*^9, 3.8195632052362413`*^9}, {3.819563298123242*^9, 
   3.819563299943818*^9}, {3.819563953502406*^9, 3.819564019341188*^9}, {
   3.819564103874511*^9, 3.81956413977606*^9}, {3.819564189858914*^9, 
   3.819564206353425*^9}, {3.819564251826889*^9, 3.8195642746121073`*^9}, {
   3.823537986442697*^9, 3.8235382800389023`*^9}, {3.823538310381795*^9, 
   3.8235383741631002`*^9}, {3.82360551457808*^9, 3.823605548888649*^9}, {
   3.8242141432156067`*^9, 3.824214155303772*^9}, {3.824814425965747*^9, 
   3.8248144268433027`*^9}, {3.8289895384738693`*^9, 3.8289895399328537`*^9}},
 
 CellLabel->"In[42]:=",ExpressionUUID->"c7572464-bd93-4893-b3d2-603d04fa3529"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getMeshCube", "[", 
   RowBox[{"verts_", ",", "faces_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"v", ",", "f", ",", "faceNums", ",", "currentFace"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"v", "=", "verts"}], ";", "\[IndentingNewLine]", 
     RowBox[{"f", "=", "faces"}], ";", "\[IndentingNewLine]", 
     RowBox[{"faceNums", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "1", "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"Length", "[", "f", "]"}], "-", "1"}], "]"}], "*", "4"}], 
         "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"v", ",", "f"}], "}"}], "=", 
         RowBox[{"splitFaceCube", "[", 
          RowBox[{"v", ",", "f", ",", "#"}], "]"}]}], ")"}], "&"}], "/@", 
      "faceNums"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"v", ",", "f"}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8195616710930643`*^9, 3.8195618842952127`*^9}, {
   3.8195619515221853`*^9, 3.819561952243141*^9}, {3.819562242184285*^9, 
   3.819562265739326*^9}, {3.8195623185323973`*^9, 3.819562318726082*^9}, {
   3.819563349196451*^9, 3.819563349344304*^9}, {3.819563534318851*^9, 
   3.819563568194632*^9}, {3.8195636366066637`*^9, 3.819563636897043*^9}, {
   3.819564288179378*^9, 3.819564297770349*^9}, {3.819565183669417*^9, 
   3.819565221296962*^9}, 3.8195652886750917`*^9, {3.819565323749537*^9, 
   3.819565334313036*^9}, {3.8235379052961407`*^9, 3.823537959365898*^9}, {
   3.823538381326232*^9, 3.823538382334406*^9}, {3.823605485019412*^9, 
   3.823605495394623*^9}, {3.8289895541243353`*^9, 3.828989564352311*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"a3e000a2-a08e-4266-81ba-c2107912dc04"],

Cell["\<\
The following two functions are not documented in thesis work as they were \
not fully de-bugged. They are mostly functional, but occasionally will not \
equiangulate correctly. Cylinder[] is a good object to see this bug with.\
\>", "Text",
 CellChangeTimes->{{3.8289895762030087`*^9, 
  3.828989654120248*^9}},ExpressionUUID->"26ed7b5a-b5e8-41f4-ba47-\
fad7391bd5ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"toEdges", "[", 
   RowBox[{"verts_", ",", "faces_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "newFaces", ",", "edges", ",", "edgesFace", ",", "facesAsEdges", ",", 
      "edgesFaceO", ",", "signs", ",", "positions", ",", "positionsReverse", 
      ",", "edgesAssociation", ",", "pos", ",", "\[IndentingNewLine]", 
      "face1", ",", "face2", ",", "face1Pos", ",", "face2Pos", ",", "p1", ",",
       "p2", ",", "p3", ",", "p4", ",", "p5", ",", "p6", ",", "a", ",", "b", 
      ",", "c", ",", "d", ",", "e", ",", "points1", ",", "points2", ",", 
      "pos3", ",", "pos4", ",", "normal1", ",", "normal2", ",", "new1", ",", 
      "new2", ",", "facePoints", ",", "edgesInit"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newFaces", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"edges", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"facesAsEdges", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"edgesAssociation", "=", 
      RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"edgesFace", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"faces", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"faces", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"faces", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"faces", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"faces", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"faces", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"edgesFaceO", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"signs", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"positions", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"edges", ",", "#"}], "]"}], "&"}], "/@", "edgesFace"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"positionsReverse", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"edges", ",", 
              RowBox[{"Reverse", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
           "edgesFace"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"pos", "=", 
          RowBox[{"Length", "[", "edges", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"positions", "[", 
               RowBox[{"[", "#", "]"}], "]"}], "\[Equal]", 
              RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"positionsReverse", "[", 
                 RowBox[{"[", "#", "]"}], "]"}], "\[Equal]", 
                RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"edgesFaceO", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"edgesFaceO", ",", 
                   RowBox[{"{", 
                    RowBox[{"edgesFace", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "}"}]}], "]"}]}], ";", 
                RowBox[{"signs", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"signs", ",", 
                   RowBox[{"{", 
                    RowBox[{"pos", "+", "1"}], "}"}]}], "]"}]}], ";", 
                RowBox[{"pos", "+=", "1"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"signs", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{"signs", ",", 
                  RowBox[{"-", 
                   RowBox[{
                    RowBox[{"positionsReverse", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}]}], "]"}], ",",
              "\[IndentingNewLine]", 
             RowBox[{"signs", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"signs", ",", 
                RowBox[{
                 RowBox[{"positions", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "edgesFace", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"edges", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"edges", ",", "edgesFaceO"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"facesAsEdges", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"facesAsEdges", ",", 
            RowBox[{"{", "signs", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"edgesAssociation", "=", 
          RowBox[{"Merge", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"edgesAssociation", ",", 
              RowBox[{"AssociationThread", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Abs", "[", "#", "]"}], "&"}], "/@", "signs"}], 
                 ")"}], "\[Rule]", "#"}], "]"}]}], "}"}], ",", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"Join", "[", "#", "]"}], "]"}], "&"}]}], "]"}]}]}], 
        ")"}], "&"}], "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "faces", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"edges", ",", "facesAsEdges", ",", "edgesAssociation"}], 
      "}"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8286445738313837`*^9, 3.828644606056081*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"efd066c8-6526-4d75-b2b9-1cef3ca0eb24"],

Cell[BoxData[
 RowBox[{
  RowBox[{"equiangulate", "[", 
   RowBox[{"verts_", ",", "faces_", ",", 
    RowBox[{"iter_", ":", "1"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "newFaces", ",", "edges", ",", "facesAsEdges", ",", "edgesAssociation", 
      ",", "\[IndentingNewLine]", "face1", ",", "face2", ",", "face1Pos", ",",
       "face2Pos", ",", "p1", ",", "p2", ",", "p3", ",", "p4", ",", "p5", ",",
       "p6", ",", "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "points1",
       ",", "points2", ",", "pos3", ",", "pos4", ",", "normal1", ",", 
      "normal2", ",", "new1", ",", "new2", ",", "facePoints", ",", 
      "edgesInit"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newFaces", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"edges", ",", "facesAsEdges", ",", "edgesAssociation"}], "}"}],
       "=", 
      RowBox[{"toEdges", "[", 
       RowBox[{"verts", ",", "faces"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"face1", "=", 
            RowBox[{"facesAsEdges", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"edgesAssociation", "[", "#", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"face2", "=", 
            RowBox[{"facesAsEdges", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"edgesAssociation", "[", "#", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"face1Pos", "=", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"#", "<", "0"}], ",", 
                  RowBox[{"Reverse", "[", 
                   RowBox[{"edges", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "#"}], "]"}], "]"}], "]"}], ",", 
                  RowBox[{"edges", "[", 
                   RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "&"}], "/@", 
               "face1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"face2Pos", "=", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"#", "<", "0"}], ",", 
                  RowBox[{"Reverse", "[", 
                   RowBox[{"edges", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "#"}], "]"}], "]"}], "]"}], ",", 
                  RowBox[{"edges", "[", 
                   RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "&"}], "/@", 
               "face2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"points1", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"verts", "[", 
               RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "face1Pos"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"points2", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"verts", "[", 
               RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "face2Pos"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"normal1", "=", 
            RowBox[{"Cross", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"points1", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", 
               RowBox[{"points1", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"points1", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "-", 
               RowBox[{"points1", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"normal2", "=", 
            RowBox[{"Cross", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"points2", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", 
               RowBox[{"points2", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"points2", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "-", 
               RowBox[{"points2", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"p1", "=", 
            RowBox[{"verts", "[", 
             RowBox[{"[", 
              RowBox[{"edges", "[", 
               RowBox[{"[", 
                RowBox[{"#", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"p2", "=", 
            RowBox[{"verts", "[", 
             RowBox[{"[", 
              RowBox[{"edges", "[", 
               RowBox[{"[", 
                RowBox[{"#", ",", "2"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"pos3", "=", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{"face1Pos", ",", 
               RowBox[{"Function", "[", 
                RowBox[{"a", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"verts", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "\[NotEqual]", "p1"}], "&&", 
                  RowBox[{
                   RowBox[{"verts", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "\[NotEqual]", "p2"}]}]}],
                 "]"}]}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"pos4", "=", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{"face2Pos", ",", 
               RowBox[{"Function", "[", 
                RowBox[{"a", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"verts", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "\[NotEqual]", "p1"}], "&&", 
                  RowBox[{
                   RowBox[{"verts", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "\[NotEqual]", "p2"}]}]}],
                 "]"}]}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"p3", "=", 
            RowBox[{"verts", "[", 
             RowBox[{"[", "pos3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"p4", "=", 
            RowBox[{"verts", "[", 
             RowBox[{"[", "pos4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"a", "=", 
            RowBox[{"EuclideanDistance", "[", 
             RowBox[{"p1", ",", "p2"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"b", "=", 
            RowBox[{"EuclideanDistance", "[", 
             RowBox[{"p1", ",", "p3"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"c", "=", 
            RowBox[{"EuclideanDistance", "[", 
             RowBox[{"p2", ",", "p3"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"d", "=", 
            RowBox[{"EuclideanDistance", "[", 
             RowBox[{"p1", ",", "p4"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"e", "=", 
            RowBox[{"EuclideanDistance", "[", 
             RowBox[{"p2", ",", "p4"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"face1", "=", 
            RowBox[{"Select", "[", 
             RowBox[{"face1", ",", 
              RowBox[{"Function", "[", 
               RowBox[{"a", ",", 
                RowBox[{
                 RowBox[{"a", "\[NotEqual]", "#"}], "&&", 
                 RowBox[{"a", "\[NotEqual]", 
                  RowBox[{"-", "#"}]}]}]}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"face2", "=", 
            RowBox[{"Select", "[", 
             RowBox[{"face2", ",", 
              RowBox[{"Function", "[", 
               RowBox[{"a", ",", 
                RowBox[{
                 RowBox[{"a", "\[NotEqual]", "#"}], "&&", 
                 RowBox[{"a", "\[NotEqual]", 
                  RowBox[{"-", "#"}]}]}]}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"b", "^", "2"}], "+", 
                  RowBox[{"c", "^", "2"}], "-", 
                  RowBox[{"a", "^", "2"}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"b", "*", "c"}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"d", "^", "2"}], "+", 
                  RowBox[{"e", "^", "2"}], "-", 
                  RowBox[{"a", "^", "2"}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"d", "*", "e"}], ")"}]}]}], "<", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"DeleteDuplicates", "[", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"edges", "[", 
                    RowBox[{"[", 
                    RowBox[{"face1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"edges", "[", 
                    RowBox[{"[", 
                    RowBox[{"face2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "}"}], 
                    "]"}], "]"}], "]"}], "\[Equal]", "3"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"new1", "=", 
                  RowBox[{"{", 
                   RowBox[{"#", ",", 
                    RowBox[{"face1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"face2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"new2", "=", 
                  RowBox[{"{", 
                   RowBox[{"#", ",", 
                    RowBox[{"face1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"face2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"new1", "=", 
                  RowBox[{"{", 
                   RowBox[{"#", ",", 
                    RowBox[{"face1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"face2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"new2", "=", 
                  RowBox[{"{", 
                   RowBox[{"#", ",", 
                    RowBox[{"face1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"face2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";"}]}], "]"}],
               ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"edges", "=", 
               RowBox[{"ReplacePart", "[", 
                RowBox[{"edges", ",", 
                 RowBox[{"#", "\[Rule]", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{"{", 
                    RowBox[{"pos3", ",", "pos4"}], "}"}], "]"}]}]}], "]"}]}], 
              ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Cross", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"verts", "[", 
                    RowBox[{"[", 
                    RowBox[{"edges", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"new1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "2"}], "]"}], "]"}], 
                    "]"}], "]"}], "-", 
                    RowBox[{"verts", "[", 
                    RowBox[{"[", 
                    RowBox[{"edges", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"new1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "]"}], 
                    "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"verts", "[", 
                    RowBox[{"[", 
                    RowBox[{"edges", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"new1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "2"}], "]"}], "]"}], 
                    "]"}], "]"}], "-", 
                    RowBox[{"verts", "[", 
                    RowBox[{"[", 
                    RowBox[{"edges", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"new1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}], "]"}], 
                    "]"}], "]"}]}]}], "]"}], ".", "normal1"}], "<", "0"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"new1", "=", 
                 RowBox[{"-", "new1"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Cross", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"verts", "[", 
                    RowBox[{"[", 
                    RowBox[{"edges", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"new2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "2"}], "]"}], "]"}], 
                    "]"}], "]"}], "-", 
                    RowBox[{"verts", "[", 
                    RowBox[{"[", 
                    RowBox[{"edges", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"new2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "]"}], 
                    "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"verts", "[", 
                    RowBox[{"[", 
                    RowBox[{"edges", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"new2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "2"}], "]"}], "]"}], 
                    "]"}], "]"}], "-", 
                    RowBox[{"verts", "[", 
                    RowBox[{"[", 
                    RowBox[{"edges", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"new2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}], "]"}], 
                    "]"}], "]"}]}]}], "]"}], ".", "normal2"}], "<", "0"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"new2", "=", 
                 RowBox[{"-", "new2"}]}]}], "]"}], ";", "\[IndentingNewLine]",
               "\[IndentingNewLine]", 
              RowBox[{"facesAsEdges", "=", 
               RowBox[{"ReplacePart", "[", 
                RowBox[{"facesAsEdges", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"edgesAssociation", "[", "#", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", "new1"}], ",", 
                   
                   RowBox[{
                    RowBox[{
                    RowBox[{"edgesAssociation", "[", "#", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[Rule]", "new2"}]}], 
                  "}"}]}], "]"}]}]}]}], "]"}]}], ")"}], "&"}], "/@", 
        RowBox[{"Keys", "[", "edgesAssociation", "]"}]}], ")"}], "/@", 
      RowBox[{"Range", "[", "iter", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"facePoints", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#", "<", "0"}], ",", 
              RowBox[{"Reverse", "[", 
               RowBox[{"edges", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "#"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"edges", "[", 
               RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "&"}], "/@", "#"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"newFaces", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"newFaces", ",", 
            RowBox[{"{", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", "facePoints", "]"}], "]"}], "}"}]}], 
           "]"}]}]}], "\[IndentingNewLine]", ")"}], "&"}], "/@", 
      "facesAsEdges"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "newFaces"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.828544049644343*^9, 3.82854406229254*^9}, {
   3.828544139753883*^9, 3.828544193234514*^9}, {3.828544344175417*^9, 
   3.8285443821186953`*^9}, {3.828550126800507*^9, 3.82855021622189*^9}, {
   3.828617650557869*^9, 3.828617703875578*^9}, {3.828617740750428*^9, 
   3.8286177776612663`*^9}, {3.828618218503696*^9, 3.828618275310795*^9}, {
   3.828618352823358*^9, 3.828618361618099*^9}, {3.82861839457736*^9, 
   3.828618582900975*^9}, {3.828618625268412*^9, 3.828618643599133*^9}, {
   3.828618715655037*^9, 3.828618944037159*^9}, {3.828618975689601*^9, 
   3.828619010982882*^9}, {3.828619059916754*^9, 3.8286190762171926`*^9}, {
   3.82861911088579*^9, 3.8286191606439857`*^9}, {3.828619212271806*^9, 
   3.828619219291695*^9}, {3.828619259584202*^9, 3.828619392551964*^9}, {
   3.8286206119113903`*^9, 3.828620620741653*^9}, {3.828620667624671*^9, 
   3.8286206910764627`*^9}, {3.828620749459381*^9, 3.828620819297193*^9}, {
   3.828620879474062*^9, 3.828620905582293*^9}, {3.828621013548401*^9, 
   3.828621134196072*^9}, {3.828621325426949*^9, 3.828621339588305*^9}, {
   3.828621581729862*^9, 3.828621595694387*^9}, {3.828621639606185*^9, 
   3.828621941788353*^9}, {3.828621974204183*^9, 3.828622304720564*^9}, {
   3.828622622634513*^9, 3.828622634863956*^9}, {3.828622674596992*^9, 
   3.828622717041355*^9}, {3.828622760594054*^9, 3.8286229429082947`*^9}, {
   3.828623151632181*^9, 3.8286231684123173`*^9}, {3.828623293111936*^9, 
   3.828623302648172*^9}, {3.8286233870640707`*^9, 3.828623388332839*^9}, {
   3.828623421839028*^9, 3.828623628200968*^9}, {3.8286236750387907`*^9, 
   3.82862377351997*^9}, {3.8286238572868643`*^9, 3.8286239963049297`*^9}, {
   3.828624028301034*^9, 3.828624036650178*^9}, {3.828624474135277*^9, 
   3.828624609166507*^9}, 3.8286247097444887`*^9, {3.828624739787056*^9, 
   3.828624876186915*^9}, {3.8286249480125933`*^9, 3.8286249597149353`*^9}, {
   3.828624990009267*^9, 3.828625116410845*^9}, {3.828625218533978*^9, 
   3.828625255479364*^9}, {3.8286254237231627`*^9, 3.828625428283477*^9}, {
   3.8286257019779167`*^9, 3.828625753728006*^9}, {3.8286257924975767`*^9, 
   3.828625801486158*^9}, {3.828625867790429*^9, 3.8286258697738934`*^9}, {
   3.828625908515298*^9, 3.828625914613491*^9}, {3.828625954627715*^9, 
   3.828626053783657*^9}, {3.8286260859559*^9, 3.828626119698009*^9}, {
   3.828627743599853*^9, 3.8286277438238983`*^9}, {3.82862777672586*^9, 
   3.828627780563444*^9}, {3.828628392934189*^9, 3.828628393174678*^9}, {
   3.828628558815855*^9, 3.828628560653419*^9}, {3.828628626808523*^9, 
   3.828628665000684*^9}, {3.8286287436208353`*^9, 3.828628763687845*^9}, {
   3.828628868750463*^9, 3.828628899714995*^9}, {3.82862895868646*^9, 
   3.828628974071479*^9}, {3.8286369137279997`*^9, 3.8286369185164948`*^9}, {
   3.828637110947625*^9, 3.8286371308778677`*^9}, {3.828637206106769*^9, 
   3.8286372296665154`*^9}, {3.8286373054132233`*^9, 3.828637333107566*^9}, {
   3.8286373742653713`*^9, 3.828637384400202*^9}, 3.8286375114520197`*^9, {
   3.8286375510783463`*^9, 3.82863768451166*^9}, {3.828637718695735*^9, 
   3.828637721511615*^9}, {3.828637766037483*^9, 3.828637795670136*^9}, {
   3.828637904713676*^9, 3.828637941554885*^9}, {3.8286380519949827`*^9, 
   3.828638072444662*^9}, {3.8286381151272573`*^9, 3.828638183581538*^9}, {
   3.828638260894755*^9, 3.8286383262450857`*^9}, {3.828638591569767*^9, 
   3.8286386224759703`*^9}, {3.828638656741702*^9, 3.8286388902331057`*^9}, {
   3.82863894116995*^9, 3.828639189522807*^9}, {3.828641744801168*^9, 
   3.828641745363999*^9}, {3.8286417856269197`*^9, 3.82864194071455*^9}, {
   3.828641975900654*^9, 3.828642071933948*^9}, {3.82864213945747*^9, 
   3.828642177605069*^9}, {3.8286422199590797`*^9, 3.82864222063603*^9}, {
   3.8286422808376093`*^9, 3.8286422902807493`*^9}, {3.828642322020208*^9, 
   3.82864242929994*^9}, {3.828642556016426*^9, 3.828642726503455*^9}, {
   3.828643061114235*^9, 3.828643111490047*^9}, {3.828643455389769*^9, 
   3.8286435404607162`*^9}, {3.828643583114994*^9, 3.8286435848946943`*^9}, {
   3.828643631106082*^9, 3.8286436339179173`*^9}, {3.828643711339642*^9, 
   3.828643729709374*^9}, {3.828643775501355*^9, 3.828643784863915*^9}, {
   3.828643866177712*^9, 3.828643871057816*^9}, {3.8286439331686697`*^9, 
   3.828643995825254*^9}, {3.8286440450303793`*^9, 3.828644081416258*^9}, {
   3.828644148029416*^9, 3.828644150398058*^9}, {3.828644199173455*^9, 
   3.828644248646702*^9}, {3.828644287729649*^9, 3.828644328579443*^9}, {
   3.828644392532789*^9, 3.828644552566951*^9}, {3.828644737840461*^9, 
   3.8286447935585012`*^9}, {3.82864482755645*^9, 3.8286448277078257`*^9}, {
   3.8286449111791573`*^9, 3.828645063245282*^9}, {3.828645095594656*^9, 
   3.8286450999610977`*^9}, {3.828645145443344*^9, 3.8286452180100203`*^9}, {
   3.8286452779804163`*^9, 3.82864532750134*^9}, {3.8286453593379803`*^9, 
   3.8286453669704742`*^9}, {3.828645398142446*^9, 3.828645462385611*^9}, {
   3.828646303799697*^9, 3.828646333790081*^9}, {3.8286463949090347`*^9, 
   3.8286464407630444`*^9}, {3.828646541818328*^9, 3.828646553760425*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"8a35217b-af0b-4d8d-94db-2860902cf2a4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Shifting Vertices for Surface Tension", "Subsubsection",
 CellChangeTimes->{{3.81904448654601*^9, 3.819044491661377*^9}, {
   3.8190483257512503`*^9, 3.819048329441556*^9}, {3.819647205250242*^9, 
   3.819647231814694*^9}, 
   3.8209283963512573`*^9},ExpressionUUID->"56b99d3d-c174-4a58-8196-\
4073c4c9888b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"forceFaceST", "[", 
   RowBox[{"vert_", ",", "face_", ",", "tension_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "points", ",", "s0", ",", "s1", ",", "s2", ",", "force1", ",", "force2", 
      ",", "force3", ",", "newPoints"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"points", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"vert", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "face"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"s0", "=", 
      RowBox[{
       RowBox[{"points", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "-", 
       RowBox[{"points", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"s1", "=", 
      RowBox[{
       RowBox[{"points", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "-", 
       RowBox[{"points", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"s2", "=", 
      RowBox[{
       RowBox[{"points", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "-", 
       RowBox[{"points", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"force1", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"tension", "/", "2"}], ")"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"s1", "\[Cross]", 
          RowBox[{"(", 
           RowBox[{"s0", "\[Cross]", "s1"}], ")"}]}], ")"}], "/", 
        RowBox[{"Norm", "[", 
         RowBox[{"s0", "\[Cross]", "s1"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"force2", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"tension", "/", "2"}], ")"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"s2", "\[Cross]", 
          RowBox[{"(", 
           RowBox[{"s1", "\[Cross]", "s2"}], ")"}]}], ")"}], "/", 
        RowBox[{"Norm", "[", 
         RowBox[{"s1", "\[Cross]", "s2"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"force3", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"tension", "/", "2"}], ")"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"s0", "\[Cross]", 
          RowBox[{"(", 
           RowBox[{"s2", "\[Cross]", "s0"}], ")"}]}], ")"}], "/", 
        RowBox[{"Norm", "[", 
         RowBox[{"s2", "\[Cross]", "s0"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"force1", ",", "force2", ",", "force3"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}], 
  "                                                                        \
"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.819390500422195*^9, 3.819390511765946*^9}, {
   3.8193905474092607`*^9, 3.819390606510436*^9}, {3.819390647545755*^9, 
   3.819390727834846*^9}, {3.819464266562839*^9, 3.819464313312454*^9}, {
   3.819464379683318*^9, 3.819464402360531*^9}, 3.819464444512651*^9, {
   3.819464477880849*^9, 3.819464528391361*^9}, {3.819464696557127*^9, 
   3.819464719242695*^9}, {3.81946492326989*^9, 3.819464966189288*^9}, {
   3.819465035370701*^9, 3.819465035777342*^9}, {3.819644384307074*^9, 
   3.819644384743355*^9}, {3.819646463846575*^9, 3.8196465259072657`*^9}, {
   3.819646635436021*^9, 3.819646655602879*^9}, {3.819647187793165*^9, 
   3.819647189198566*^9}, {3.819720174378093*^9, 3.819720188229187*^9}, {
   3.819720229029724*^9, 3.819720233887752*^9}, {3.819720347426364*^9, 
   3.819720377151496*^9}, {3.819720466626494*^9, 3.8197204673424597`*^9}, {
   3.81972052801584*^9, 3.8197208580353937`*^9}, {3.8197210915945673`*^9, 
   3.8197210962444277`*^9}, {3.8202495872002373`*^9, 
   3.8202496126006393`*^9}, {3.8202497093707523`*^9, 
   3.8202497165637627`*^9}, {3.820249780840863*^9, 3.820249781082656*^9}, {
   3.82025021167447*^9, 3.8202502180345078`*^9}, {3.825423139222591*^9, 
   3.8254231393556023`*^9}, {3.826019463572729*^9, 3.826019485025635*^9}, {
   3.8262892404963913`*^9, 3.826289251385182*^9}, {3.8289899962488947`*^9, 
   3.828989998251389*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"dd6dd3cc-6174-4d7c-8ceb-2c81d4fb6bc0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"forceAllCube", "[", 
   RowBox[{"verts_", ",", "faces_", ",", "surfaceTension_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "allForces", ",", "currentFaces", ",", "face", ",", "faceForces", ",", 
      "replace"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"currentFaces", "=", "faces"}], ";", "\[IndentingNewLine]", 
     RowBox[{"allForces", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"Length", "[", "verts", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"face", "=", "#"}], ";", "\[IndentingNewLine]", 
         RowBox[{"faceForces", "=", 
          RowBox[{"forceFaceST", "[", 
           RowBox[{"verts", ",", "face", ",", "surfaceTension"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"replace", "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"face", "[", 
               RowBox[{"[", "#", "]"}], "]"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"allForces", "[", 
                 RowBox[{"[", 
                  RowBox[{"face", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "]"}], "]"}], "+", 
                RowBox[{"faceForces", "[", 
                 RowBox[{"[", "#", "]"}], "]"}]}], ")"}]}], "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "face", "]"}], "]"}]}], ")"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"allForces", "=", 
          RowBox[{"ReplacePart", "[", 
           RowBox[{"allForces", ",", "replace"}], "]"}]}]}], ")"}], "&"}], "/@",
       "currentFaces"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "allForces"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8194647374160852`*^9, 3.819464866018523*^9}, {
   3.8194657114096613`*^9, 3.819465845259531*^9}, {3.81964683871098*^9, 
   3.819646864493805*^9}, {3.819647191602586*^9, 3.819647192211535*^9}, {
   3.819720730214663*^9, 3.8197207308989573`*^9}, {3.820249598074744*^9, 
   3.820249686835855*^9}, {3.820249725060898*^9, 3.820249813911943*^9}, {
   3.82024988146497*^9, 3.8202499657863503`*^9}, {3.820250002416689*^9, 
   3.820250011723198*^9}, {3.8202500751807947`*^9, 3.8202501089374723`*^9}, {
   3.820250144108059*^9, 3.820250164289267*^9}, 3.820250865692851*^9, {
   3.827934553631362*^9, 3.8279345587227497`*^9}, {3.8289896892916183`*^9, 
   3.828989689798896*^9}, {3.828990003300963*^9, 3.8289900073435917`*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"f6f6e060-07bc-45ec-aa89-5eaf7c671f86"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Accounting for Volume", "Subsubsection",
 CellChangeTimes->{{3.81904448654601*^9, 3.819044491661377*^9}, {
  3.8190483257512503`*^9, 3.819048329441556*^9}, {3.819647205250242*^9, 
  3.819647231814694*^9}, {3.8209283963512573`*^9, 
  3.820928426015111*^9}},ExpressionUUID->"fff93588-f784-4bde-9d48-\
035b33b74fbb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"volGradFace", "[", 
   RowBox[{"verts_", ",", "face_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "points", ",", "center", ",", "s0", ",", "s1", ",", "s2", ",", "normal", 
      ",", "k", ",", "grad1", ",", "grad2", ",", "grad3", ",", "newPoints"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"points", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"verts", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "face"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"center", "=", 
      RowBox[{"Mean", "[", "points", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"s0", "=", 
      RowBox[{
       RowBox[{"points", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "-", 
       RowBox[{"points", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"s1", "=", 
      RowBox[{
       RowBox[{"points", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "-", 
       RowBox[{"points", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"s2", "=", 
      RowBox[{
       RowBox[{"points", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "-", 
       RowBox[{"points", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"normal", "=", 
      RowBox[{"Normalize", "@", 
       RowBox[{"Cross", "[", 
        RowBox[{"s0", ",", "s1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"k", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"z", "=", 
         RowBox[{"Total", "[", 
          RowBox[{"points", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"grad1", "=", 
         RowBox[{
          RowBox[{"1", "/", "6"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"k", ".", 
               RowBox[{"s0", "\[Cross]", "s1"}]}], ")"}], "k"}], "+", 
            RowBox[{"z", " ", 
             RowBox[{"k", "\[Cross]", "s1"}]}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"grad2", "=", 
         RowBox[{
          RowBox[{"1", "/", "6"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"k", ".", 
               RowBox[{"s1", "\[Cross]", "s2"}]}], ")"}], "k"}], "+", 
            RowBox[{"z", " ", 
             RowBox[{"k", "\[Cross]", "s2"}]}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"grad3", "=", 
         RowBox[{
          RowBox[{"1", "/", "6"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"k", ".", 
               RowBox[{"s2", "\[Cross]", "s0"}]}], ")"}], "k"}], "+", 
            RowBox[{"z", " ", 
             RowBox[{"k", "\[Cross]", "s0"}]}]}], ")"}]}]}], ";"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"grad1", ",", "grad2", ",", "grad3"}], "}"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.819722168343375*^9, 3.8197222081572037`*^9}, {
   3.81972226830477*^9, 3.819722328679311*^9}, {3.819722388397625*^9, 
   3.819722401000588*^9}, {3.819722471280755*^9, 3.819722476138219*^9}, {
   3.819722521401991*^9, 3.819722532586289*^9}, {3.819722929178656*^9, 
   3.819723008933527*^9}, {3.819726823648044*^9, 3.819726836111352*^9}, {
   3.820166731030011*^9, 3.82016673296865*^9}, {3.8202496963828983`*^9, 
   3.8202496976931458`*^9}, {3.820250895139968*^9, 3.820250950522583*^9}, 
   3.820674856444927*^9, {3.820675163487212*^9, 3.8206751813119698`*^9}, {
   3.8206756640581493`*^9, 3.820675674783299*^9}, {3.820675928066092*^9, 
   3.820675930626*^9}, {3.820676053682173*^9, 3.820676084393959*^9}, {
   3.820852449507598*^9, 3.8208524516301203`*^9}, {3.820852584088935*^9, 
   3.82085258517455*^9}, {3.8209293927053013`*^9, 3.820929422879624*^9}, {
   3.82119168905359*^9, 3.821191693018106*^9}, {3.821191798091269*^9, 
   3.821191810707141*^9}, {3.821281553434573*^9, 3.821281643747014*^9}, {
   3.821281679930879*^9, 3.821281684981089*^9}, {3.8213739397796497`*^9, 
   3.8213739906921597`*^9}, {3.821374030211708*^9, 3.821374035439801*^9}, {
   3.8213741728824787`*^9, 3.821374176740137*^9}, {3.821374349542473*^9, 
   3.821374354443555*^9}, {3.821374641234405*^9, 3.821374642593811*^9}, {
   3.821374674276163*^9, 3.821374676309434*^9}, {3.821374747857273*^9, 
   3.821374791514512*^9}, {3.821530579394351*^9, 3.821530583574263*^9}, {
   3.821530663718752*^9, 3.821530666340374*^9}, {3.821530944974948*^9, 
   3.821530990618002*^9}, {3.821531237997208*^9, 3.821531246330909*^9}, 
   3.821531570223237*^9, {3.823000143169982*^9, 3.823000144805561*^9}, {
   3.823000186855339*^9, 3.823000234825651*^9}, {3.8230004201066933`*^9, 
   3.823000420856782*^9}, {3.82300119477361*^9, 3.8230012143147783`*^9}, {
   3.8230016340571413`*^9, 3.823001646233219*^9}, {3.823605349665103*^9, 
   3.823605371825889*^9}, {3.823606320701371*^9, 3.8236063220027647`*^9}, {
   3.823607321481196*^9, 3.823607323510971*^9}, {3.824400443294806*^9, 
   3.824400452485601*^9}, {3.824809385861415*^9, 3.824809386325695*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"fd515b46-42af-4462-9f96-281447306491"],

Cell[BoxData[
 RowBox[{
  RowBox[{"volGradAll", "[", 
   RowBox[{"verts_", ",", "faces_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "totGrads", ",", "grads", ",", "replace", ",", "currentFaces", ",", 
      "initVol", ",", "face"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"totGrads", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"Length", "[", "verts", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"currentFaces", "=", "faces"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"face", "=", "#"}], ";", "\[IndentingNewLine]", 
         RowBox[{"grads", "=", 
          RowBox[{"volGradFace", "[", 
           RowBox[{"verts", ",", "face"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"replace", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"face", "[", 
               RowBox[{"[", "#", "]"}], "]"}], "\[Rule]", 
              RowBox[{
               RowBox[{"totGrads", "[", 
                RowBox[{"[", 
                 RowBox[{"face", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], "]"}], "]"}], "+", 
               RowBox[{"grads", "[", 
                RowBox[{"[", "#", "]"}], "]"}]}]}], ")"}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "face", "]"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"totGrads", "=", 
          RowBox[{"ReplacePart", "[", 
           RowBox[{"totGrads", ",", "replace"}], "]"}]}]}], ")"}], "&"}], "/@",
       "currentFaces"}], ";", "\[IndentingNewLine]", "totGrads"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8201667342272987`*^9, 3.820166752705147*^9}, 
   3.820166797764043*^9, {3.820166873373191*^9, 3.820166890244028*^9}, 
   3.820248802172751*^9, {3.82024916717515*^9, 3.820249425117882*^9}, {
   3.8202495372822227`*^9, 3.820249562772162*^9}, {3.8202507908836727`*^9, 
   3.820250857262196*^9}, {3.820250930114209*^9, 3.8202509323111*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"0bed3e5b-3f93-4423-aa59-b591783ec6ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"volumeRestoringMotionCube", "[", 
   RowBox[{"verts_", ",", "faces_", ",", "startVol_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "excessVol", ",", "gradients", ",", "gradSum", ",", "c", ",", "x", ",", 
      "volRestores"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"excessVol", "=", 
      RowBox[{"startVol", "-", 
       RowBox[{"Volume", "[", 
        RowBox[{"Polyhedron", "[", 
         RowBox[{"verts", ",", "faces"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"gradients", "=", 
      RowBox[{"volGradAll", "[", 
       RowBox[{"verts", ",", "faces"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gradSum", "=", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", ".", "#"}], ")"}], "&"}], "/@", "gradients"}], "]"}]}],
      ";", 
     RowBox[{"(*", 
      RowBox[{
      "should", " ", "these", " ", "be", " ", "different", " ", "vectors", 
       " ", "dotted", " ", 
       RowBox[{"together", "?"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{
       RowBox[{"-", "excessVol"}], "/", "gradSum"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"volRestores", "=", 
      RowBox[{"c", "*", "gradients"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.819721431148143*^9, 3.819721460503042*^9}, {
   3.819721989915131*^9, 3.81972200510172*^9}, {3.819722116533599*^9, 
   3.819722163495233*^9}, {3.8201663828774767`*^9, 3.8201664862304993`*^9}, {
   3.820166559664742*^9, 3.820166565062286*^9}, {3.820166604643173*^9, 
   3.820166612104643*^9}, {3.820249437594046*^9, 3.820249448254757*^9}, {
   3.820250999029499*^9, 3.820251000970632*^9}, {3.820251156111436*^9, 
   3.8202511717160597`*^9}, {3.820255230813793*^9, 3.820255347673717*^9}, {
   3.820255497439487*^9, 3.82025552596383*^9}, {3.820255749813243*^9, 
   3.8202557499143267`*^9}, {3.82025582644514*^9, 3.820255946735765*^9}, {
   3.820255982848517*^9, 3.820255985302642*^9}, {3.82092978546555*^9, 
   3.820929818117425*^9}, {3.821192329472868*^9, 3.821192329897996*^9}, 
   3.821282610731008*^9, 3.821282665989628*^9, {3.8248112076767273`*^9, 
   3.8248112116310167`*^9}, 3.824811465240444*^9, {3.828990069059288*^9, 
   3.828990069556542*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"d312aaa7-2182-487f-89f4-f69cc031b550"],

Cell[BoxData[
 RowBox[{
  RowBox[{"projectedForcesCube", "[", 
   RowBox[{"verts_", ",", "faces_", ",", "surfaceTension_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "gradients", ",", "gradSum", ",", "forces", ",", "forceSum", ",", "a", 
      ",", "x", ",", "projected"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gradients", "=", 
      RowBox[{"volGradAll", "[", 
       RowBox[{"verts", ",", "faces"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gradSum", "=", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#", ".", "#"}], "&"}], "/@", "gradients"}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
      "should", " ", "these", " ", "be", " ", "different", " ", "vectors", 
       " ", "dotted", " ", 
       RowBox[{"together", "?"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"forces", "=", 
      RowBox[{"forceAllCube", "[", 
       RowBox[{"verts", ",", "faces", ",", "surfaceTension"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"forceSum", "=", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"forces", "[", 
           RowBox[{"[", "#", "]"}], "]"}], ".", 
          RowBox[{"gradients", "[", 
           RowBox[{"[", "#", "]"}], "]"}]}], "&"}], "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "forces", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"forceSum", "/", "gradSum"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"projected", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"forces", "[", 
           RowBox[{"[", "#", "]"}], "]"}], "-", 
          RowBox[{"a", "*", 
           RowBox[{"gradients", "[", 
            RowBox[{"[", "#", "]"}], "]"}]}]}], ")"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "forces", "]"}], "]"}]}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.820255531641922*^9, 3.8202555506997232`*^9}, {
  3.820255585053521*^9, 3.8202557458126717`*^9}, {3.8202559640075893`*^9, 
  3.820256028642068*^9}, {3.820256334343005*^9, 3.820256339503187*^9}, {
  3.8206763415832644`*^9, 3.820676347506267*^9}, {3.820929805730789*^9, 
  3.820929822763507*^9}, {3.827934564549838*^9, 3.8279345704340963`*^9}, {
  3.8289897866432333`*^9, 3.828989789553116*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"259d9f3f-113a-4986-8c88-69a97b8f676a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"1", ",", "2", ",", "3"}], "}"}], ".", 
  RowBox[{"{", 
   RowBox[{"1", ",", "2", ",", "3"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.8279364986331053`*^9, 3.827936502662019*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"00ddc38d-189c-490e-9e33-6ac3705624ec"],

Cell[BoxData["14"], "Output",
 CellChangeTimes->{
  3.827936502957877*^9, 3.8280408861610537`*^9, {3.828040949738063*^9, 
   3.828041006780971*^9}, 3.8280410829636793`*^9, {3.8280411466355953`*^9, 
   3.828041168067276*^9}, 3.82804126552378*^9, {3.8280413282702913`*^9, 
   3.8280413417799473`*^9}, {3.8280414493622828`*^9, 3.82804146995751*^9}, {
   3.828041573199456*^9, 3.828041619275816*^9}, 3.8284486510931187`*^9, 
   3.8286190153804903`*^9, 3.828626310568624*^9, 3.8286264760547447`*^9, {
   3.8286265538019953`*^9, 3.828626568556576*^9}, 3.8286266042834053`*^9, 
   3.8286266645501633`*^9, 3.828626842310614*^9, 3.828627747277113*^9, 
   3.8286282687167873`*^9, 3.828646653503428*^9, 3.8286470999780483`*^9, 
   3.8287177325297413`*^9, 3.8289672354976473`*^9, 3.828969926217238*^9, 
   3.8289898776395073`*^9, 3.828990170055794*^9, 3.8289902483473167`*^9},
 CellLabel->"Out[52]=",ExpressionUUID->"e7da5908-fc7e-48d5-a420-bf3db1f80d7f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Iteration", "Subsubsection",
 CellChangeTimes->{{3.81904448654601*^9, 3.819044491661377*^9}, {
   3.8190483257512503`*^9, 3.819048329441556*^9}, {3.819647205250242*^9, 
   3.819647231814694*^9}, 3.8209283963512573`*^9, {3.820928432670466*^9, 
   3.8209284347838*^9}},ExpressionUUID->"45dabb29-5493-4e6f-8079-\
168b8f7d9dc9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"shiftAllCube", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"verts_", ",", "faces_"}], "}"}], ",", "scaleFactor_", ",", 
    "startVol_", ",", "surfaceTension_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"force", ",", "move1", ",", "move2", ",", "totalMove"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"force", "=", 
      RowBox[{"scaleFactor", "*", 
       RowBox[{"projectedForcesCube", "[", 
        RowBox[{"verts", ",", "faces", ",", "surfaceTension"}], "]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"move1", "=", 
      RowBox[{"verts", "+", "force"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"move2", "=", 
      RowBox[{"-", 
       RowBox[{"volumeRestoringMotionCube", "[", 
        RowBox[{"move1", ",", "faces", ",", "startVol"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"totalMove", "=", 
      RowBox[{"move1", "+", "move2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"totalMove", ",", "faces"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8202560883744297`*^9, 3.820256203118259*^9}, {
   3.8206763517770844`*^9, 3.8206763717556963`*^9}, {3.820852334100621*^9, 
   3.82085233513951*^9}, {3.820852723931376*^9, 3.820852725677017*^9}, {
   3.820852996383429*^9, 3.820852999677897*^9}, {3.8212820404802237`*^9, 
   3.821282154082581*^9}, {3.8212822774092283`*^9, 3.821282301040834*^9}, {
   3.821282363427929*^9, 3.8212824380696373`*^9}, {3.821282552196125*^9, 
   3.821282561287612*^9}, 3.821284703479886*^9, {3.821284753326508*^9, 
   3.821284755633376*^9}, {3.821284794075766*^9, 3.821284794350402*^9}, {
   3.8212848495596237`*^9, 3.8212848758203*^9}, {3.8212849785683613`*^9, 
   3.8212849800947237`*^9}, {3.821286127591936*^9, 3.8212861379770727`*^9}, {
   3.822999962223737*^9, 3.8229999627752857`*^9}, {3.823000055476694*^9, 
   3.8230000569599113`*^9}, {3.8242149047180443`*^9, 3.824214905310253*^9}, 
   3.824809338185163*^9, {3.824809747062402*^9, 3.824809767855465*^9}, 
   3.824810746769496*^9, 3.8248107817253227`*^9, 3.8248108153344097`*^9, 
   3.824810864593483*^9, {3.824810897548064*^9, 3.82481089817931*^9}, 
   3.824811147271824*^9, {3.824811218415965*^9, 3.824811227266564*^9}, {
   3.8248118010635033`*^9, 3.8248118916376867`*^9}, {3.824811921931748*^9, 
   3.824811922365155*^9}, 3.8248119787926397`*^9, {3.824814879780611*^9, 
   3.824814880723713*^9}, 3.824815419374634*^9, {3.827934492629116*^9, 
   3.827934496448237*^9}, {3.8279345737968607`*^9, 3.827934574078825*^9}, {
   3.828967232833544*^9, 3.828967233544941*^9}, {3.828989798964398*^9, 
   3.828989805261323*^9}, {3.828990074968401*^9, 3.8289900764060593`*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"443df707-1f10-4107-ad7c-4957454a535c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"energyBodyCube", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"v_", ",", "f_"}], "}"}], ",", "tension_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"SurfaceArea", "[", 
    RowBox[{"Polyhedron", "@@", 
     RowBox[{"{", 
      RowBox[{"v", ",", "f"}], "}"}]}], "]"}], "/", 
   RowBox[{"Volume", "[", 
    RowBox[{"Polyhedron", "@@", 
     RowBox[{"{", 
      RowBox[{"v", ",", "f"}], "}"}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.828038064626368*^9, 3.82803809109638*^9}, {
   3.828038136153883*^9, 3.828038152335352*^9}, {3.828038243447757*^9, 
   3.8280383228548527`*^9}, {3.8280384517975883`*^9, 3.828038628023204*^9}, {
   3.8280386603690233`*^9, 3.82803866047366*^9}, {3.828038698854257*^9, 
   3.828038826488225*^9}, {3.8280408238824863`*^9, 3.8280408376975317`*^9}, 
   3.828041004886488*^9, {3.828041295680128*^9, 3.828041323438394*^9}, {
   3.828989834258106*^9, 3.828989834722145*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"0fb74f3d-f036-4776-810d-5797c03f36af"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iterateCube", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"v_", ",", "f_"}], "}"}], ",", "startVol_", ",", 
    RowBox[{"OptionsPattern", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"scaleFactor", "\[Rule]", ".05"}], ",", 
       RowBox[{"iter", "\[Rule]", "1"}], ",", 
       RowBox[{"tension", "\[Rule]", "1"}], ",", 
       RowBox[{"vTolerance", "\[Rule]", ".001"}]}], "}"}], "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newV", ",", "newF", ",", "oldEnergy", ",", "newEnergy"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newV", ",", "newF"}], "}"}], "=", 
      RowBox[{"shiftAllCube", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v", ",", "f"}], "}"}], ",", 
        RowBox[{"OptionValue", "[", "scaleFactor", "]"}], ",", "startVol", 
        ",", 
        RowBox[{"OptionValue", "[", "tension", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"oldEnergy", "=", 
      RowBox[{"energyBodyCube", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v", ",", "f"}], "}"}], ",", 
        RowBox[{"OptionValue", "[", "tension", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"newEnergy", "=", 
      RowBox[{"energyBodyCube", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"newV", ",", "newF"}], "}"}], ",", 
        RowBox[{"OptionValue", "[", "tension", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"OptionValue", "[", "iter", "]"}], ">", "0"}], ",", 
       RowBox[{"iterateCube", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"newV", ",", "newF"}], "}"}], ",", "startVol", ",", 
         RowBox[{"scaleFactor", "\[Rule]", 
          RowBox[{"OptionValue", "[", "scaleFactor", "]"}]}], ",", 
         RowBox[{"iter", "\[Rule]", 
          RowBox[{
           RowBox[{"OptionValue", "[", "iter", "]"}], "-", "1"}]}], ",", 
         RowBox[{"tension", "\[Rule]", 
          RowBox[{"OptionValue", "[", "tension", "]"}]}], ",", 
         RowBox[{"vTolerance", "\[Rule]", 
          RowBox[{"OptionValue", "[", "vTolerance", "]"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"newEnergy", ">", 
           RowBox[{"oldEnergy", "-", 
            RowBox[{"OptionValue", "[", "vTolerance", "]"}]}]}], "&&", 
          RowBox[{"newEnergy", "<", 
           RowBox[{"oldEnergy", "+", 
            RowBox[{"OptionValue", "[", "vTolerance", "]"}]}]}]}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"v", ",", "f"}], "}"}], ",", 
         RowBox[{"iterateCube", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"newV", ",", "newF"}], "}"}], ",", "startVol", ",", 
           RowBox[{"scaleFactor", "\[Rule]", 
            RowBox[{"OptionValue", "[", "scaleFactor", "]"}]}], ",", 
           RowBox[{"iter", "\[Rule]", 
            RowBox[{"OptionValue", "[", "iter", "]"}]}], ",", 
           RowBox[{"tension", "\[Rule]", 
            RowBox[{"OptionValue", "[", "tension", "]"}]}], ",", 
           RowBox[{"vTolerance", "\[Rule]", 
            RowBox[{"OptionValue", "[", "vTolerance", "]"}]}]}], "]"}]}], 
        "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.824809451962068*^9, 3.8248096932483*^9}, 
   3.824809728541819*^9, 3.824810448820383*^9, 3.824811110807199*^9, {
   3.82481128210227*^9, 3.824811294581511*^9}, 3.8248145147637587`*^9, 
   3.824815283804989*^9, 3.8248153672515717`*^9, {3.827921819642358*^9, 
   3.827921821266448*^9}, {3.827934295374648*^9, 3.8279343781488247`*^9}, {
   3.827934423257831*^9, 3.827934428765682*^9}, {3.827934485102173*^9, 
   3.827934532080207*^9}, {3.828040855274784*^9, 3.8280409212308693`*^9}, {
   3.8280409627135897`*^9, 3.828040976339446*^9}, {3.828041048056292*^9, 
   3.828041073580282*^9}, {3.828041261011856*^9, 3.828041262921249*^9}, {
   3.828041339059125*^9, 3.828041466456781*^9}, {3.828041568519992*^9, 
   3.82804161695506*^9}, {3.828717664077608*^9, 3.828717677770832*^9}, 
   3.828717708920444*^9, {3.8289898357447977`*^9, 3.8289898473735332`*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"98716ddd-8f52-4410-bcaf-7fe183121df6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cube Example", "Subsubsection",
 CellChangeTimes->{{3.8248152485291777`*^9, 3.824815249919959*^9}, {
  3.8289898722118883`*^9, 
  3.8289898727982597`*^9}},ExpressionUUID->"60545c68-3c84-4344-89d5-\
7de2d537ab48"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"obj", "=", 
   RowBox[{"Cube", "[", "]"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tolerance", "=", ".001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"v", ",", "f"}], "}"}], "=", 
   RowBox[{"initGetMeshCube", "[", "obj", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initialVolume", "=", 
   RowBox[{"Volume", "[", 
    RowBox[{"Polyhedron", "@@", 
     RowBox[{"{", 
      RowBox[{"v", ",", "f"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"step1", "=", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{
     RowBox[{"Polyhedron", "@@", 
      RowBox[{"{", 
       RowBox[{"v", ",", "f"}], "}"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", ".7"}], ",", ".7"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", ".7"}], ",", ".7"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", ".7"}], ",", ".7"}], "}"}]}], "}"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"v", ",", "f"}], "}"}], "=", 
   RowBox[{"iterateCube", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v", ",", "f"}], "}"}], ",", "initialVolume"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"step2", "=", 
  RowBox[{"Graphics3D", "[", 
   RowBox[{
    RowBox[{"Polyhedron", "@@", 
     RowBox[{"{", 
      RowBox[{"v", ",", "f"}], "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", ".7"}], ",", ".7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", ".7"}], ",", ".7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", ".7"}], ",", ".7"}], "}"}]}], "}"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"v", ",", "f"}], "}"}], "=", 
   RowBox[{"getMeshCube", "[", 
    RowBox[{"v", ",", "f"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"v", ",", "f"}], "}"}], "=", 
   RowBox[{"iterateCube", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v", ",", "f"}], "}"}], ",", "initialVolume", ",", 
     RowBox[{"scaleFactor", "->", ".1"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"step3", "=", 
  RowBox[{"Graphics3D", "[", 
   RowBox[{
    RowBox[{"Polyhedron", "@@", 
     RowBox[{"{", 
      RowBox[{"v", ",", "f"}], "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", ".7"}], ",", ".7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", ".7"}], ",", ".7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", ".7"}], ",", ".7"}], "}"}]}], "}"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"v", ",", "f"}], "}"}], "=", 
   RowBox[{"getMeshCube", "[", 
    RowBox[{"v", ",", "f"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"v", ",", "f"}], "}"}], "=", 
   RowBox[{"iterateCube", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v", ",", "f"}], "}"}], ",", "initialVolume", ",", 
     RowBox[{"scaleFactor", "->", ".1"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"step4", "=", 
  RowBox[{"Graphics3D", "[", 
   RowBox[{
    RowBox[{"Polyhedron", "@@", 
     RowBox[{"{", 
      RowBox[{"v", ",", "f"}], "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", ".7"}], ",", ".7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", ".7"}], ",", ".7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", ".7"}], ",", ".7"}], "}"}]}], "}"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8202566529516897`*^9, 3.8202566919856663`*^9}, 
   3.820256792655287*^9, 3.8202572627878723`*^9, {3.8202574250765123`*^9, 
   3.820257493759408*^9}, {3.820258158732257*^9, 3.82025822493463*^9}, {
   3.820675191892418*^9, 3.820675253798976*^9}, {3.820675363294653*^9, 
   3.820675394474579*^9}, {3.820675579711392*^9, 3.8206756147098513`*^9}, {
   3.820676095780999*^9, 3.820676101922632*^9}, {3.8206763888070717`*^9, 
   3.820676407790256*^9}, {3.820676443114524*^9, 3.820676443238077*^9}, {
   3.820676794638074*^9, 3.8206767948860083`*^9}, {3.820676831619481*^9, 
   3.820676863780723*^9}, 3.820852179846374*^9, {3.8208523000586357`*^9, 
   3.820852308617324*^9}, {3.8208523422133503`*^9, 3.820852363268197*^9}, {
   3.8208524745951633`*^9, 3.820852501225462*^9}, {3.820852596290237*^9, 
   3.820852596729938*^9}, {3.82085264214128*^9, 3.8208526559756603`*^9}, {
   3.8208538684119377`*^9, 3.8208538686172028`*^9}, {3.8208550094440107`*^9, 
   3.8208550114003353`*^9}, {3.8208550680951157`*^9, 3.820855083405179*^9}, {
   3.820855556149076*^9, 3.820855557534725*^9}, {3.8208591632107897`*^9, 
   3.820859169971287*^9}, {3.820859271312854*^9, 3.820859320097547*^9}, {
   3.820859356385603*^9, 3.820859376023468*^9}, {3.820859563013259*^9, 
   3.8208596583612757`*^9}, {3.820928632501548*^9, 3.820928726243164*^9}, {
   3.820929989771874*^9, 3.820930024443892*^9}, {3.821192479303022*^9, 
   3.821192517236437*^9}, {3.8212794035906267`*^9, 3.821279632899721*^9}, {
   3.821279671272073*^9, 3.821279695798986*^9}, {3.821279735091083*^9, 
   3.821279839410397*^9}, {3.82127987990703*^9, 3.821279895584388*^9}, {
   3.821280002265456*^9, 3.821280002359969*^9}, {3.821280998514889*^9, 
   3.8212810108612423`*^9}, {3.821281045039361*^9, 3.8212810586849623`*^9}, {
   3.8212814422015457`*^9, 3.821281487461522*^9}, {3.821281788716509*^9, 
   3.821281822231297*^9}, {3.8212819179531517`*^9, 3.82128193429692*^9}, {
   3.821530221059534*^9, 3.821530292322084*^9}, {3.8215304511548*^9, 
   3.821530483054681*^9}, {3.821531019867538*^9, 3.821531035049078*^9}, {
   3.821531266983388*^9, 3.821531267232239*^9}, {3.821531304095949*^9, 
   3.8215313738049107`*^9}, {3.8225776212669888`*^9, 3.822577621516759*^9}, {
   3.822578349294783*^9, 3.822578363671851*^9}, {3.822578396912531*^9, 
   3.822578399690667*^9}, {3.822578555883698*^9, 3.822578556860018*^9}, {
   3.822578590097849*^9, 3.822578597965301*^9}, {3.8225786530541477`*^9, 
   3.822578749729951*^9}, 3.82257888787357*^9, 3.8225789251748343`*^9, {
   3.822579002602724*^9, 3.8225790806035967`*^9}, {3.822579122083126*^9, 
   3.822579155171658*^9}, {3.822579248660515*^9, 3.822579263275393*^9}, {
   3.8225793152834263`*^9, 3.8225794223814373`*^9}, {3.822579469287463*^9, 
   3.822579486715478*^9}, {3.822579582642723*^9, 3.822579585081792*^9}, {
   3.822579619785828*^9, 3.822579666763192*^9}, {3.822579699611951*^9, 
   3.82257976284225*^9}, {3.8225798105477953`*^9, 3.822579840523944*^9}, {
   3.822579940245893*^9, 3.822579946732909*^9}, 3.82257998491737*^9, {
   3.822580017013583*^9, 3.8225800331998463`*^9}, {3.8230003726855164`*^9, 
   3.823000406286256*^9}, {3.823000439762891*^9, 3.823000512278216*^9}, {
   3.823605404035084*^9, 3.8236054101745157`*^9}, {3.823605857196456*^9, 
   3.823605875217909*^9}, {3.8236060665784273`*^9, 3.82360616438807*^9}, 
   3.823606196551153*^9, {3.823606243135713*^9, 3.823606243280201*^9}, {
   3.823606439709218*^9, 3.823606468071328*^9}, {3.823606499189307*^9, 
   3.823606521119773*^9}, {3.82360655777043*^9, 3.823606611183384*^9}, {
   3.82360670331703*^9, 3.8236067239606237`*^9}, {3.82360678602295*^9, 
   3.82360678969221*^9}, {3.823606820652409*^9, 3.8236068466148453`*^9}, {
   3.823607051808217*^9, 3.823607076677177*^9}, {3.823607121233717*^9, 
   3.823607129497675*^9}, {3.823607164182527*^9, 3.82360718604184*^9}, {
   3.823607268212598*^9, 3.8236072859860086`*^9}, {3.8237949461383867`*^9, 
   3.823794955295192*^9}, {3.824215120869668*^9, 3.824215126607683*^9}, {
   3.824305093678013*^9, 3.8243051657532253`*^9}, {3.824305262705901*^9, 
   3.824305266279784*^9}, {3.824809449688939*^9, 3.8248094501330976`*^9}, {
   3.824809698869791*^9, 3.824809730671735*^9}, {3.82481004835037*^9, 
   3.8248101078352013`*^9}, {3.824810178175168*^9, 3.824810211107188*^9}, {
   3.82481035711023*^9, 3.8248103588421497`*^9}, {3.824810435609084*^9, 
   3.824810435832616*^9}, {3.824810467705926*^9, 3.824810570903144*^9}, {
   3.824810638967781*^9, 3.8248107207014236`*^9}, {3.8248107574416647`*^9, 
   3.824810759338522*^9}, {3.824810795759466*^9, 3.8248108110795507`*^9}, {
   3.82481091962007*^9, 3.82481099380227*^9}, {3.8248111201563253`*^9, 
   3.824811120378463*^9}, {3.824811261690407*^9, 3.824811308949909*^9}, {
   3.824811882441607*^9, 3.824811882891325*^9}, {3.824811936848382*^9, 
   3.8248119369494677`*^9}, {3.824812031211809*^9, 3.824812033070765*^9}, {
   3.824814467570139*^9, 3.824814498835258*^9}, {3.8248145404184647`*^9, 
   3.824814542027297*^9}, {3.824815076245338*^9, 3.8248151175508842`*^9}, {
   3.8248151483939447`*^9, 3.824815165285357*^9}, 3.8248151991416388`*^9, {
   3.824815334272336*^9, 3.824815356574319*^9}, {3.827930376368609*^9, 
   3.827930378503255*^9}, {3.827934230397233*^9, 3.8279342366136713`*^9}, {
   3.827934444884184*^9, 3.8279344498232737`*^9}, {3.827937715263774*^9, 
   3.8279377259034023`*^9}, {3.827937863315804*^9, 3.827938037777631*^9}, {
   3.8279380944145*^9, 3.8279381302868433`*^9}, {3.828040931631353*^9, 
   3.82804093877696*^9}, {3.82804109080896*^9, 3.828041139223216*^9}, {
   3.828041235465061*^9, 3.828041245053591*^9}, 3.828041629036902*^9, {
   3.8289898678680267`*^9, 3.828989891586182*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"c91f22f1-d8f4-4197-87a7-1b892870328f"],

Cell[BoxData[
 RowBox[{"Cube", "[", "]"}]], "Output",
 CellChangeTimes->{
  3.824816319362626*^9, 3.8248163617630177`*^9, 3.824816431705805*^9, {
   3.827930380815916*^9, 3.8279303868054667`*^9}, {3.827934174763665*^9, 
   3.827934184261916*^9}, {3.827934226303339*^9, 3.827934240488533*^9}, {
   3.827934362509802*^9, 3.82793438110178*^9}, {3.827934431922743*^9, 
   3.827934450288162*^9}, 3.827934577626977*^9, {3.8279377241246567`*^9, 
   3.8279377351013203`*^9}, {3.8279378752148657`*^9, 3.827938038201929*^9}, {
   3.827938094893354*^9, 3.8279381306073427`*^9}, 3.828040886713406*^9, {
   3.828040950233934*^9, 3.82804100729263*^9}, 3.828041083531125*^9, {
   3.8280411398553867`*^9, 3.828041168701001*^9}, {3.828041236599649*^9, 
   3.828041266081463*^9}, {3.8280413288012342`*^9, 3.828041342332512*^9}, {
   3.828041449918159*^9, 3.8280414705001097`*^9}, {3.828041573759803*^9, 
   3.8280416301632757`*^9}, 3.828448651452483*^9, 3.828619015909114*^9, 
   3.828626311078369*^9, 3.828626477449202*^9, {3.828626554186965*^9, 
   3.828626570976777*^9}, 3.82862660528555*^9, 3.828626664933646*^9, 
   3.828626842709158*^9, 3.828627747640174*^9, 3.828628269084446*^9, 
   3.828646653908062*^9, 3.828647100390226*^9, 3.828717732900214*^9, 
   3.828967235818132*^9, 3.828969926678707*^9, {3.828989877678309*^9, 
   3.828989892040045*^9}, 3.828990170098961*^9, 3.828990248394142*^9},
 CellLabel->"Out[56]=",ExpressionUUID->"1e89ad95-eb94-4603-89a6-321b60b84963"],

Cell[BoxData[
 Graphics3DBox[
  TagBox[GraphicsComplex3DBox[CompressedData["
1:eJxTTMoPSmViYGDgA2JmBhh4sB9K2+Pg4xLfTyKNbh4hmpB99gxYAUwezrfH
zyeofz92dRj67AFh2yrf
    "], 
    Polygon3DBox[{{1, 2, 9}, {2, 3, 9}, {3, 4, 9}, {4, 1, 9}, {5, 6, 10}, {6, 
     2, 10}, {2, 1, 10}, {1, 5, 10}, {6, 7, 11}, {7, 3, 11}, {3, 2, 11}, {2, 
     6, 11}, {7, 8, 12}, {8, 4, 12}, {4, 3, 12}, {3, 7, 12}, {8, 5, 13}, {5, 
     1, 13}, {1, 4, 13}, {4, 8, 13}, {8, 7, 14}, {7, 6, 14}, {6, 5, 14}, {5, 
     8, 14}}]],
   "Polyhedron"],
  ImageSize->{300.6511805731832, 286.328293221128},
  ImageSizeRaw->Automatic,
  PlotRange->{{-0.7, 0.7}, {-0.7, 0.7}, {-0.7, 0.7}},
  ViewPoint->{0.8830892584447357, -3.217502391485557, 0.563765662668674},
  ViewVertical->{0.20725090985488737`, -0.6867593811482874, 
   0.696712718966105}]], "Output",
 CellChangeTimes->{
  3.824816319362626*^9, 3.8248163617630177`*^9, 3.824816431705805*^9, {
   3.827930380815916*^9, 3.8279303868054667`*^9}, {3.827934174763665*^9, 
   3.827934184261916*^9}, {3.827934226303339*^9, 3.827934240488533*^9}, {
   3.827934362509802*^9, 3.82793438110178*^9}, {3.827934431922743*^9, 
   3.827934450288162*^9}, 3.827934577626977*^9, {3.8279377241246567`*^9, 
   3.8279377351013203`*^9}, {3.8279378752148657`*^9, 3.827938038201929*^9}, {
   3.827938094893354*^9, 3.8279381306073427`*^9}, 3.828040886713406*^9, {
   3.828040950233934*^9, 3.82804100729263*^9}, 3.828041083531125*^9, {
   3.8280411398553867`*^9, 3.828041168701001*^9}, {3.828041236599649*^9, 
   3.828041266081463*^9}, {3.8280413288012342`*^9, 3.828041342332512*^9}, {
   3.828041449918159*^9, 3.8280414705001097`*^9}, {3.828041573759803*^9, 
   3.8280416301632757`*^9}, 3.828448651452483*^9, 3.828619015909114*^9, 
   3.828626311078369*^9, 3.828626477449202*^9, {3.828626554186965*^9, 
   3.828626570976777*^9}, 3.82862660528555*^9, 3.828626664933646*^9, 
   3.828626842709158*^9, 3.828627747640174*^9, 3.828628269084446*^9, 
   3.828646653908062*^9, 3.828647100390226*^9, 3.828717732900214*^9, 
   3.828967235818132*^9, 3.828969926678707*^9, {3.828989877678309*^9, 
   3.828989892040045*^9}, 3.828990170098961*^9, 3.828990248470186*^9},
 CellLabel->"Out[60]=",ExpressionUUID->"39321961-8787-46ae-8ecb-9249ec525914"],

Cell[BoxData[
 Graphics3DBox[
  TagBox[GraphicsComplex3DBox[CompressedData["
1:eJxTTMoPSmViYGDgA2JmIE6bemDr1FO396dCaHsovR8qbo9Go4vvJ0SnYjef
WBrDXejioZMtdV89CrU58OHO1Rdq5nu+FXfdazJ7ut/xXsylVxstbaB8e/6c
wjT+2Zlw/qyZIOC5p5Vbc1XDvRwbGB+mHyYO40PkI20YD1atNS5MtGFAAzBz
AXodwoA=
    "], 
    Polygon3DBox[{{1, 2, 9}, {2, 3, 9}, {3, 4, 9}, {4, 1, 9}, {5, 6, 10}, {6, 
     2, 10}, {2, 1, 10}, {1, 5, 10}, {6, 7, 11}, {7, 3, 11}, {3, 2, 11}, {2, 
     6, 11}, {7, 8, 12}, {8, 4, 12}, {4, 3, 12}, {3, 7, 12}, {8, 5, 13}, {5, 
     1, 13}, {1, 4, 13}, {4, 8, 13}, {8, 7, 14}, {7, 6, 14}, {6, 5, 14}, {5, 
     8, 14}}]],
   "Polyhedron"],
  ImageSize->{300.6511805731832, 286.328293221128},
  ImageSizeRaw->Automatic,
  PlotRange->{{-0.7, 0.7}, {-0.7, 0.7}, {-0.7, 0.7}},
  ViewPoint->{0.8830892584447357, -3.217502391485557, 0.563765662668674},
  ViewVertical->{0.20725090985488737`, -0.6867593811482874, 
   0.696712718966105}]], "Output",
 CellChangeTimes->{
  3.824816319362626*^9, 3.8248163617630177`*^9, 3.824816431705805*^9, {
   3.827930380815916*^9, 3.8279303868054667`*^9}, {3.827934174763665*^9, 
   3.827934184261916*^9}, {3.827934226303339*^9, 3.827934240488533*^9}, {
   3.827934362509802*^9, 3.82793438110178*^9}, {3.827934431922743*^9, 
   3.827934450288162*^9}, 3.827934577626977*^9, {3.8279377241246567`*^9, 
   3.8279377351013203`*^9}, {3.8279378752148657`*^9, 3.827938038201929*^9}, {
   3.827938094893354*^9, 3.8279381306073427`*^9}, 3.828040886713406*^9, {
   3.828040950233934*^9, 3.82804100729263*^9}, 3.828041083531125*^9, {
   3.8280411398553867`*^9, 3.828041168701001*^9}, {3.828041236599649*^9, 
   3.828041266081463*^9}, {3.8280413288012342`*^9, 3.828041342332512*^9}, {
   3.828041449918159*^9, 3.8280414705001097`*^9}, {3.828041573759803*^9, 
   3.8280416301632757`*^9}, 3.828448651452483*^9, 3.828619015909114*^9, 
   3.828626311078369*^9, 3.828626477449202*^9, {3.828626554186965*^9, 
   3.828626570976777*^9}, 3.82862660528555*^9, 3.828626664933646*^9, 
   3.828626842709158*^9, 3.828627747640174*^9, 3.828628269084446*^9, 
   3.828646653908062*^9, 3.828647100390226*^9, 3.828717732900214*^9, 
   3.828967235818132*^9, 3.828969926678707*^9, {3.828989877678309*^9, 
   3.828989892040045*^9}, 3.828990170098961*^9, 3.828990248737926*^9},
 CellLabel->"Out[62]=",ExpressionUUID->"067a998f-97d0-4a03-a798-ff44e5b7f881"],

Cell[BoxData[
 Graphics3DBox[
  TagBox[GraphicsComplex3DBox[CompressedData["
1:eJxTTMoPSmViYGAwAmJmIK5PezJxQfqN/XUQ2r4WjV+PSsPFofR+mDiaPgzx
WlR99mj2YYijmQPno7tvSdSTMm+BYhuLc0dWzSn0tXlpV6eU/Pjx/gNrkx0c
F+fC+PYm8qL8aocj98D4s2aCgOee+VxWTX9yJGxMjEEgGa5fR9wycfKlSDhf
MnGu1InMgj3flayz2pN9bRjQwAuouay9U0Ve8BTYaOR9NZ0mfddeDULvt9MS
5lRTPGNvD6X9rvxY1av2CCa+3xpNHKrP3sMwoM38fADMvP0w/TB9MPWNhmIM
hVyhe2D2aaDaux9dvTpUXiz5xDwdqeo9ML6pZN6Sw3rxMHPsoeL2NlB7fSH6
7W3R3AETh/kTph8WDq8PLGTY8bFtjx2qP+H6bdHMgfFh/oGZd/eP44Nf3O42
MD40HuF8PzT9tmj2wfgwWh3Vn/sTPDQ+vjJu3QNTDw1vWLjvRxOHy3+c7mwp
gXAH3L22aOFug2Y/TBzNPfD4sWk7ftI0q2MPevzZoboLIz3B3NGZmv5hgrU3
PD59UdXB48sX1R3o4Qbn26C5wxYtfaGHiy+OcPTFHo72ONTDxQFo3w4b
    "], 
    Polygon3DBox[{{16, 15, 2}, {17, 16, 9}, {15, 17, 1}, {15, 16, 17}, {19, 
     18, 3}, {16, 19, 9}, {18, 16, 2}, {18, 19, 16}, {21, 20, 4}, {19, 21, 
     9}, {20, 19, 3}, {20, 21, 19}, {17, 22, 1}, {21, 17, 9}, {22, 21, 4}, {
     22, 17, 21}, {24, 23, 6}, {25, 24, 10}, {23, 25, 5}, {23, 24, 25}, {27, 
     26, 2}, {24, 27, 10}, {26, 24, 6}, {26, 27, 24}, {28, 15, 1}, {27, 28, 
     10}, {15, 27, 2}, {15, 28, 27}, {25, 29, 5}, {28, 25, 10}, {29, 28, 1}, {
     29, 25, 28}, {31, 30, 7}, {32, 31, 11}, {30, 32, 6}, {30, 31, 32}, {34, 
     33, 3}, {31, 34, 11}, {33, 31, 7}, {33, 34, 31}, {35, 18, 2}, {34, 35, 
     11}, {18, 34, 3}, {18, 35, 34}, {32, 26, 6}, {35, 32, 11}, {26, 35, 2}, {
     26, 32, 35}, {37, 36, 8}, {38, 37, 12}, {36, 38, 7}, {36, 37, 38}, {40, 
     39, 4}, {37, 40, 12}, {39, 37, 8}, {39, 40, 37}, {41, 20, 3}, {40, 41, 
     12}, {20, 40, 4}, {20, 41, 40}, {38, 33, 7}, {41, 38, 12}, {33, 41, 3}, {
     33, 38, 41}, {43, 42, 5}, {44, 43, 13}, {42, 44, 8}, {42, 43, 44}, {45, 
     29, 1}, {43, 45, 13}, {29, 43, 5}, {29, 45, 43}, {46, 22, 4}, {45, 46, 
     13}, {22, 45, 1}, {22, 46, 45}, {44, 39, 8}, {46, 44, 13}, {39, 46, 4}, {
     39, 44, 46}, {47, 36, 7}, {48, 47, 14}, {36, 48, 8}, {36, 47, 48}, {49, 
     30, 6}, {47, 49, 14}, {30, 47, 7}, {30, 49, 47}, {50, 23, 5}, {49, 50, 
     14}, {23, 49, 6}, {23, 50, 49}, {48, 42, 8}, {50, 48, 14}, {42, 50, 5}, {
     42, 48, 50}}]],
   "Polyhedron"],
  ImageSize->{300.6511805731832, 286.328293221128},
  ImageSizeRaw->Automatic,
  PlotRange->{{-0.7, 0.7}, {-0.7, 0.7}, {-0.7, 0.7}},
  ViewPoint->{0.8830892584447357, -3.217502391485557, 0.563765662668674},
  ViewVertical->{0.20725090985488737`, -0.6867593811482874, 
   0.696712718966105}]], "Output",
 CellChangeTimes->{
  3.824816319362626*^9, 3.8248163617630177`*^9, 3.824816431705805*^9, {
   3.827930380815916*^9, 3.8279303868054667`*^9}, {3.827934174763665*^9, 
   3.827934184261916*^9}, {3.827934226303339*^9, 3.827934240488533*^9}, {
   3.827934362509802*^9, 3.82793438110178*^9}, {3.827934431922743*^9, 
   3.827934450288162*^9}, 3.827934577626977*^9, {3.8279377241246567`*^9, 
   3.8279377351013203`*^9}, {3.8279378752148657`*^9, 3.827938038201929*^9}, {
   3.827938094893354*^9, 3.8279381306073427`*^9}, 3.828040886713406*^9, {
   3.828040950233934*^9, 3.82804100729263*^9}, 3.828041083531125*^9, {
   3.8280411398553867`*^9, 3.828041168701001*^9}, {3.828041236599649*^9, 
   3.828041266081463*^9}, {3.8280413288012342`*^9, 3.828041342332512*^9}, {
   3.828041449918159*^9, 3.8280414705001097`*^9}, {3.828041573759803*^9, 
   3.8280416301632757`*^9}, 3.828448651452483*^9, 3.828619015909114*^9, 
   3.828626311078369*^9, 3.828626477449202*^9, {3.828626554186965*^9, 
   3.828626570976777*^9}, 3.82862660528555*^9, 3.828626664933646*^9, 
   3.828626842709158*^9, 3.828627747640174*^9, 3.828628269084446*^9, 
   3.828646653908062*^9, 3.828647100390226*^9, 3.828717732900214*^9, 
   3.828967235818132*^9, 3.828969926678707*^9, {3.828989877678309*^9, 
   3.828989892040045*^9}, 3.828990170098961*^9, 3.8289902493086567`*^9},
 CellLabel->"Out[65]=",ExpressionUUID->"ccb5aba8-7450-44fb-9208-02fbff5b98c5"],

Cell[BoxData[
 Graphics3DBox[
  TagBox[GraphicsComplex3DBox[CompressedData["
1:eJx1WH9M1VUUByr7sWZNo8CtH7g2V7hgLZuNr96VQWrweCoINNkU3uO9Bw+U
RFf4DK0sNbdK1jTKzNj0D9cMxGbyrfv4UT2CgsmvORq9oszaykWLH+Jm6Duf
s93D423s7N7vved8zuf8uppUtHmtOy4mJqZ1+u+m6b/B828d2F47qAciUvWL
9aApeZ+kxr64N2O/37ynhL0Z+0IPryU+x3j38Y/jy6wngw8MnOrZYK3+Ykm4
+dCIrgk5Cs+MuqxVkbX6ISdc6Porw6bvqu79679VdsdHezvqGzLs77uu//x8
f6rjs4b3Tq/EfZ246ciCkG+LfXt938rKBU6rdX9DYM+ODVbstaUtCU3bmmFn
/IPDfceCW62pxQ/9M7/4RzUZkdqbd//LVmGnKiVZEMpMV/U/Y1+7xT7dU5c6
D3Q0JRZCn8Z93MP5/55ffrrsrNuGPZz30Tl5/gp9f/ybzN4TtdU21iMb53bv
LXXaEyZ+5SG7+ZH7sM845D7ugYdbnLtCPeVv2l7TT77via4HPDAfi5dt/nfT
gMPCOi7paT2U8Byvoddj6pX7LMlvSN1dl3xyfOB1G+fBn8/kD/v8vWfN2CMf
ZqXYEq9H8F4i7GNf4OH4vDjv02d6f33DFvY5nr5Z8gk4khPrhh+7OQe4ED++
5zXjqr3RedOCNy32Z+DxiXhKHvOj88j5RXnO+Z5H+22VF9blptkqe+yepKYv
+9W9rvy0vwNh7QsXrbl4JqQmLzeuCy4cUuMRqdMDl7+tebhXZZAsv+PgjgeX
Dus7e5uTRx712OtDT6h3G7tU7MnXUif2/KJL7kp+5/cltoJ8JcW3/2rKiHZF
1rpI7LdG8GiHwEP22H4Z2SWcekLgxP0W0gc99F3hHvkH/Yr0a/iVR/6Ely97
yTmn0oJfXtMvDfxZZLedeJ3FLnhlf+ke4/QSPvgzafKvJU61teJY+3S/Jbwa
OMGzW+AEPmkX+KRdnPtK+EW88z2sKQ/03YuqvOdW77OBB3pao8eF/YZdip+K
j5wDXiVwshT5wesb46grYMdEcCjElfhROyO8KOIJUst95JPEg3hIux7yZ0zg
zDLzW4EPfEfdldH9dLPeUH8616w3deVgbXjwcIXtNuuK/ZF2g8Qv6geS4oDv
iBPnS0Z0f/XF6uHxC+edqBNF+PQsfHJ8pX7IeJMfzktZT8g3xDctNX1hwu4K
S+ppMXlmPcg7GQ/wJfsG1n7hP/oI/I+hH+KEeKAuXdHjxHkp8HDeCLsshT+8
lvzCPxF37Sf//CLPIGPN+tG3Db266O2pahv40Q89JKXdoBlHtltKeHG+3ZxL
6HNKzB/G88ep7NH1fVfT8gkX8BAOJfG0mXNG4uS6gH7Mtc7Rii0nztXYOJ9t
9nst6kWLfjUj70Tf4Do/euv8uWePO7lv5pj9Sos5qlzR5yvnjcQDOxRnzlvZ
/yfMfsV+tZn5w375zX6lhX4t59O+rNGqFZcCtpyjJWa/Yru26AOwT32W3zM4
7zD7lfRXe0pu/HiuA59H8Ak8cm45zH7FdtHX8sR7qHygd2PcNbctz7eZcwVr
lWn2H/YT+SPzBpL6oH7qkP+3FcUlFvJ3p8gPjzn/uE+jD8Wb/mjgEXa16D/A
qUX/0aK++P0i8HN+APcnqT9t7/58l4V4FBO+YrOuGZ/Me/nO8gv8yIc4sjsv
K1Bd5i+wcs1+IvnR95H+oBkvjiPyQ5v9BHNbp7V+PfldVbkt+GG88p2GOZYh
+iDmcOTf4QX8DsQ8RJy9Yg6jL8r9NsGXsKvlewdxRd5KnM+Kdxnqgv7fwAJO
b/S8lPoZj8DJdmVewu7aOY1Hj/z5gg37gh9+1wselNQPXiQe8L47NWlbiyuT
/RLnWc//M4hnZg==
    "], Polygon3DBox[CompressedData["
1:eJwNxdciKgAAAFAVZc+sspJVaBgNIyuKMoqylYgokk0hMyqrjGyKFMlWyMiX
3XteDkIgZQuAHh4eSoCHB+j/OdlBuTnA7Nzg7JxcIiGYRPQhkEIIRFIeOSQ/
D0DODyLn5ROyg8mEkGxyUDaBXFgQSikEFVDCCgopxUVhxGKfImJwUTExtyS4
NBdYUhpakltaVBBWUhRcUBJaUFRCLYOWUz3LysPLqOW0ivBimk9FcVgFrZhC
D6ukgOiVUDqlsqIsnF4RVkaHllXQGVUReQxAVV5IFSOPxAyhkXyYtHAmiVZe
HV5T7lldE1FdXsOsCqlmhldVR1Qxq+tqI1l14FpWVG0dq54d1VDvy26IZtc3
cDnRjVwvTmMkh9vIro3isKNrOZG1bE5zE6ylGdjUAm9qbmlrhde3+bbWR7W2
1bPaozpY4PYOWDuro7UJ3t4a1dQOa2ptz+cF8fMBPH4ML58v6IxpE/h2tsE7
BW0tXfCcFmBXTlBXS04nL6arE87rCuJ1dgm7Y7lCr25udLeQ29ATLWjw7RHE
9DQI+L0xIj6gVxTbyxf1dEf39sR098Z29/T298WJ+yF94vi+fvGAJH5wwE8y
mCAZGBySJsiGwFJZnHRIJumLl0oS+qRxfRLpyDBidAQ0PJo4PDI6PpY4MO43
NhA/Nj4gnoifFEMmJhET4smx4cSJsfjhCcTw2ETpVOh0KXBqGjlVOq2QI8cV
fvLxRLlifHQmsXAUNFMYOjNaKJ9CzsgTp2ZCp+QzHbOwoQ7w7FDCbMfQ4FyC
YtBvToGcG1RMK5HN00BlM0w53Tw3m6CcQ84qYbNzyoX5pMUF7/nF5PmFxeWl
5JVl/6WVlKXllVVVytoqRLWWpFpdW5pPVi2lzKuS5pdUGnWqVuOp1qapNdqN
9bTlDf/15eT1jeXFzeStRe/NrdTNxa11ddrmerJ6M1W9vlm5DdVVgrZ1qO1K
3Y4etbHjr99I0+9saHfTqFrPXSp0V0vVb6N29Wnbu9Bt/e7kHmJ1ErK3mrI3
ubqyn7Kz4r+/g9pf2dEZUCM6kGEEYdCN7O+lGPZRewbE3r7h8AB9dOh1cJR+
cHh0cpx+ehJwfJpxfHJ6fpZxce59doE+O784Pkg/O844OEMfHJ+JjLEmEcBo
yjSKTFeXmSdXAZcn6ZdXJ0fmdOGRl1kYaz4SXhozzZfpRnOs8dJccx1hqfG8
tmCuayw3VszVTYD1KtN6c2W6zWSYALeMiFsTw3qNubVmXt9GXFtvt2yp51ve
tvMM29b56V3GzWnA3Q3m7vTGYsdoLJ52TardormzZdjvMDZ7qu3Ovnaf9LAG
uX/A3q89PD1in58CH59xj0/Pry+4hVfvl4Wkl9eFx3vsyyPu/iXp/vFF9hbn
kIHfHPg3mePdiX96D3Q+YZ3vTw8f2P4HyEd/3MdDv/MN/+HEvn3EvTk/Gj8j
XY1en66sz0bX91fW+3fg1zv+6/vd8YOvc4B/6iJ/HHVfn1k/X/jPn8jPr5+L
X/TrhffvK+734vXZjft+DnR/Z7mfv11/WYcur79D9J/r0P2L+3Nn/f6hf91/
/wCtIb0E
     "]]],
   "Polyhedron"],
  ImageSize->{300.6511805731832, 286.328293221128},
  ImageSizeRaw->Automatic,
  PlotRange->{{-0.7, 0.7}, {-0.7, 0.7}, {-0.7, 0.7}},
  ViewPoint->{0.8830892584447357, -3.217502391485557, 0.563765662668674},
  ViewVertical->{0.20725090985488737`, -0.6867593811482874, 
   0.696712718966105}]], "Output",
 CellChangeTimes->{
  3.824816319362626*^9, 3.8248163617630177`*^9, 3.824816431705805*^9, {
   3.827930380815916*^9, 3.8279303868054667`*^9}, {3.827934174763665*^9, 
   3.827934184261916*^9}, {3.827934226303339*^9, 3.827934240488533*^9}, {
   3.827934362509802*^9, 3.82793438110178*^9}, {3.827934431922743*^9, 
   3.827934450288162*^9}, 3.827934577626977*^9, {3.8279377241246567`*^9, 
   3.8279377351013203`*^9}, {3.8279378752148657`*^9, 3.827938038201929*^9}, {
   3.827938094893354*^9, 3.8279381306073427`*^9}, 3.828040886713406*^9, {
   3.828040950233934*^9, 3.82804100729263*^9}, 3.828041083531125*^9, {
   3.8280411398553867`*^9, 3.828041168701001*^9}, {3.828041236599649*^9, 
   3.828041266081463*^9}, {3.8280413288012342`*^9, 3.828041342332512*^9}, {
   3.828041449918159*^9, 3.8280414705001097`*^9}, {3.828041573759803*^9, 
   3.8280416301632757`*^9}, 3.828448651452483*^9, 3.828619015909114*^9, 
   3.828626311078369*^9, 3.828626477449202*^9, {3.828626554186965*^9, 
   3.828626570976777*^9}, 3.82862660528555*^9, 3.828626664933646*^9, 
   3.828626842709158*^9, 3.828627747640174*^9, 3.828628269084446*^9, 
   3.828646653908062*^9, 3.828647100390226*^9, 3.828717732900214*^9, 
   3.828967235818132*^9, 3.828969926678707*^9, {3.828989877678309*^9, 
   3.828989892040045*^9}, 3.828990170098961*^9, 3.828990251251811*^9},
 CellLabel->"Out[68]=",ExpressionUUID->"6795f314-ac5f-47e4-92c6-fe780e23fe78"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mound on a Surface", "Chapter",
 CellChangeTimes->{{3.828989916182476*^9, 
  3.828989922142294*^9}},ExpressionUUID->"820625db-92ca-4aa7-9399-\
8c6b7481f298"],

Cell[CellGroupData[{

Cell["Mesh Representation", "Subsubsection",
 CellChangeTimes->{{3.81904448654601*^9, 3.819044491661377*^9}, {
  3.8195587075161333`*^9, 
  3.819558723143505*^9}},ExpressionUUID->"e34122ed-4a14-4e0c-8af0-\
ff206e27353b"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"getInitialNormals", "[", 
    RowBox[{"v_", ",", "f_", ",", 
     RowBox[{"returnNorms_", ":", "False"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "faces", ",", "face", ",", "points", ",", "bodyCenter", ",", 
       "faceCenter", ",", "norm", ",", "normals"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bodyCenter", "=", 
       RowBox[{"Mean", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"normals", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"faces", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Map", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"face", "=", "#"}], ";", "\[IndentingNewLine]", 
          RowBox[{"points", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"v", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "face"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"faceCenter", "=", 
           RowBox[{"Mean", "[", "points", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"norm", "=", 
           RowBox[{"Cross", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"points", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", 
              RowBox[{"points", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"points", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "-", 
              RowBox[{"points", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"norm", ".", 
              RowBox[{"(", 
               RowBox[{"faceCenter", "-", "bodyCenter"}], ")"}]}], "<", "0"}],
             ",", 
            RowBox[{
             RowBox[{"norm", "=", 
              RowBox[{"-", "norm"}]}], ";", 
             RowBox[{"face", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"face", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"face", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"face", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"normals", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"normals", ",", 
             RowBox[{"Normalize", "@", "norm"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"faces", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"faces", ",", "face"}], "]"}]}], ";"}], "&"}], ",", "f"}],
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"returnNorms", ",", "normals", ",", "faces"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.823536762939402*^9, 3.823537067164793*^9}, {
   3.823537403259488*^9, 3.823537534911757*^9}, {3.823537566148038*^9, 
   3.823537569373765*^9}, 3.8286469435944853`*^9},
 CellLabel->
  "In[123]:=",ExpressionUUID->"99e58367-76ac-4fd4-8920-7ea8dd916e8e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"constraintedPos", "[", 
   RowBox[{"verts_", ",", "faces_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newVerts", ",", "pos", ",", "fs"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newVerts", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pos", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"fs", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"verts", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"pos", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"pos", ",", "#"}], "]"}]}], ";", 
          RowBox[{"newVerts", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"newVerts", ",", "True"}], "]"}]}]}], ",", 
         RowBox[{"newVerts", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"newVerts", ",", "False"}], "]"}]}]}], "]"}], "&"}], "/@", 
      
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "verts", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"AllTrue", "[", 
          RowBox[{
           RowBox[{"faces", "[", 
            RowBox[{"[", "#", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"pos", ",", "#"}], "]"}], "&"}]}], "]"}], ",", 
         RowBox[{"fs", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"fs", ",", "#"}], "]"}]}]}], "]"}], "&"}], "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "faces", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"newVerts", ",", "pos", ",", "fs"}], "}"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8260211178632517`*^9, 3.826021131268034*^9}, {
  3.82602117121348*^9, 3.826021323318015*^9}, {3.8260226156467743`*^9, 
  3.826022625804022*^9}, {3.826207157447001*^9, 3.826207233315864*^9}, {
  3.8262878436672487`*^9, 3.8262878524709682`*^9}, {3.82628794166597*^9, 
  3.826288090147717*^9}, {3.826288276129031*^9, 3.8262882773503637`*^9}, {
  3.827854198441758*^9, 3.827854210390231*^9}, {3.828007190711872*^9, 
  3.828007253168769*^9}, {3.828007540667431*^9, 3.828007547337264*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"c290eddc-7f41-490d-8987-c8e9c0e1e35e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"initGetMeshMound", "[", "obj_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "poly", ",", "v", ",", "f", ",", "triangulated", ",", "newVerts", ",", 
      "cPos", ",", "cF", ",", "cFReformat"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"poly", "=", 
      RowBox[{"CanonicalizePolyhedron", "@", 
       RowBox[{"BoundaryDiscretizeGraphics", "@", "obj"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"triangulated", "=", 
      RowBox[{"AugmentedPolyhedron", "[", 
       RowBox[{"poly", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v", ",", "f"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"triangulated", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"triangulated", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"f", "=", 
      RowBox[{"getInitialNormals", "[", 
       RowBox[{"v", ",", "f"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newVerts", ",", "cPos", ",", "cF"}], "}"}], "=", 
      RowBox[{"constraintedPos", "[", 
       RowBox[{"v", ",", "f"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cFReformat", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "#", "}"}], "&"}], "/@", "cF"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"f", "=", 
      RowBox[{"Delete", "[", 
       RowBox[{"f", ",", "cFReformat"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"{", 
      RowBox[{"v", ",", "newVerts", ",", "f", ",", 
       RowBox[{"cPos", "[", 
        RowBox[{"[", 
         RowBox[{";;", 
          RowBox[{"-", "2"}]}], "]"}], "]"}]}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.823536590172162*^9, 3.823536601395411*^9}, {
   3.823537158710507*^9, 3.8235373910730143`*^9}, {3.823537616821455*^9, 
   3.823537641749093*^9}, {3.826287858012311*^9, 3.826287911222479*^9}, {
   3.8278439818164597`*^9, 3.827843998177989*^9}, {3.8278440429305162`*^9, 
   3.827844043287961*^9}, {3.8278440779359617`*^9, 3.8278441315120897`*^9}, {
   3.8278441677750587`*^9, 3.8278441757028*^9}, {3.827844211566744*^9, 
   3.827844214825922*^9}, {3.827844350104108*^9, 3.827844415242753*^9}, {
   3.8278444551853533`*^9, 3.827844483451869*^9}, {3.827844564239065*^9, 
   3.827844573570804*^9}, {3.827854215493442*^9, 3.827854217941951*^9}, 
   3.827855439217082*^9, {3.828007099912327*^9, 3.8280071009073563`*^9}, {
   3.8280071496312532`*^9, 3.828007150925354*^9}, {3.8280072568024883`*^9, 
   3.828007257883493*^9}, {3.828007291447555*^9, 3.8280073028702507`*^9}, {
   3.828007440074781*^9, 3.8280074405783377`*^9}, {3.8289899483893414`*^9, 
   3.828989948854637*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"6f16e406-ef11-4223-b8dd-9ba97eb828c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"splitFaceMound", "[", 
   RowBox[{
   "verts_", ",", "vConst_", ",", "faces_", ",", "faceNum_", ",", "cPos_", 
    ",", "cNew_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "normal", ",", "mid1", ",", "mid2", ",", "mid3", ",", "startPoints", ",",
       "pointsConst", ",", "newPoints", ",", "pos", ",", "const", ",", 
      "mid1Const", ",", "mid2Const", ",", "mid3Const", ",", "newCPos", ",", 
      "newConst", ",", "pos1", ",", "pos2", ",", "pos3", ",", "pnts", ",", 
      "cnst", ",", "fcs", ",", "face", ",", "newFaces", ",", "newNormal", ",",
       "facePoints", ",", "rotatedFaces", ",", "faceRotated"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"face", "=", 
      RowBox[{"faces", "[", 
       RowBox[{"[", "faceNum", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"startPoints", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"verts", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "face"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pointsConst", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"vConst", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "face"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"normal", "=", 
      RowBox[{"Normalize", "@", 
       RowBox[{"Cross", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"startPoints", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"startPoints", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"startPoints", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "-", 
          RowBox[{"startPoints", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pos", "=", 
      RowBox[{
       RowBox[{"Length", "[", "verts", "]"}], "+", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"newPoints", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newConst", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newCPos", "=", "cNew"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"mid1Const", "=", 
      RowBox[{
       RowBox[{"pointsConst", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "&&", 
       RowBox[{"pointsConst", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mid2Const", "=", 
      RowBox[{
       RowBox[{"pointsConst", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "&&", 
       RowBox[{"pointsConst", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mid3Const", "=", 
      RowBox[{
       RowBox[{"pointsConst", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "&&", 
       RowBox[{"pointsConst", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"mid1", "=", 
      RowBox[{"Midpoint", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"startPoints", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"startPoints", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pos1", "=", 
      RowBox[{"Position", "[", 
       RowBox[{"verts", ",", "mid1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"pos1", "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pos1", "=", "pos"}], ";", 
        RowBox[{"pos", "+=", "1"}], ";", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"newPoints", ",", "mid1"}], "]"}], ";", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"newConst", ",", "mid1Const"}], "]"}]}], ",", 
       RowBox[{"pos1", "=", 
        RowBox[{"pos1", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"mid2", "=", 
      RowBox[{"Midpoint", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"startPoints", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"startPoints", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pos2", "=", 
      RowBox[{"Position", "[", 
       RowBox[{"verts", ",", "mid2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"pos2", "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pos2", "=", "pos"}], ";", 
        RowBox[{"pos", "+=", "1"}], ";", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"newPoints", ",", "mid2"}], "]"}], ";", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"newConst", ",", "mid2Const"}], "]"}]}], ",", 
       RowBox[{"pos2", "=", 
        RowBox[{"pos2", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"mid3", "=", 
      RowBox[{"Midpoint", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"startPoints", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"startPoints", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pos3", "=", 
      RowBox[{"Position", "[", 
       RowBox[{"verts", ",", "mid3"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"pos3", "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pos3", "=", "pos"}], ";", 
        RowBox[{"pos", "+=", "1"}], ";", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"newPoints", ",", "mid3"}], "]"}], ";", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"newConst", ",", "mid3Const"}], "]"}]}], ",", 
       RowBox[{"pos3", "=", 
        RowBox[{"pos3", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"pnts", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"verts", ",", "newPoints"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cnst", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"vConst", ",", "newConst"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"mid1Const", ",", 
       RowBox[{"newCPos", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"cNew", ",", 
          RowBox[{"{", "pos1", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"mid2Const", ",", 
         RowBox[{"newCPos", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"cNew", ",", 
            RowBox[{"{", "pos2", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"mid3Const", ",", 
           RowBox[{"newCPos", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"cNew", ",", 
              RowBox[{"{", "pos3", "}"}]}], "]"}]}]}], "]"}]}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"newFaces", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pos1", ",", "pos2", ",", 
          RowBox[{"face", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"pos2", ",", "pos3", ",", 
          RowBox[{"face", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"pos1", ",", "pos3", ",", 
          RowBox[{"face", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"pos1", ",", "pos2", ",", "pos3"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rotatedFaces", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Map", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"facePoints", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"pnts", "[", 
             RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "#"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"newNormal", "=", 
          RowBox[{"Cross", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"facePoints", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"facePoints", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"facePoints", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "-", 
             RowBox[{"facePoints", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"newNormal", ".", "normal"}], "<", "0"}], ",", 
           RowBox[{"faceRotated", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ",", 
           RowBox[{"faceRotated", "=", "#"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"rotatedFaces", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"rotatedFaces", ",", "faceRotated"}], "]"}]}], ";"}], 
        "&"}], ",", "\[IndentingNewLine]", "newFaces"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"fcs", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"faces", "[", 
         RowBox[{"[", 
          RowBox[{";;", 
           RowBox[{"faceNum", "-", "1"}]}], "]"}], "]"}], ",", "rotatedFaces",
         ",", 
        RowBox[{"faces", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"faceNum", "+", "1"}], ";;"}], "]"}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"pnts", ",", "cnst", ",", "fcs", ",", "cPos", ",", "newCPos"}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.819560249530175*^9, 3.819560315092955*^9}, {
   3.819560380298793*^9, 3.819560391279855*^9}, 3.819561661064489*^9, {
   3.8195620017547493`*^9, 3.819562008784177*^9}, {3.8195626044476357`*^9, 
   3.8195626219622593`*^9}, {3.8195627273075657`*^9, 
   3.8195628337790937`*^9}, {3.819562876820756*^9, 3.81956297685093*^9}, {
   3.819563110993596*^9, 3.8195632052362413`*^9}, {3.819563298123242*^9, 
   3.819563299943818*^9}, {3.819563953502406*^9, 3.819564019341188*^9}, {
   3.819564103874511*^9, 3.81956413977606*^9}, {3.819564189858914*^9, 
   3.819564206353425*^9}, {3.819564251826889*^9, 3.8195642746121073`*^9}, {
   3.823537986442697*^9, 3.8235382800389023`*^9}, {3.823538310381795*^9, 
   3.8235383741631002`*^9}, {3.82360551457808*^9, 3.823605548888649*^9}, {
   3.8242141432156067`*^9, 3.824214155303772*^9}, {3.824814425965747*^9, 
   3.8248144268433027`*^9}, {3.826023259282466*^9, 3.8260233472400503`*^9}, {
   3.82602394879609*^9, 3.8260242268421507`*^9}, {3.826025379398959*^9, 
   3.82602538287528*^9}, {3.826025452957724*^9, 3.826025453222025*^9}, {
   3.8260255373669252`*^9, 3.826025573787271*^9}, {3.8260257737498693`*^9, 
   3.8260257972767477`*^9}, {3.8262873646992197`*^9, 3.826287462997468*^9}, {
   3.826287793123576*^9, 3.826287797490803*^9}, {3.826288304369582*^9, 
   3.826288336028329*^9}, {3.826288418739423*^9, 3.826288431958901*^9}, {
   3.826288463868556*^9, 3.8262884926456003`*^9}, {3.826288538732342*^9, 
   3.8262886569999523`*^9}, {3.826288985392438*^9, 3.826288986756609*^9}, {
   3.8278446426638403`*^9, 3.8278446427998333`*^9}, {3.827844766663698*^9, 
   3.827844767907769*^9}, {3.827844893570347*^9, 3.827844894397875*^9}, {
   3.82784493368828*^9, 3.8278450559205*^9}, {3.827845136872006*^9, 
   3.827845141820016*^9}, {3.82784527388694*^9, 3.8278454854448433`*^9}, {
   3.8278455471836843`*^9, 3.8278455501984386`*^9}, {3.8278455951943483`*^9, 
   3.827845652919785*^9}, {3.827845707577816*^9, 3.827845785127625*^9}, {
   3.8278458504880857`*^9, 3.8278458506847*^9}, {3.827846157378571*^9, 
   3.827846265788782*^9}, {3.827846357181459*^9, 3.827846358270587*^9}, {
   3.82784653887062*^9, 3.8278465652428417`*^9}, {3.827846669614832*^9, 
   3.827846684541403*^9}, {3.827846729675583*^9, 3.827846798106968*^9}, {
   3.827846946535224*^9, 3.827846948158091*^9}, {3.827847029172422*^9, 
   3.827847051323206*^9}, {3.82784711454436*^9, 3.827847116798712*^9}, {
   3.827847173933506*^9, 3.82784717868952*^9}, {3.8278472568217773`*^9, 
   3.8278472572071667`*^9}, {3.827847289866521*^9, 3.827847290415842*^9}, {
   3.828007314766131*^9, 3.8280073148281527`*^9}, {3.82800739188645*^9, 
   3.8280074011441*^9}, {3.828007450842512*^9, 3.828007470544405*^9}, {
   3.828007508608306*^9, 3.828007522075027*^9}, {3.828007570338776*^9, 
   3.8280076135331182`*^9}, {3.828007665724475*^9, 3.828007684220402*^9}, 
   3.828007740627512*^9, {3.828007772841857*^9, 3.828007956934239*^9}, {
   3.828008090341927*^9, 3.828008103274666*^9}, {3.828009409345978*^9, 
   3.828009409442547*^9}, {3.828989951220653*^9, 3.828989951743463*^9}},
 CellLabel->
  "In[126]:=",ExpressionUUID->"6ce00081-2d6e-44fc-a9c1-f70c490c5a40"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getMeshMound", "[", 
   RowBox[{"verts_", ",", "vConst_", ",", "faces_", ",", "cPos_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "v", ",", "f", ",", "ct", ",", "cP", ",", "c", ",", "faceNums", ",", 
      "cVs", ",", "edges", ",", "cPosMids", ",", "sortedC"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"v", "=", "verts"}], ";", "\[IndentingNewLine]", 
     RowBox[{"f", "=", "faces"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ct", "=", "vConst"}], ";", "\[IndentingNewLine]", 
     RowBox[{"cP", "=", "cPos"}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"faceNums", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "1", "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"Length", "[", "f", "]"}], "-", "1"}], "]"}], "*", "4"}], 
         "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"v", ",", "ct", ",", "f", ",", "cP", ",", "c"}], "}"}], "=", 
         RowBox[{"splitFaceMound", "[", 
          RowBox[{"v", ",", "ct", ",", "f", ",", "#", ",", "cPos", ",", "c"}],
           "]"}]}], ")"}], "&"}], "/@", "faceNums"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"cVs", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"verts", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "cP"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"edges", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"cVs", ",", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"cVs", "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;", 
              RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"cVs", "[", 
            RowBox[{"[", 
             RowBox[{";;", "1"}], "]"}], "]"}]}], "]"}]}], "}"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"cPosMids", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Mean", "[", "#", "]"}], "&"}], "/@", "edges"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sortedC", "=", 
      RowBox[{"SortBy", "[", 
       RowBox[{"c", ",", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"cPosMids", ",", 
           RowBox[{"v", "[", 
            RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{"cP", "=", 
       RowBox[{"Riffle", "[", 
        RowBox[{"cP", ",", "sortedC"}], "]"}]}], ")"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"v", ",", "ct", ",", "f", ",", "cP"}], "}"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8195616710930643`*^9, 3.8195618842952127`*^9}, {
   3.8195619515221853`*^9, 3.819561952243141*^9}, {3.819562242184285*^9, 
   3.819562265739326*^9}, {3.8195623185323973`*^9, 3.819562318726082*^9}, {
   3.819563349196451*^9, 3.819563349344304*^9}, {3.819563534318851*^9, 
   3.819563568194632*^9}, {3.8195636366066637`*^9, 3.819563636897043*^9}, {
   3.819564288179378*^9, 3.819564297770349*^9}, {3.819565183669417*^9, 
   3.819565221296962*^9}, 3.8195652886750917`*^9, {3.819565323749537*^9, 
   3.819565334313036*^9}, {3.8235379052961407`*^9, 3.823537959365898*^9}, {
   3.823538381326232*^9, 3.823538382334406*^9}, {3.823605485019412*^9, 
   3.823605495394623*^9}, {3.826024253613491*^9, 3.826024271219202*^9}, {
   3.826025655849286*^9, 3.826025690221113*^9}, {3.8262885059107637`*^9, 
   3.826288515680626*^9}, {3.826288682595778*^9, 3.826288688128455*^9}, {
   3.8278446450448427`*^9, 3.827844647613557*^9}, {3.8278458664346437`*^9, 
   3.827845866584935*^9}, {3.827846271591301*^9, 3.8278463103453417`*^9}, {
   3.827846348255934*^9, 3.827846352771881*^9}, {3.827846386286693*^9, 
   3.8278463901383467`*^9}, {3.827846826557863*^9, 3.8278468849036903`*^9}, {
   3.827846924608492*^9, 3.827846926551757*^9}, {3.827847283386331*^9, 
   3.827847284728443*^9}, {3.828007964237749*^9, 3.8280080065743237`*^9}, {
   3.8280322569442387`*^9, 3.828032263232163*^9}, {3.828033457886161*^9, 
   3.828033727967984*^9}, {3.828033776495969*^9, 3.828033777935959*^9}, 
   3.8280338188717117`*^9, {3.82803560970277*^9, 3.828035626095517*^9}, {
   3.828035666819833*^9, 3.82803567488913*^9}, {3.82803573203436*^9, 
   3.8280357658362083`*^9}, {3.828035817141686*^9, 3.828035818488785*^9}, {
   3.828035849169051*^9, 3.828035927617288*^9}, {3.828989956551066*^9, 
   3.828989960950345*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"b1465758-fd8f-489d-acad-817d5f8c03f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"meshedPoly", "[", 
   RowBox[{"v_", ",", "f_", ",", "cPos_"}], "]"}], ":=", 
  RowBox[{"Polyhedron", "[", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{"v", ",", 
      RowBox[{"{", 
       RowBox[{"Mean", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "cPos"}], "]"}], 
       "}"}]}], "]"}], ",", 
    RowBox[{"Join", "[", 
     RowBox[{"f", ",", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"cPos", "[", 
             RowBox[{"[", "#", "]"}], "]"}], ",", 
            RowBox[{"cPos", "[", 
             RowBox[{"[", 
              RowBox[{"#", "+", "1"}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"Length", "[", "v", "]"}], "+", "1"}]}], "}"}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"Length", "[", "cPos", "]"}], "-", "1"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"cPos", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}], ",", 
           RowBox[{"cPos", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"Length", "[", "v", "]"}], "+", "1"}]}], "}"}], "}"}]}], 
       "]"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.827858468232153*^9, 3.82785848374104*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"692f4030-bb90-4d2f-9089-0fa8ff8f6b76"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"toEdges", "[", 
    RowBox[{"verts_", ",", "faces_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "newFaces", ",", "edges", ",", "edgesFace", ",", "facesAsEdges", ",", 
       "edgesFaceO", ",", "signs", ",", "positions", ",", "positionsReverse", 
       ",", "edgesAssociation", ",", "pos", ",", "\[IndentingNewLine]", 
       "face1", ",", "face2", ",", "face1Pos", ",", "face2Pos", ",", "p1", 
       ",", "p2", ",", "p3", ",", "p4", ",", "p5", ",", "p6", ",", "a", ",", 
       "b", ",", "c", ",", "d", ",", "e", ",", "points1", ",", "points2", ",",
        "pos3", ",", "pos4", ",", "normal1", ",", "normal2", ",", "new1", ",",
        "new2", ",", "facePoints", ",", "edgesInit"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newFaces", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"edges", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"facesAsEdges", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"edgesAssociation", "=", 
       RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"edgesFace", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"faces", "[", 
                 RowBox[{"[", "#", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"faces", "[", 
                 RowBox[{"[", "#", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"faces", "[", 
                 RowBox[{"[", "#", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"faces", "[", 
                 RowBox[{"[", "#", "]"}], "]"}], "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"faces", "[", 
                 RowBox[{"[", "#", "]"}], "]"}], "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"faces", "[", 
                 RowBox[{"[", "#", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"edgesFaceO", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"signs", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"positions", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"edges", ",", "#"}], "]"}], "&"}], "/@", 
            "edgesFace"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"positionsReverse", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"edges", ",", 
               RowBox[{"Reverse", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
            "edgesFace"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"pos", "=", 
           RowBox[{"Length", "[", "edges", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"positions", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "\[Equal]", 
               RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"positionsReverse", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], "\[Equal]", 
                 RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"edgesFaceO", "=", 
                  RowBox[{"Join", "[", 
                   RowBox[{"edgesFaceO", ",", 
                    RowBox[{"{", 
                    RowBox[{"edgesFace", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "}"}]}], "]"}]}], ";", 
                 RowBox[{"signs", "=", 
                  RowBox[{"Join", "[", 
                   RowBox[{"signs", ",", 
                    RowBox[{"{", 
                    RowBox[{"pos", "+", "1"}], "}"}]}], "]"}]}], ";", 
                 RowBox[{"pos", "+=", "1"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"signs", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"signs", ",", 
                   RowBox[{"-", 
                    RowBox[{
                    RowBox[{"positionsReverse", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}]}], "]"}], ",",
               "\[IndentingNewLine]", 
              RowBox[{"signs", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"signs", ",", 
                 RowBox[{
                  RowBox[{"positions", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "edgesFace", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"edges", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"edges", ",", "edgesFaceO"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"facesAsEdges", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"facesAsEdges", ",", 
             RowBox[{"{", "signs", "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"edgesAssociation", "=", 
           RowBox[{"Merge", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"edgesAssociation", ",", 
               RowBox[{"AssociationThread", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Abs", "[", "#", "]"}], "&"}], "/@", "signs"}], 
                  ")"}], "\[Rule]", "#"}], "]"}]}], "}"}], ",", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"Join", "[", "#", "]"}], "]"}], "&"}]}], "]"}]}]}], 
         ")"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "faces", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"edges", ",", "facesAsEdges", ",", "edgesAssociation"}], 
       "}"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8286445738313837`*^9, 3.828644606056081*^9}},
 CellLabel->
  "In[129]:=",ExpressionUUID->"53b752cf-6e34-40a3-a697-cfd7dbc06ca1"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"equiangulate", "[", 
    RowBox[{"verts_", ",", "faces_", ",", 
     RowBox[{"iter_", ":", "1"}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "newFaces", ",", "edges", ",", "facesAsEdges", ",", "edgesAssociation", 
       ",", "\[IndentingNewLine]", "face1", ",", "face2", ",", "face1Pos", 
       ",", "face2Pos", ",", "p1", ",", "p2", ",", "p3", ",", "p4", ",", "p5",
        ",", "p6", ",", "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", 
       "points1", ",", "points2", ",", "pos3", ",", "pos4", ",", "normal1", 
       ",", "normal2", ",", "new1", ",", "new2", ",", "facePoints", ",", 
       "edgesInit"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newFaces", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"edges", ",", "facesAsEdges", ",", "edgesAssociation"}], 
        "}"}], "=", 
       RowBox[{"toEdges", "[", 
        RowBox[{"verts", ",", "faces"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{"edgesAssociation", "[", "#", "]"}], "\[Equal]", "1"}],
               "]"}], ",", "Nothing", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"face1", "=", 
               RowBox[{"facesAsEdges", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"edgesAssociation", "[", "#", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"face2", "=", 
               RowBox[{"facesAsEdges", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"edgesAssociation", "[", "#", "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"face1Pos", "=", 
               RowBox[{"DeleteDuplicates", "[", 
                RowBox[{"Flatten", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#", "<", "0"}], ",", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"edges", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "#"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"edges", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "&"}], "/@", 
                  "face1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"face2Pos", "=", 
               RowBox[{"DeleteDuplicates", "[", 
                RowBox[{"Flatten", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#", "<", "0"}], ",", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"edges", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "#"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"edges", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "&"}], "/@", 
                  "face2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"points1", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"verts", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "face1Pos"}]}],
               ";", "\[IndentingNewLine]", 
              RowBox[{"points2", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"verts", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "face2Pos"}]}],
               ";", "\[IndentingNewLine]", 
              RowBox[{"normal1", "=", 
               RowBox[{"Cross", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"points1", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"points1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"points1", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "-", 
                  RowBox[{"points1", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"normal2", "=", 
               RowBox[{"Cross", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"points2", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"points2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"points2", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "-", 
                  RowBox[{"points2", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"p1", "=", 
               RowBox[{"verts", "[", 
                RowBox[{"[", 
                 RowBox[{"edges", "[", 
                  RowBox[{"[", 
                   RowBox[{"#", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"p2", "=", 
               RowBox[{"verts", "[", 
                RowBox[{"[", 
                 RowBox[{"edges", "[", 
                  RowBox[{"[", 
                   RowBox[{"#", ",", "2"}], "]"}], "]"}], "]"}], "]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"pos3", "=", 
               RowBox[{
                RowBox[{"Select", "[", 
                 RowBox[{"face1Pos", ",", 
                  RowBox[{"Function", "[", 
                   RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"verts", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "\[NotEqual]", "p1"}], "&&", 
                    RowBox[{
                    RowBox[{"verts", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "\[NotEqual]", "p2"}]}]}],
                    "]"}]}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"pos4", "=", 
               RowBox[{
                RowBox[{"Select", "[", 
                 RowBox[{"face2Pos", ",", 
                  RowBox[{"Function", "[", 
                   RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"verts", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "\[NotEqual]", "p1"}], "&&", 
                    RowBox[{
                    RowBox[{"verts", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "\[NotEqual]", "p2"}]}]}],
                    "]"}]}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"p3", "=", 
               RowBox[{"verts", "[", 
                RowBox[{"[", "pos3", "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"p4", "=", 
               RowBox[{"verts", "[", 
                RowBox[{"[", "pos4", "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"a", "=", 
               RowBox[{"EuclideanDistance", "[", 
                RowBox[{"p1", ",", "p2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"b", "=", 
               RowBox[{"EuclideanDistance", "[", 
                RowBox[{"p1", ",", "p3"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"c", "=", 
               RowBox[{"EuclideanDistance", "[", 
                RowBox[{"p2", ",", "p3"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"d", "=", 
               RowBox[{"EuclideanDistance", "[", 
                RowBox[{"p1", ",", "p4"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"e", "=", 
               RowBox[{"EuclideanDistance", "[", 
                RowBox[{"p2", ",", "p4"}], "]"}]}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"face1", "=", 
               RowBox[{"Select", "[", 
                RowBox[{"face1", ",", 
                 RowBox[{"Function", "[", 
                  RowBox[{"a", ",", 
                   RowBox[{
                    RowBox[{"a", "\[NotEqual]", "#"}], "&&", 
                    RowBox[{"a", "\[NotEqual]", 
                    RowBox[{"-", "#"}]}]}]}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"face2", "=", 
               RowBox[{"Select", "[", 
                RowBox[{"face2", ",", 
                 RowBox[{"Function", "[", 
                  RowBox[{"a", ",", 
                   RowBox[{
                    RowBox[{"a", "\[NotEqual]", "#"}], "&&", 
                    RowBox[{"a", "\[NotEqual]", 
                    RowBox[{"-", "#"}]}]}]}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "^", "2"}], "+", 
                    RowBox[{"c", "^", "2"}], "-", 
                    RowBox[{"a", "^", "2"}]}], ")"}], "/", 
                   RowBox[{"(", 
                    RowBox[{"b", "*", "c"}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"d", "^", "2"}], "+", 
                    RowBox[{"e", "^", "2"}], "-", 
                    RowBox[{"a", "^", "2"}]}], ")"}], "/", 
                   RowBox[{"(", 
                    RowBox[{"d", "*", "e"}], ")"}]}]}], "<", "0"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"DeleteDuplicates", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"edges", "[", 
                    RowBox[{"[", 
                    RowBox[{"face1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"edges", "[", 
                    RowBox[{"[", 
                    RowBox[{"face2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "}"}], 
                    "]"}], "]"}], "]"}], "\[Equal]", "3"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"new1", "=", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"face1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"face2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"new2", "=", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"face1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"face2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"new1", "=", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"face1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"face2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"new2", "=", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"face1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"face2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";"}]}], "]"}],
                  ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"edges", "=", 
                  RowBox[{"ReplacePart", "[", 
                   RowBox[{"edges", ",", 
                    RowBox[{"#", "\[Rule]", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", 
                    RowBox[{"pos3", ",", "pos4"}], "}"}], "]"}]}]}], "]"}]}], 
                 ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cross", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"verts", "[", 
                    RowBox[{"[", 
                    RowBox[{"edges", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"new1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "2"}], "]"}], "]"}], 
                    "]"}], "]"}], "-", 
                    RowBox[{"verts", "[", 
                    RowBox[{"[", 
                    RowBox[{"edges", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"new1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "]"}], 
                    "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"verts", "[", 
                    RowBox[{"[", 
                    RowBox[{"edges", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"new1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "2"}], "]"}], "]"}], 
                    "]"}], "]"}], "-", 
                    RowBox[{"verts", "[", 
                    RowBox[{"[", 
                    RowBox[{"edges", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"new1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}], "]"}], 
                    "]"}], "]"}]}]}], "]"}], ".", "normal1"}], "<", "0"}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"new1", "=", 
                    RowBox[{"-", "new1"}]}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cross", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"verts", "[", 
                    RowBox[{"[", 
                    RowBox[{"edges", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"new2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "2"}], "]"}], "]"}], 
                    "]"}], "]"}], "-", 
                    RowBox[{"verts", "[", 
                    RowBox[{"[", 
                    RowBox[{"edges", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"new2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "]"}], 
                    "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"verts", "[", 
                    RowBox[{"[", 
                    RowBox[{"edges", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"new2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "2"}], "]"}], "]"}], 
                    "]"}], "]"}], "-", 
                    RowBox[{"verts", "[", 
                    RowBox[{"[", 
                    RowBox[{"edges", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"new2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}], "]"}], 
                    "]"}], "]"}]}]}], "]"}], ".", "normal2"}], "<", "0"}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"new2", "=", 
                    RowBox[{"-", "new2"}]}]}], "]"}], ";", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"facesAsEdges", "=", 
                  RowBox[{"ReplacePart", "[", 
                   RowBox[{"facesAsEdges", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"edgesAssociation", "[", "#", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", "new1"}], ",", 
                    
                    RowBox[{
                    RowBox[{
                    RowBox[{"edgesAssociation", "[", "#", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[Rule]", "new2"}]}], 
                    "}"}]}], "]"}]}]}]}], "]"}]}]}], "]"}], ")"}], "&"}], "/@", 
         RowBox[{"Keys", "[", "edgesAssociation", "]"}]}], ")"}], "/@", 
       RowBox[{"Range", "[", "iter", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"facePoints", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"#", "<", "0"}], ",", 
               RowBox[{"Reverse", "[", 
                RowBox[{"edges", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "#"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"edges", "[", 
                RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "&"}], "/@", "#"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"newFaces", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"newFaces", ",", 
             RowBox[{"{", 
              RowBox[{"DeleteDuplicates", "[", 
               RowBox[{"Flatten", "[", "facePoints", "]"}], "]"}], "}"}]}], 
            "]"}]}]}], "\[IndentingNewLine]", ")"}], "&"}], "/@", 
       "facesAsEdges"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "newFaces"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.828544049644343*^9, 3.82854406229254*^9}, {
   3.828544139753883*^9, 3.828544193234514*^9}, {3.828544344175417*^9, 
   3.8285443821186953`*^9}, {3.828550126800507*^9, 3.82855021622189*^9}, {
   3.828617650557869*^9, 3.828617703875578*^9}, {3.828617740750428*^9, 
   3.8286177776612663`*^9}, {3.828618218503696*^9, 3.828618275310795*^9}, {
   3.828618352823358*^9, 3.828618361618099*^9}, {3.82861839457736*^9, 
   3.828618582900975*^9}, {3.828618625268412*^9, 3.828618643599133*^9}, {
   3.828618715655037*^9, 3.828618944037159*^9}, {3.828618975689601*^9, 
   3.828619010982882*^9}, {3.828619059916754*^9, 3.8286190762171926`*^9}, {
   3.82861911088579*^9, 3.8286191606439857`*^9}, {3.828619212271806*^9, 
   3.828619219291695*^9}, {3.828619259584202*^9, 3.828619392551964*^9}, {
   3.8286206119113903`*^9, 3.828620620741653*^9}, {3.828620667624671*^9, 
   3.8286206910764627`*^9}, {3.828620749459381*^9, 3.828620819297193*^9}, {
   3.828620879474062*^9, 3.828620905582293*^9}, {3.828621013548401*^9, 
   3.828621134196072*^9}, {3.828621325426949*^9, 3.828621339588305*^9}, {
   3.828621581729862*^9, 3.828621595694387*^9}, {3.828621639606185*^9, 
   3.828621941788353*^9}, {3.828621974204183*^9, 3.828622304720564*^9}, {
   3.828622622634513*^9, 3.828622634863956*^9}, {3.828622674596992*^9, 
   3.828622717041355*^9}, {3.828622760594054*^9, 3.8286229429082947`*^9}, {
   3.828623151632181*^9, 3.8286231684123173`*^9}, {3.828623293111936*^9, 
   3.828623302648172*^9}, {3.8286233870640707`*^9, 3.828623388332839*^9}, {
   3.828623421839028*^9, 3.828623628200968*^9}, {3.8286236750387907`*^9, 
   3.82862377351997*^9}, {3.8286238572868643`*^9, 3.8286239963049297`*^9}, {
   3.828624028301034*^9, 3.828624036650178*^9}, {3.828624474135277*^9, 
   3.828624609166507*^9}, 3.8286247097444887`*^9, {3.828624739787056*^9, 
   3.828624876186915*^9}, {3.8286249480125933`*^9, 3.8286249597149353`*^9}, {
   3.828624990009267*^9, 3.828625116410845*^9}, {3.828625218533978*^9, 
   3.828625255479364*^9}, {3.8286254237231627`*^9, 3.828625428283477*^9}, {
   3.8286257019779167`*^9, 3.828625753728006*^9}, {3.8286257924975767`*^9, 
   3.828625801486158*^9}, {3.828625867790429*^9, 3.8286258697738934`*^9}, {
   3.828625908515298*^9, 3.828625914613491*^9}, {3.828625954627715*^9, 
   3.828626053783657*^9}, {3.8286260859559*^9, 3.828626119698009*^9}, {
   3.828627743599853*^9, 3.8286277438238983`*^9}, {3.82862777672586*^9, 
   3.828627780563444*^9}, {3.828628392934189*^9, 3.828628393174678*^9}, {
   3.828628558815855*^9, 3.828628560653419*^9}, {3.828628626808523*^9, 
   3.828628665000684*^9}, {3.8286287436208353`*^9, 3.828628763687845*^9}, {
   3.828628868750463*^9, 3.828628899714995*^9}, {3.82862895868646*^9, 
   3.828628974071479*^9}, {3.8286369137279997`*^9, 3.8286369185164948`*^9}, {
   3.828637110947625*^9, 3.8286371308778677`*^9}, {3.828637206106769*^9, 
   3.8286372296665154`*^9}, {3.8286373054132233`*^9, 3.828637333107566*^9}, {
   3.8286373742653713`*^9, 3.828637384400202*^9}, 3.8286375114520197`*^9, {
   3.8286375510783463`*^9, 3.82863768451166*^9}, {3.828637718695735*^9, 
   3.828637721511615*^9}, {3.828637766037483*^9, 3.828637795670136*^9}, {
   3.828637904713676*^9, 3.828637941554885*^9}, {3.8286380519949827`*^9, 
   3.828638072444662*^9}, {3.8286381151272573`*^9, 3.828638183581538*^9}, {
   3.828638260894755*^9, 3.8286383262450857`*^9}, {3.828638591569767*^9, 
   3.8286386224759703`*^9}, {3.828638656741702*^9, 3.8286388902331057`*^9}, {
   3.82863894116995*^9, 3.828639189522807*^9}, {3.828641744801168*^9, 
   3.828641745363999*^9}, {3.8286417856269197`*^9, 3.82864194071455*^9}, {
   3.828641975900654*^9, 3.828642071933948*^9}, {3.82864213945747*^9, 
   3.828642177605069*^9}, {3.8286422199590797`*^9, 3.82864222063603*^9}, {
   3.8286422808376093`*^9, 3.8286422902807493`*^9}, {3.828642322020208*^9, 
   3.82864242929994*^9}, {3.828642556016426*^9, 3.828642726503455*^9}, {
   3.828643061114235*^9, 3.828643111490047*^9}, {3.828643455389769*^9, 
   3.8286435404607162`*^9}, {3.828643583114994*^9, 3.8286435848946943`*^9}, {
   3.828643631106082*^9, 3.8286436339179173`*^9}, {3.828643711339642*^9, 
   3.828643729709374*^9}, {3.828643775501355*^9, 3.828643784863915*^9}, {
   3.828643866177712*^9, 3.828643871057816*^9}, {3.8286439331686697`*^9, 
   3.828643995825254*^9}, {3.8286440450303793`*^9, 3.828644081416258*^9}, {
   3.828644148029416*^9, 3.828644150398058*^9}, {3.828644199173455*^9, 
   3.828644248646702*^9}, {3.828644287729649*^9, 3.828644328579443*^9}, {
   3.828644392532789*^9, 3.828644552566951*^9}, {3.828644737840461*^9, 
   3.8286447935585012`*^9}, {3.82864482755645*^9, 3.8286448277078257`*^9}, {
   3.8286449111791573`*^9, 3.828645063245282*^9}, {3.828645095594656*^9, 
   3.8286450999610977`*^9}, {3.828645145443344*^9, 3.8286452180100203`*^9}, {
   3.8286452779804163`*^9, 3.82864532750134*^9}, {3.8286453593379803`*^9, 
   3.8286453669704742`*^9}, {3.828645398142446*^9, 3.828645462385611*^9}, {
   3.828646303799697*^9, 3.828646333790081*^9}, {3.8286463949090347`*^9, 
   3.8286464407630444`*^9}, {3.828646541818328*^9, 3.828646553760425*^9}, {
   3.8286473612604094`*^9, 3.828647382412952*^9}},
 CellLabel->
  "In[130]:=",ExpressionUUID->"ea015046-0fb3-433a-be44-a743e473368e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Shifting Vertices for Surface Tension and Gravity", "Subsubsection",
 CellChangeTimes->{{3.81904448654601*^9, 3.819044491661377*^9}, {
   3.8190483257512503`*^9, 3.819048329441556*^9}, {3.819647205250242*^9, 
   3.819647231814694*^9}, 3.8209283963512573`*^9, {3.82542313305131*^9, 
   3.82542313442432*^9}},ExpressionUUID->"1779e47b-3002-48ab-844b-\
2169551cff03"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"forceFaceST", "[", 
    RowBox[{"vert_", ",", "face_", ",", "tension_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "points", ",", "s0", ",", "s1", ",", "s2", ",", "force1", ",", "force2",
        ",", "force3", ",", "newPoints"}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"points", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"vert", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "face"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s0", "=", 
       RowBox[{
        RowBox[{"points", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "-", 
        RowBox[{"points", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"s1", "=", 
       RowBox[{
        RowBox[{"points", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "-", 
        RowBox[{"points", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"s2", "=", 
       RowBox[{
        RowBox[{"points", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"points", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"force1", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"tension", "/", "2"}], ")"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"s1", "\[Cross]", 
           RowBox[{"(", 
            RowBox[{"s0", "\[Cross]", "s1"}], ")"}]}], ")"}], "/", 
         RowBox[{"Norm", "[", 
          RowBox[{"s0", "\[Cross]", "s1"}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"force2", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"tension", "/", "2"}], ")"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"s2", "\[Cross]", 
           RowBox[{"(", 
            RowBox[{"s1", "\[Cross]", "s2"}], ")"}]}], ")"}], "/", 
         RowBox[{"Norm", "[", 
          RowBox[{"s1", "\[Cross]", "s2"}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"force3", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"tension", "/", "2"}], ")"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"s0", "\[Cross]", 
           RowBox[{"(", 
            RowBox[{"s2", "\[Cross]", "s0"}], ")"}]}], ")"}], "/", 
         RowBox[{"Norm", "[", 
          RowBox[{"s2", "\[Cross]", "s0"}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"force1", ",", "force2", ",", "force3"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "                                                                        ", 
  "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.819390500422195*^9, 3.819390511765946*^9}, {
   3.8193905474092607`*^9, 3.819390606510436*^9}, {3.819390647545755*^9, 
   3.819390727834846*^9}, {3.819464266562839*^9, 3.819464313312454*^9}, {
   3.819464379683318*^9, 3.819464402360531*^9}, 3.819464444512651*^9, {
   3.819464477880849*^9, 3.819464528391361*^9}, {3.819464696557127*^9, 
   3.819464719242695*^9}, {3.81946492326989*^9, 3.819464966189288*^9}, {
   3.819465035370701*^9, 3.819465035777342*^9}, {3.819644384307074*^9, 
   3.819644384743355*^9}, {3.819646463846575*^9, 3.8196465259072657`*^9}, {
   3.819646635436021*^9, 3.819646655602879*^9}, {3.819647187793165*^9, 
   3.819647189198566*^9}, {3.819720174378093*^9, 3.819720188229187*^9}, {
   3.819720229029724*^9, 3.819720233887752*^9}, {3.819720347426364*^9, 
   3.819720377151496*^9}, {3.819720466626494*^9, 3.8197204673424597`*^9}, {
   3.81972052801584*^9, 3.8197208580353937`*^9}, {3.8197210915945673`*^9, 
   3.8197210962444277`*^9}, {3.8202495872002373`*^9, 
   3.8202496126006393`*^9}, {3.8202497093707523`*^9, 
   3.8202497165637627`*^9}, {3.820249780840863*^9, 3.820249781082656*^9}, {
   3.82025021167447*^9, 3.8202502180345078`*^9}, {3.825423139222591*^9, 
   3.8254231393556023`*^9}, {3.826019463572729*^9, 3.826019485025635*^9}, {
   3.8262892404963913`*^9, 3.826289251385182*^9}},
 CellLabel->
  "In[131]:=",ExpressionUUID->"835b3b74-f6cf-4245-900e-97e08378d075"],

Cell[BoxData[
 RowBox[{
  RowBox[{"forceFaceGravity", "[", 
   RowBox[{"vert_", ",", "face_", ",", "modulus_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "points", ",", "s0", ",", "s1", ",", "s2", ",", "z0", ",", "z1", ",", 
      "z2", ",", "k", ",", "zTerm", ",", "force1", ",", "force2", ",", 
      "force3", ",", "newPoints"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"points", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"vert", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "face"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"s0", "=", 
      RowBox[{
       RowBox[{"points", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "-", 
       RowBox[{"points", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"s1", "=", 
      RowBox[{
       RowBox[{"points", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "-", 
       RowBox[{"points", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"s2", "=", 
      RowBox[{
       RowBox[{"points", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "-", 
       RowBox[{"points", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"z0", "=", 
      RowBox[{"points", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"z1", "=", 
      RowBox[{"points", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"z2", "=", 
      RowBox[{"points", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"k", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"zTerm", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"z0", "^", "2"}], "+", 
        RowBox[{"z1", "^", "2"}], "+", 
        RowBox[{"z2", "^", "2"}], "+", 
        RowBox[{"z0", " ", "z1"}], "+", 
        RowBox[{"z0", " ", "z2"}], "+", 
        RowBox[{"z1", " ", "z2"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"force1", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "modulus"}], "/", "24"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "z0"}], "+", "z1", "+", "z2"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"k", ".", 
            RowBox[{"s0", "\[Cross]", "s1"}]}], ")"}], "k"}], "+", 
         RowBox[{"zTerm", 
          RowBox[{"(", 
           RowBox[{"k", "\[Cross]", "s1"}], ")"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"force2", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "modulus"}], "/", "24"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "z1"}], "+", "z2", "+", "z0"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"k", ".", 
            RowBox[{"s1", "\[Cross]", "s2"}]}], ")"}], "k"}], "+", 
         RowBox[{"zTerm", 
          RowBox[{"(", 
           RowBox[{"k", "\[Cross]", "s2"}], ")"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"force3", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "modulus"}], "/", "24"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "z2"}], "+", "z0", "+", "z1"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"k", ".", 
            RowBox[{"s2", "\[Cross]", "s0"}]}], ")"}], "k"}], "+", 
         RowBox[{"zTerm", 
          RowBox[{"(", 
           RowBox[{"k", "\[Cross]", "s0"}], ")"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"force1", ",", "force2", ",", "force3"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}], 
  "                                                                        \
"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.819390500422195*^9, 3.819390511765946*^9}, {
   3.8193905474092607`*^9, 3.819390606510436*^9}, {3.819390647545755*^9, 
   3.819390727834846*^9}, {3.819464266562839*^9, 3.819464313312454*^9}, {
   3.819464379683318*^9, 3.819464402360531*^9}, 3.819464444512651*^9, {
   3.819464477880849*^9, 3.819464528391361*^9}, {3.819464696557127*^9, 
   3.819464719242695*^9}, {3.81946492326989*^9, 3.819464966189288*^9}, {
   3.819465035370701*^9, 3.819465035777342*^9}, {3.819644384307074*^9, 
   3.819644384743355*^9}, {3.819646463846575*^9, 3.8196465259072657`*^9}, {
   3.819646635436021*^9, 3.819646655602879*^9}, {3.819647187793165*^9, 
   3.819647189198566*^9}, {3.819720174378093*^9, 3.819720188229187*^9}, {
   3.819720229029724*^9, 3.819720233887752*^9}, {3.819720347426364*^9, 
   3.819720377151496*^9}, {3.819720466626494*^9, 3.8197204673424597`*^9}, {
   3.81972052801584*^9, 3.8197208580353937`*^9}, {3.8197210915945673`*^9, 
   3.8197210962444277`*^9}, {3.8202495872002373`*^9, 
   3.8202496126006393`*^9}, {3.8202497093707523`*^9, 
   3.8202497165637627`*^9}, {3.820249780840863*^9, 3.820249781082656*^9}, {
   3.82025021167447*^9, 3.8202502180345078`*^9}, {3.825423139222591*^9, 
   3.825423172815712*^9}, {3.825423293735352*^9, 3.8254233029973383`*^9}, {
   3.825423362306954*^9, 3.8254233652837954`*^9}, {3.8254234202586327`*^9, 
   3.825423449707424*^9}, {3.8254234937196617`*^9, 3.8254236749118958`*^9}, {
   3.8254237130501823`*^9, 3.825423759792512*^9}, {3.825424116060924*^9, 
   3.825424187080514*^9}, {3.825424222997223*^9, 3.8254242238598146`*^9}},
 CellLabel->
  "In[132]:=",ExpressionUUID->"547ee091-1369-4265-a8d8-f6e8fc59da32"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"energy", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_", ",", "angle_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{
      RowBox[{"(", "angle", ")"}], "*", 
      RowBox[{"Pi", "/", "180"}]}], "]"}], "*", "x", "*", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fjHead", "[", 
    RowBox[{
    "int_", ",", "wi_", ",", "ai_", ",", "energy_", ",", "angle_", ",", "e_", 
     ",", "s_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "j", ",", "k", ",", "xis", ",", "x", ",", "y", ",", "z", ",", "derv"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"int", "<", "3"}], ",", 
        RowBox[{
         RowBox[{"j", "=", "int"}], ";", 
         RowBox[{"k", "=", 
          RowBox[{"int", "+", "1"}]}]}], ",", 
        RowBox[{
         RowBox[{"j", "=", "int"}], ";", 
         RowBox[{"k", "=", "1"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"derv", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}], "[", 
        RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xis", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"#", "*", 
            RowBox[{"e", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "#"}], ")"}], 
            RowBox[{"e", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}], "&"}], "/@", "ai"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"wi", "[", 
            RowBox[{"[", "#", "]"}], "]"}]}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"ai", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "*", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"energy", "[", 
                    RowBox[{"x", ",", "y", ",", "z", ",", "angle"}], "]"}], 
                   ",", "derv"}], "]"}], ")"}], "\[IndentingNewLine]", "/.", 
                RowBox[{"Thread", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y", ",", "z"}], "}"}], "\[Rule]", 
                  RowBox[{"xis", "[", 
                   RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], ")"}], "[", 
              RowBox[{"[", "k", "]"}], "]"}], "*", 
             RowBox[{"s", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}], "+", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"energy", "[", 
                 RowBox[{"x", ",", "y", ",", "z", ",", "angle"}], "]"}], 
                ")"}], "/.", 
               RowBox[{"Thread", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y", ",", "z"}], "}"}], "\[Rule]", 
                 RowBox[{"xis", "[", 
                  RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], ")"}], "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ")"}]}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fjTail", "[", 
   RowBox[{
   "int_", ",", "wi_", ",", "ai_", ",", "energy_", ",", "angle_", ",", "e_", 
    ",", "s_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "j", ",", "k", ",", "xis", ",", "x", ",", "y", ",", "z", ",", "derv"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"int", "<", "3"}], ",", 
       RowBox[{
        RowBox[{"j", "=", "int"}], ";", 
        RowBox[{"k", "=", 
         RowBox[{"int", "+", "1"}]}]}], ",", 
       RowBox[{
        RowBox[{"j", "=", "int"}], ";", 
        RowBox[{"k", "=", "1"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"xis", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", "*", 
           RowBox[{"e", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "#"}], ")"}], 
           RowBox[{"e", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}], "&"}], "/@", "ai"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"derv", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], "[", 
       RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"wi", "[", 
           RowBox[{"[", "#", "]"}], "]"}]}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ai", "[", 
               RowBox[{"[", "#", "]"}], "]"}]}], ")"}], "*", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"energy", "[", 
                   RowBox[{"x", ",", "y", ",", "z", ",", "angle"}], "]"}], 
                  ",", "derv"}], "]"}], ")"}], "\[IndentingNewLine]", "/.", 
               RowBox[{"Thread", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y", ",", "z"}], "}"}], "\[Rule]", 
                 RowBox[{"xis", "[", 
                  RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], ")"}], "[", 
             RowBox[{"[", "k", "]"}], "]"}], "*", 
            RowBox[{"s", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], "-", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"energy", "[", 
                RowBox[{"x", ",", "y", ",", "z", ",", "angle"}], "]"}], ")"}],
               "/.", 
              RowBox[{"Thread", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], "\[Rule]", 
                RowBox[{"xis", "[", 
                 RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], ")"}], "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], ")"}]}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8271599851815367`*^9, 3.827160012576269*^9}, {
   3.8271600511980667`*^9, 3.827160093598651*^9}, {3.827160666883613*^9, 
   3.827160667891507*^9}, {3.827160700281549*^9, 3.827160829368926*^9}, {
   3.827160884122267*^9, 3.8271610713581657`*^9}, {3.82716110521008*^9, 
   3.8271611203102207`*^9}, {3.82716116953034*^9, 3.8271612439780893`*^9}, {
   3.8271612829052477`*^9, 3.827161557688602*^9}, {3.827161614506097*^9, 
   3.827161616337291*^9}, {3.827161648543562*^9, 3.827161675047944*^9}, {
   3.8271619140184603`*^9, 3.8271619513914003`*^9}, {3.827162179356341*^9, 
   3.8271621818798447`*^9}, {3.8271623113180923`*^9, 3.827162375153997*^9}, {
   3.8271624409870462`*^9, 3.827162443091263*^9}, {3.8271625589669657`*^9, 
   3.827162563627082*^9}, {3.827162658561047*^9, 3.827162660281493*^9}, 
   3.8278433386075277`*^9, {3.827843608238228*^9, 3.8278436492872467`*^9}, {
   3.827843710639337*^9, 3.8278437232142563`*^9}, {3.8278437702561207`*^9, 
   3.8278438075225773`*^9}, {3.827938793720551*^9, 3.8279387955475693`*^9}, 
   3.8279388264400167`*^9, {3.828009906069717*^9, 3.828009907588716*^9}, {
   3.8280099668206577`*^9, 3.828009993876163*^9}, {3.828010152716209*^9, 
   3.828010172606718*^9}, {3.828010247048008*^9, 3.828010252194352*^9}, {
   3.828015266642125*^9, 3.828015286033249*^9}, {3.828015352422618*^9, 
   3.828015355064917*^9}, {3.828015530997899*^9, 3.828015533196924*^9}, 
   3.828015821587947*^9, 3.8280158885981073`*^9, {3.82801602137823*^9, 
   3.828016101190209*^9}, {3.828016336433222*^9, 3.828016380093143*^9}, {
   3.828016854747591*^9, 3.8280168618099337`*^9}, {3.8280174495028467`*^9, 
   3.828017451323743*^9}, {3.828017837397735*^9, 3.8280178375171757`*^9}, {
   3.828017882019205*^9, 3.828017882261427*^9}, 3.828026748570331*^9, 
   3.828027048875313*^9, {3.828027309207509*^9, 3.8280273336537733`*^9}, {
   3.828028882034881*^9, 3.828028911938485*^9}, {3.828028953509182*^9, 
   3.82802895553557*^9}, {3.8280290058083363`*^9, 3.828029009474874*^9}, {
   3.828029047340683*^9, 3.828029071353791*^9}, {3.828029115115049*^9, 
   3.828029115278783*^9}, {3.828030544776491*^9, 3.828030580852149*^9}, {
   3.828030613710856*^9, 3.828030622990443*^9}, {3.828030694948249*^9, 
   3.828030697653035*^9}, {3.82803074080186*^9, 3.828030765983502*^9}, {
   3.828031175539486*^9, 3.828031193184061*^9}, {3.828031341970511*^9, 
   3.8280314132147083`*^9}, {3.82803146057545*^9, 3.828031493029294*^9}, {
   3.828031535780312*^9, 3.828031539676619*^9}, 3.8280315750722017`*^9, 
   3.828040713449655*^9},
 CellLabel->
  "In[133]:=",ExpressionUUID->"60311f9b-f1ff-423b-b3d3-b7152c502cba"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"forceFaceConst", "[", 
    RowBox[{"vert_", ",", "edge_", ",", "angle_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "points", ",", "const", ",", "e", ",", "ai", ",", "wi", ",", "energies",
        ",", "xis", ",", "s"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"e", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"vert", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "edge"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s", "=", 
       RowBox[{
        RowBox[{"e", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "-", 
        RowBox[{"e", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ai", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "0.5774"}], "/", "2"}], "+", 
          RowBox[{"1", "/", "2"}]}], ",", 
         RowBox[{
          RowBox[{"0.5774", "/", "2"}], "+", 
          RowBox[{"1", "/", "2"}]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"wi", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "/", "2"}], ",", 
         RowBox[{"1", "/", "2"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"fjTail", "[", 
            RowBox[{
            "#", ",", "wi", ",", "ai", ",", "energy", ",", "angle", ",", "e", 
             ",", "s"}], "]"}], "&"}], "/@", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ")"}], ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"fjHead", "[", 
            RowBox[{
            "#", ",", "wi", ",", "ai", ",", "energy", ",", "angle", ",", "e", 
             ",", "s"}], "]"}], "&"}], "/@", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ")"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.819390500422195*^9, 3.819390511765946*^9}, {
   3.8193905474092607`*^9, 3.819390606510436*^9}, {3.819390647545755*^9, 
   3.819390727834846*^9}, {3.819464266562839*^9, 3.819464313312454*^9}, {
   3.819464379683318*^9, 3.819464402360531*^9}, 3.819464444512651*^9, {
   3.819464477880849*^9, 3.819464528391361*^9}, {3.819464696557127*^9, 
   3.819464719242695*^9}, {3.81946492326989*^9, 3.819464966189288*^9}, {
   3.819465035370701*^9, 3.819465035777342*^9}, {3.819644384307074*^9, 
   3.819644384743355*^9}, {3.819646463846575*^9, 3.8196465259072657`*^9}, {
   3.819646635436021*^9, 3.819646655602879*^9}, {3.819647187793165*^9, 
   3.819647189198566*^9}, {3.819720174378093*^9, 3.819720188229187*^9}, {
   3.819720229029724*^9, 3.819720233887752*^9}, {3.819720347426364*^9, 
   3.819720377151496*^9}, {3.819720466626494*^9, 3.8197204673424597`*^9}, {
   3.81972052801584*^9, 3.8197208580353937`*^9}, {3.8197210915945673`*^9, 
   3.8197210962444277`*^9}, {3.8202495872002373`*^9, 
   3.8202496126006393`*^9}, {3.8202497093707523`*^9, 
   3.8202497165637627`*^9}, {3.820249780840863*^9, 3.820249781082656*^9}, {
   3.82025021167447*^9, 3.8202502180345078`*^9}, {3.825423139222591*^9, 
   3.825423172815712*^9}, {3.825423293735352*^9, 3.8254233029973383`*^9}, {
   3.825423362306954*^9, 3.8254233652837954`*^9}, {3.8254234202586327`*^9, 
   3.825423449707424*^9}, {3.8254234937196617`*^9, 3.8254236749118958`*^9}, {
   3.8254237130501823`*^9, 3.825423759792512*^9}, {3.825424116060924*^9, 
   3.825424187080514*^9}, {3.825424222997223*^9, 3.8254242238598146`*^9}, {
   3.8271503175019493`*^9, 3.827150493063203*^9}, {3.82715053500106*^9, 
   3.8271505554328403`*^9}, {3.8271505981533737`*^9, 3.827150684222702*^9}, {
   3.8271507342490587`*^9, 3.827150743368762*^9}, {3.8271543914431458`*^9, 
   3.827154417121488*^9}, {3.827154488708721*^9, 3.827154542156934*^9}, {
   3.827154928021804*^9, 3.827154999114654*^9}, {3.827155040566627*^9, 
   3.82715504859225*^9}, {3.827157454986793*^9, 3.8271574606670523`*^9}, {
   3.827157726072732*^9, 3.827157822476313*^9}, {3.8271580602018957`*^9, 
   3.8271580626595917`*^9}, {3.827158130002365*^9, 3.827158181720132*^9}, {
   3.827158558178632*^9, 3.8271586684715548`*^9}, {3.827159784061348*^9, 
   3.827159849992256*^9}, {3.827159884879222*^9, 3.827159937911374*^9}, {
   3.82716168843883*^9, 3.8271618108306026`*^9}, 3.82716189779963*^9, {
   3.827161955094407*^9, 3.827161964887219*^9}, {3.8271620148765497`*^9, 
   3.8271620303616743`*^9}, {3.827162582925973*^9, 3.8271625878286667`*^9}, {
   3.827843520080398*^9, 3.8278435800752*^9}, {3.827938532136105*^9, 
   3.827938594999423*^9}, {3.8280161058306847`*^9, 3.82801612685394*^9}, {
   3.828016565530902*^9, 3.828016572832327*^9}, {3.828018663968441*^9, 
   3.8280187793461103`*^9}, {3.828018830947991*^9, 3.828018973082971*^9}, {
   3.82802567906653*^9, 3.8280256841998663`*^9}, {3.8280257330322037`*^9, 
   3.8280257885852737`*^9}, 3.828026535295356*^9, {3.8280289390463543`*^9, 
   3.828028941684214*^9}, {3.8280294885192013`*^9, 3.828029494999463*^9}, {
   3.828029575089283*^9, 3.828029577726309*^9}, {3.828029630705391*^9, 
   3.8280296367360477`*^9}, {3.828029944749547*^9, 3.8280299481953506`*^9}, {
   3.828030314424827*^9, 3.8280303180891*^9}},
 CellLabel->
  "In[136]:=",ExpressionUUID->"a09f5df4-a740-4338-a6d4-a75bb4f482ee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"projectedForcesCon", "[", 
   RowBox[{"force_", ",", "const_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"gradConst", ",", "forces", ",", "c"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gradConst", "=", 
      RowBox[{"Grad", "[", 
       RowBox[{"const", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{
       RowBox[{"force", ".", "gradConst"}], "/", 
       RowBox[{"(", 
        RowBox[{"gradConst", ".", "gradConst"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{"force", "-", 
       RowBox[{"c", "*", "gradConst"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.820255531641922*^9, 3.8202555506997232`*^9}, {
   3.820255585053521*^9, 3.8202557458126717`*^9}, {3.8202559640075893`*^9, 
   3.820256028642068*^9}, {3.820256334343005*^9, 3.820256339503187*^9}, {
   3.8206763415832644`*^9, 3.820676347506267*^9}, {3.820929805730789*^9, 
   3.820929822763507*^9}, {3.8254237985181017`*^9, 3.825423807470402*^9}, {
   3.826026006615652*^9, 3.8260260312601213`*^9}, 3.826199921283366*^9, {
   3.826199955668928*^9, 3.82619999460641*^9}, {3.826201926285273*^9, 
   3.826201942479602*^9}, {3.826202071469173*^9, 3.8262020769096212`*^9}, {
   3.8262027531380796`*^9, 3.826202755593822*^9}, {3.826202803923435*^9, 
   3.826202956465414*^9}, {3.826203433381509*^9, 3.826203433495603*^9}, {
   3.826289342100956*^9, 3.8262893564003553`*^9}, {3.826289474678742*^9, 
   3.826289475439781*^9}, {3.826290271027062*^9, 3.8262902763198833`*^9}, {
   3.826290312392168*^9, 3.82629032266249*^9}, {3.827854535753384*^9, 
   3.8278545383324623`*^9}, {3.827945057233313*^9, 3.827945094202512*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"4de4ce7a-3d63-4f32-9e72-f012e00badd1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"forceAllMound", "[", 
   RowBox[{
   "verts_", ",", "vConst_", ",", "faces_", ",", "cPos_", ",", "modulus_", 
    ",", "contactAngle_", ",", "const_", ",", "tension_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "allForces", ",", "currentFaces", ",", "faceNum", ",", "face", ",", 
      "faceForcesCon", ",", "faceForces", ",", "cnstEdges", ",", "edge", ",", 
      "cnstFace", ",", "replaceUncon", ",", "replaceCon"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"currentFaces", "=", "faces"}], ";", "\[IndentingNewLine]", 
     RowBox[{"allForces", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"Length", "[", "verts", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"face", "=", 
          RowBox[{"faces", "[", 
           RowBox[{"[", "#", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"faceForces", "=", 
          RowBox[{
           RowBox[{"forceFaceST", "[", 
            RowBox[{"verts", ",", "face", ",", "tension"}], "]"}], "+", 
           RowBox[{"forceFaceGravity", "[", 
            RowBox[{"verts", ",", "face", ",", "modulus"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"replaceUncon", "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"face", "[", 
               RowBox[{"[", "#", "]"}], "]"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"allForces", "[", 
                 RowBox[{"[", 
                  RowBox[{"face", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "]"}], "]"}], "+", 
                RowBox[{"faceForces", "[", 
                 RowBox[{"[", "#", "]"}], "]"}]}], ")"}]}], "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "face", "]"}], "]"}]}], ")"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"allForces", "=", 
          RowBox[{"ReplacePart", "[", 
           RowBox[{"allForces", ",", "replaceUncon"}], "]"}]}]}], ")"}], 
       "&"}], "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "currentFaces", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"cnstEdges", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"cPos", ",", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"cPos", "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;", 
              RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"cPos", "[", 
            RowBox[{"[", 
             RowBox[{";;", "1"}], "]"}], "]"}]}], "]"}]}], "}"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"edge", "=", 
          RowBox[{"cnstEdges", "[", 
           RowBox[{"[", "#", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"faceForcesCon", "=", 
          RowBox[{"forceFaceConst", "[", 
           RowBox[{"verts", ",", "edge", ",", "contactAngle"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"replaceCon", "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"edge", "[", 
               RowBox[{"[", "#", "]"}], "]"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"projectedForcesCon", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"faceForcesCon", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "+", 
                  RowBox[{"allForces", "[", 
                   RowBox[{"[", 
                    RowBox[{"edge", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "]"}], "]"}]}], ",", 
                 "const"}], "]"}], ")"}]}], "&"}], "/@", 
            RowBox[{"Range", "[", "2", "]"}]}], ")"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"allForces", "=", 
          RowBox[{"ReplacePart", "[", 
           RowBox[{"allForces", ",", "replaceCon"}], "]"}]}]}], ")"}], "&"}], 
      "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "cnstEdges", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "allForces"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8194647374160852`*^9, 3.819464866018523*^9}, {
   3.8194657114096613`*^9, 3.819465845259531*^9}, {3.81964683871098*^9, 
   3.819646864493805*^9}, {3.819647191602586*^9, 3.819647192211535*^9}, {
   3.819720730214663*^9, 3.8197207308989573`*^9}, {3.820249598074744*^9, 
   3.820249686835855*^9}, {3.820249725060898*^9, 3.820249813911943*^9}, {
   3.82024988146497*^9, 3.8202499657863503`*^9}, {3.820250002416689*^9, 
   3.820250011723198*^9}, {3.8202500751807947`*^9, 3.8202501089374723`*^9}, {
   3.820250144108059*^9, 3.820250164289267*^9}, 3.820250865692851*^9, {
   3.8254237654813633`*^9, 3.825423787902533*^9}, {3.8262891485753937`*^9, 
   3.826289313696638*^9}, {3.826626786137053*^9, 3.826626813038925*^9}, {
   3.827162073590067*^9, 3.827162129339343*^9}, 3.827162253526449*^9, 
   3.827162794181829*^9, 3.827162829860869*^9, {3.827854348503462*^9, 
   3.827854502459824*^9}, {3.8278549467115*^9, 3.827854952685935*^9}, 
   3.8278555050564938`*^9, {3.8278556442520523`*^9, 3.827855667982894*^9}, 
   3.8278564689339647`*^9, 3.827856513730595*^9, {3.8279452173229856`*^9, 
   3.8279452374000387`*^9}, {3.827945382858574*^9, 3.8279453835334044`*^9}, {
   3.827945522148593*^9, 3.827945574295965*^9}, {3.82800804888029*^9, 
   3.828008077058709*^9}, {3.828008122533266*^9, 3.828008153786767*^9}, {
   3.828017918471715*^9, 3.828017921761582*^9}, {3.828017960690565*^9, 
   3.828017994435032*^9}, {3.828019036166013*^9, 3.828019042388544*^9}, {
   3.82801936156321*^9, 3.8280193616969*^9}, {3.828023817035451*^9, 
   3.828023822498229*^9}, {3.828024093269023*^9, 3.828024097271287*^9}, {
   3.828024184140726*^9, 3.828024190377666*^9}, {3.828024289384901*^9, 
   3.828024311288809*^9}, {3.828024466812586*^9, 3.8280244775529623`*^9}, {
   3.8280245732579117`*^9, 3.828024599365127*^9}, {3.828024784243742*^9, 
   3.8280248087051363`*^9}, {3.828024874268952*^9, 3.828024979269702*^9}, {
   3.828025035645994*^9, 3.828025042814115*^9}, {3.828025114260662*^9, 
   3.8280251414825478`*^9}, {3.828025437758019*^9, 3.828025460163876*^9}, {
   3.828025515487732*^9, 3.8280255547097673`*^9}, {3.828025635010778*^9, 
   3.828025635373755*^9}, {3.8280258038793716`*^9, 3.828025847351911*^9}, {
   3.82802616870287*^9, 3.828026244058889*^9}, {3.8280262747637444`*^9, 
   3.828026390266345*^9}, {3.828026487584497*^9, 3.8280264909879217`*^9}, {
   3.828026622183906*^9, 3.8280266259967012`*^9}, {3.828026680263502*^9, 
   3.8280266972588377`*^9}, {3.828026996807465*^9, 3.82802700775001*^9}, 
   3.828647705037148*^9, 3.828693933082881*^9, {3.828990041021145*^9, 
   3.828990041546916*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"086a9ad5-9ad8-47c6-9f13-4d34d9f07ea3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Accounting for Volume", "Subsubsection",
 CellChangeTimes->{{3.81904448654601*^9, 3.819044491661377*^9}, {
  3.8190483257512503`*^9, 3.819048329441556*^9}, {3.819647205250242*^9, 
  3.819647231814694*^9}, {3.8209283963512573`*^9, 
  3.820928426015111*^9}},ExpressionUUID->"dfbd5f20-9529-401a-84c8-\
6d3c52c95ad7"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"volGradFace", "[", 
    RowBox[{"verts_", ",", "face_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "points", ",", "center", ",", "s0", ",", "s1", ",", "s2", ",", "k", ",",
        "grad1", ",", "grad2", ",", "grad3", ",", "newPoints"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"points", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"verts", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "face"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"center", "=", 
       RowBox[{"Mean", "[", "points", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"s0", "=", 
       RowBox[{
        RowBox[{"points", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "-", 
        RowBox[{"points", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"s1", "=", 
       RowBox[{
        RowBox[{"points", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "-", 
        RowBox[{"points", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"s2", "=", 
       RowBox[{
        RowBox[{"points", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"points", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"k", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"z", "=", 
          RowBox[{"Total", "[", 
           RowBox[{"points", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"grad1", "=", 
          RowBox[{
           RowBox[{"1", "/", "6"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"k", ".", 
                RowBox[{"s0", "\[Cross]", "s1"}]}], ")"}], "k"}], "+", 
             RowBox[{"z", " ", 
              RowBox[{"k", "\[Cross]", "s1"}]}]}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"grad2", "=", 
          RowBox[{
           RowBox[{"1", "/", "6"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"k", ".", 
                RowBox[{"s1", "\[Cross]", "s2"}]}], ")"}], "k"}], "+", 
             RowBox[{"z", " ", 
              RowBox[{"k", "\[Cross]", "s2"}]}]}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"grad3", "=", 
          RowBox[{
           RowBox[{"1", "/", "6"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"k", ".", 
                RowBox[{"s2", "\[Cross]", "s0"}]}], ")"}], "k"}], "+", 
             RowBox[{"z", " ", 
              RowBox[{"k", "\[Cross]", "s0"}]}]}], ")"}]}]}], ";"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"grad1", ",", "grad2", ",", "grad3"}], "}"}]}]}], "]"}]}], 
  "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.819722168343375*^9, 3.8197222081572037`*^9}, {
   3.81972226830477*^9, 3.819722328679311*^9}, {3.819722388397625*^9, 
   3.819722401000588*^9}, {3.819722471280755*^9, 3.819722476138219*^9}, {
   3.819722521401991*^9, 3.819722532586289*^9}, {3.819722929178656*^9, 
   3.819723008933527*^9}, {3.819726823648044*^9, 3.819726836111352*^9}, {
   3.820166731030011*^9, 3.82016673296865*^9}, {3.8202496963828983`*^9, 
   3.8202496976931458`*^9}, {3.820250895139968*^9, 3.820250950522583*^9}, 
   3.820674856444927*^9, {3.820675163487212*^9, 3.8206751813119698`*^9}, {
   3.8206756640581493`*^9, 3.820675674783299*^9}, {3.820675928066092*^9, 
   3.820675930626*^9}, {3.820676053682173*^9, 3.820676084393959*^9}, {
   3.820852449507598*^9, 3.8208524516301203`*^9}, {3.820852584088935*^9, 
   3.82085258517455*^9}, {3.8209293927053013`*^9, 3.820929422879624*^9}, {
   3.82119168905359*^9, 3.821191693018106*^9}, {3.821191798091269*^9, 
   3.821191810707141*^9}, {3.821281553434573*^9, 3.821281643747014*^9}, {
   3.821281679930879*^9, 3.821281684981089*^9}, {3.8213739397796497`*^9, 
   3.8213739906921597`*^9}, {3.821374030211708*^9, 3.821374035439801*^9}, {
   3.8213741728824787`*^9, 3.821374176740137*^9}, {3.821374349542473*^9, 
   3.821374354443555*^9}, {3.821374641234405*^9, 3.821374642593811*^9}, {
   3.821374674276163*^9, 3.821374676309434*^9}, {3.821374747857273*^9, 
   3.821374791514512*^9}, {3.821530579394351*^9, 3.821530583574263*^9}, {
   3.821530663718752*^9, 3.821530666340374*^9}, {3.821530944974948*^9, 
   3.821530990618002*^9}, {3.821531237997208*^9, 3.821531246330909*^9}, 
   3.821531570223237*^9, {3.823000143169982*^9, 3.823000144805561*^9}, {
   3.823000186855339*^9, 3.823000234825651*^9}, {3.8230004201066933`*^9, 
   3.823000420856782*^9}, {3.82300119477361*^9, 3.8230012143147783`*^9}, {
   3.8230016340571413`*^9, 3.823001646233219*^9}, {3.823605349665103*^9, 
   3.823605371825889*^9}, {3.823606320701371*^9, 3.8236063220027647`*^9}, {
   3.823607321481196*^9, 3.823607323510971*^9}, {3.824400443294806*^9, 
   3.824400452485601*^9}, {3.824809385861415*^9, 3.824809386325695*^9}, {
   3.825423571921167*^9, 3.825423574014045*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"cb2bb02f-582e-4bc6-9473-d5a711e1003d"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"volGradAll", "[", 
    RowBox[{"verts_", ",", "faces_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "totGrads", ",", "grads", ",", "replace", ",", "currentFaces", ",", 
       "initVol", ",", "face"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"totGrads", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"Length", "[", "verts", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"currentFaces", "=", "faces"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"face", "=", "#"}], ";", "\[IndentingNewLine]", 
          RowBox[{"grads", "=", 
           RowBox[{"volGradFace", "[", 
            RowBox[{"verts", ",", "face"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"replace", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"face", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "\[Rule]", 
               RowBox[{
                RowBox[{"totGrads", "[", 
                 RowBox[{"[", 
                  RowBox[{"face", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "]"}], "]"}], "+", 
                RowBox[{"grads", "[", 
                 RowBox[{"[", "#", "]"}], "]"}]}]}], ")"}], "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "face", "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"totGrads", "=", 
           RowBox[{"ReplacePart", "[", 
            RowBox[{"totGrads", ",", "replace"}], "]"}]}]}], ")"}], "&"}], "/@",
        "currentFaces"}], ";", "\[IndentingNewLine]", "totGrads"}]}], 
    "\[IndentingNewLine]", "]"}]}], "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8201667342272987`*^9, 3.820166752705147*^9}, 
   3.820166797764043*^9, {3.820166873373191*^9, 3.820166890244028*^9}, 
   3.820248802172751*^9, {3.82024916717515*^9, 3.820249425117882*^9}, {
   3.8202495372822227`*^9, 3.820249562772162*^9}, {3.8202507908836727`*^9, 
   3.820250857262196*^9}, {3.820250930114209*^9, 3.8202509323111*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"42f7599d-8690-4853-ab62-e9cb72d4d8f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"volumeRestoringMotionMound", "[", 
   RowBox[{"verts_", ",", "faces_", ",", "cPos_", ",", "startVol_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "excessVol", ",", "gradients", ",", "gradSum", ",", "c", ",", "x", ",", 
      "volRestores"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"excessVol", "=", 
      RowBox[{"startVol", "-", 
       RowBox[{"Volume", "[", 
        RowBox[{"meshedPoly", "[", 
         RowBox[{"verts", ",", "faces", ",", "cPos"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"gradients", "=", 
      RowBox[{"volGradAll", "[", 
       RowBox[{"verts", ",", "faces"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gradSum", "=", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", ".", "#"}], ")"}], "&"}], "/@", "gradients"}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{
       RowBox[{"-", "excessVol"}], "/", "gradSum"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"volRestores", "=", 
      RowBox[{"c", "*", "gradients"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.819721431148143*^9, 3.819721460503042*^9}, {
   3.819721989915131*^9, 3.81972200510172*^9}, {3.819722116533599*^9, 
   3.819722163495233*^9}, {3.8201663828774767`*^9, 3.8201664862304993`*^9}, {
   3.820166559664742*^9, 3.820166565062286*^9}, {3.820166604643173*^9, 
   3.820166612104643*^9}, {3.820249437594046*^9, 3.820249448254757*^9}, {
   3.820250999029499*^9, 3.820251000970632*^9}, {3.820251156111436*^9, 
   3.8202511717160597`*^9}, {3.820255230813793*^9, 3.820255347673717*^9}, {
   3.820255497439487*^9, 3.82025552596383*^9}, {3.820255749813243*^9, 
   3.8202557499143267`*^9}, {3.82025582644514*^9, 3.820255946735765*^9}, {
   3.820255982848517*^9, 3.820255985302642*^9}, {3.82092978546555*^9, 
   3.820929818117425*^9}, {3.821192329472868*^9, 3.821192329897996*^9}, 
   3.821282610731008*^9, 3.821282665989628*^9, {3.8248112076767273`*^9, 
   3.8248112116310167`*^9}, 3.824811465240444*^9, {3.827854519203755*^9, 
   3.827854529975132*^9}, {3.8278576681751947`*^9, 3.827857677401825*^9}, {
   3.8278585087181273`*^9, 3.8278585142802067`*^9}, {3.827858702965577*^9, 
   3.827858703325321*^9}, 3.828040721585783*^9, {3.8289900656072807`*^9, 
   3.828990066184321*^9}},
 CellLabel->
  "In[141]:=",ExpressionUUID->"01d73e1c-e61f-455b-83ce-c84c04506609"],

Cell[BoxData[
 RowBox[{
  RowBox[{"projectedForcesMound", "[", 
   RowBox[{
   "verts_", ",", "vConst_", ",", "faces_", ",", "modulus_", ",", "const_", 
    ",", "cPos_", ",", "contactAngle_", ",", "tension_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "gradients", ",", "gradSum", ",", "forces", ",", "forceSum", ",", "a", 
      ",", "x", ",", "projected"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gradients", "=", 
      RowBox[{"volGradAll", "[", 
       RowBox[{"verts", ",", "faces"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gradSum", "=", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#", ".", "#"}], "&"}], "/@", "gradients"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"forces", "=", 
      RowBox[{"forceAllMound", "[", 
       RowBox[{
       "verts", ",", "vConst", ",", "faces", ",", "cPos", ",", "modulus", ",",
         "contactAngle", ",", "const", ",", "tension"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"forceSum", "=", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"forces", "[", 
           RowBox[{"[", "#", "]"}], "]"}], ".", 
          RowBox[{"gradients", "[", 
           RowBox[{"[", "#", "]"}], "]"}]}], "&"}], "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "forces", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"forceSum", "/", "gradSum"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"projected", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"forces", "[", 
           RowBox[{"[", "#", "]"}], "]"}], "-", 
          RowBox[{"a", "*", 
           RowBox[{"gradients", "[", 
            RowBox[{"[", "#", "]"}], "]"}]}]}], ")"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "forces", "]"}], "]"}]}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.820255531641922*^9, 3.8202555506997232`*^9}, {
   3.820255585053521*^9, 3.8202557458126717`*^9}, {3.8202559640075893`*^9, 
   3.820256028642068*^9}, {3.820256334343005*^9, 3.820256339503187*^9}, {
   3.8206763415832644`*^9, 3.820676347506267*^9}, {3.820929805730789*^9, 
   3.820929822763507*^9}, {3.8254237985181017`*^9, 3.825423807470402*^9}, {
   3.826026006615652*^9, 3.826026007533339*^9}, {3.82620199541192*^9, 
   3.8262020081012983`*^9}, {3.826203069396489*^9, 3.82620307727594*^9}, {
   3.82628938213859*^9, 3.826289388826304*^9}, {3.826289477151986*^9, 
   3.826289478184347*^9}, {3.8278545413718977`*^9, 3.827854550557667*^9}, {
   3.827945267337488*^9, 3.827945286554224*^9}, {3.827945589388226*^9, 
   3.827945607261303*^9}, {3.82800818162749*^9, 3.8280081877273684`*^9}, 
   3.828040724147133*^9, {3.8289900935833282`*^9, 3.828990094134815*^9}, {
   3.82899016532712*^9, 3.828990165920739*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"b24708f3-efa0-4f60-bfb9-a0983273be46"],

Cell[BoxData[
 RowBox[{
  RowBox[{"projectedVertices", "[", 
   RowBox[{
   "verts_", ",", "vConst_", ",", "faces_", ",", "const_", ",", "cPos_"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"gradConst", ",", "vertConst", ",", "c"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gradConst", "=", 
      RowBox[{"Grad", "[", 
       RowBox[{"const", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"vConst", "[", 
          RowBox[{"[", "#", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"c", "=", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"const", "/.", 
               RowBox[{"(", 
                RowBox[{"Thread", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", 
                  RowBox[{"verts", "[", 
                   RowBox[{"[", "#", "]"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
            "/", 
            RowBox[{"(", 
             RowBox[{"gradConst", ".", "gradConst"}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"verts", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "+", 
           RowBox[{"c", "*", "gradConst"}]}]}], ",", 
         RowBox[{"verts", "[", 
          RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "&"}], "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "verts", "]"}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.820255531641922*^9, 3.8202555506997232`*^9}, {
   3.820255585053521*^9, 3.8202557458126717`*^9}, {3.8202559640075893`*^9, 
   3.820256028642068*^9}, {3.820256334343005*^9, 3.820256339503187*^9}, {
   3.8206763415832644`*^9, 3.820676347506267*^9}, {3.820929805730789*^9, 
   3.820929822763507*^9}, {3.8254237985181017`*^9, 3.825423807470402*^9}, {
   3.825953955334229*^9, 3.825953957620105*^9}, {3.825954120222723*^9, 
   3.8259541233510647`*^9}, {3.825954166183056*^9, 3.825954168966329*^9}, {
   3.8259542660158873`*^9, 3.825954321692485*^9}, {3.826019814733769*^9, 
   3.826019847364347*^9}, {3.8260199273029623`*^9, 3.8260199569455547`*^9}, {
   3.826019992654245*^9, 3.8260199983424263`*^9}, {3.8260200330281963`*^9, 
   3.8260200395069313`*^9}, {3.826020074359668*^9, 3.8260200746504793`*^9}, {
   3.826020651620764*^9, 3.826020671806197*^9}, {3.82602071088461*^9, 
   3.826020711900416*^9}, {3.82602082947134*^9, 3.826020840797392*^9}, {
   3.826020901824903*^9, 3.8260209603412533`*^9}, {3.826021007295011*^9, 
   3.826021026623169*^9}, {3.826021350334708*^9, 3.826021432974375*^9}, {
   3.8260214671714363`*^9, 3.8260215392713633`*^9}, {3.826021581301304*^9, 
   3.826021609012868*^9}, {3.8260216650958443`*^9, 3.82602168797575*^9}, {
   3.826022014226892*^9, 3.826022055660623*^9}, {3.826022090951635*^9, 
   3.826022190923984*^9}, {3.826022277590212*^9, 3.826022278460472*^9}, {
   3.826199544351636*^9, 3.826199553963612*^9}, {3.8262000490897093`*^9, 
   3.826200096913644*^9}, {3.826200685511722*^9, 3.8262006940321207`*^9}, {
   3.8262008413890247`*^9, 3.8262008460714197`*^9}, {3.82620137625068*^9, 
   3.826201399032284*^9}, {3.8262014712100563`*^9, 3.826201498722249*^9}, {
   3.826201567858408*^9, 3.82620160434041*^9}, {3.826201683819964*^9, 
   3.8262017000926447`*^9}, {3.8262018051870813`*^9, 3.82620187578962*^9}, {
   3.82620341257542*^9, 3.8262034266963997`*^9}, {3.826203460650546*^9, 
   3.8262035510997343`*^9}, 3.826203785240933*^9, {3.826203837197736*^9, 
   3.826203838909348*^9}, {3.8262043053031054`*^9, 3.826204354412908*^9}, 
   3.826205161975457*^9, {3.827939768397941*^9, 3.827939793719345*^9}, {
   3.8279500194655943`*^9, 3.827950030221586*^9}, {3.828008198533168*^9, 
   3.82800822362147*^9}},
 CellLabel->
  "In[143]:=",ExpressionUUID->"b9d0c400-23e7-457c-aa76-5ba54eefda2c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"projectedVerticesIterate", "[", 
   RowBox[{
   "verts_", ",", "vConst_", ",", "faces_", ",", "const_", ",", "cPos_", ",", 
    "cTol_", ",", 
    RowBox[{"iter_", ":", "20"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"projected", ",", "constPoints", ",", "dist"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"projected", "=", 
      RowBox[{"projectedVertices", "[", 
       RowBox[{
       "verts", ",", "vConst", ",", "faces", ",", "const", ",", "cPos"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"constPoints", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"projected", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "cPos"}], ")"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"dist", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"RegionDistance", "[", 
          RowBox[{
           RowBox[{"Region", "@", 
            RowBox[{"ImplicitRegion", "[", 
             RowBox[{
              RowBox[{"const", "\[Equal]", "0"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], ",", 
           "#"}], "]"}], "&"}], ")"}], "/@", "constPoints"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Max", "[", "dist", "]"}], ">", "cTol"}], "&&", 
        RowBox[{"iter", ">", "0"}]}], ",", 
       RowBox[{"projectedVerticesIterate", "[", 
        RowBox[{
        "verts", ",", "vConst", ",", "faces", ",", "const", ",", "cPos", ",", 
         "cTol", ",", 
         RowBox[{"iter", "-", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
       "projected"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.820255531641922*^9, 3.8202555506997232`*^9}, {
   3.820255585053521*^9, 3.8202557458126717`*^9}, {3.8202559640075893`*^9, 
   3.820256028642068*^9}, {3.820256334343005*^9, 3.820256339503187*^9}, {
   3.8206763415832644`*^9, 3.820676347506267*^9}, {3.820929805730789*^9, 
   3.820929822763507*^9}, {3.8254237985181017`*^9, 3.825423807470402*^9}, {
   3.825953955334229*^9, 3.825953957620105*^9}, {3.825954120222723*^9, 
   3.8259541233510647`*^9}, {3.825954166183056*^9, 3.825954168966329*^9}, {
   3.8259542660158873`*^9, 3.825954321692485*^9}, {3.826019814733769*^9, 
   3.826019847364347*^9}, {3.8260199273029623`*^9, 3.8260199569455547`*^9}, {
   3.826019992654245*^9, 3.8260199983424263`*^9}, {3.8260200330281963`*^9, 
   3.8260200395069313`*^9}, {3.826020074359668*^9, 3.8260200746504793`*^9}, {
   3.826020651620764*^9, 3.826020671806197*^9}, {3.82602071088461*^9, 
   3.826020711900416*^9}, {3.82602082947134*^9, 3.826020840797392*^9}, {
   3.826020901824903*^9, 3.8260209603412533`*^9}, {3.826021007295011*^9, 
   3.826021026623169*^9}, {3.826021350334708*^9, 3.826021432974375*^9}, {
   3.8260214671714363`*^9, 3.8260215392713633`*^9}, {3.826021581301304*^9, 
   3.826021609012868*^9}, {3.8260216650958443`*^9, 3.82602168797575*^9}, {
   3.826022014226892*^9, 3.826022055660623*^9}, {3.826022090951635*^9, 
   3.826022190923984*^9}, {3.826022277590212*^9, 3.826022278460472*^9}, {
   3.826199544351636*^9, 3.826199553963612*^9}, {3.8262000490897093`*^9, 
   3.826200096913644*^9}, {3.826200685511722*^9, 3.8262006940321207`*^9}, {
   3.8262008413890247`*^9, 3.8262008460714197`*^9}, {3.82620137625068*^9, 
   3.826201399032284*^9}, {3.8262014712100563`*^9, 3.826201498722249*^9}, {
   3.826201567858408*^9, 3.82620160434041*^9}, {3.826201683819964*^9, 
   3.8262017000926447`*^9}, {3.8262018051870813`*^9, 3.82620187578962*^9}, {
   3.82620341257542*^9, 3.8262034266963997`*^9}, {3.826203460650546*^9, 
   3.8262035510997343`*^9}, 3.826203785240933*^9, {3.826203837197736*^9, 
   3.826203838909348*^9}, {3.8262043053031054`*^9, 3.826204430832629*^9}, {
   3.82620451109756*^9, 3.8262046618101797`*^9}, {3.826204802985902*^9, 
   3.826204803429881*^9}, {3.826205117715548*^9, 3.826205171380596*^9}, 
   3.827939544042775*^9, {3.8279397359421253`*^9, 3.827939765602566*^9}, {
   3.827939796745933*^9, 3.827939802097891*^9}, {3.828008227395919*^9, 
   3.828008240761939*^9}, {3.828008324086996*^9, 3.828008329861133*^9}, {
   3.828008740131363*^9, 3.8280087658884068`*^9}, {3.828008819898842*^9, 
   3.8280088367884007`*^9}, {3.828008978976235*^9, 3.828008979143114*^9}, {
   3.828027437416421*^9, 3.82802743807075*^9}, {3.828028277433701*^9, 
   3.8280283214250937`*^9}, {3.828028397874593*^9, 3.8280284026885*^9}, {
   3.828028577507618*^9, 3.828028580910912*^9}, 3.8287109523425627`*^9},
 CellLabel->
  "In[144]:=",ExpressionUUID->"3a7b5cee-3307-4c88-b1e6-108662578107"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Iteration", "Subsubsection",
 CellChangeTimes->{{3.81904448654601*^9, 3.819044491661377*^9}, {
   3.8190483257512503`*^9, 3.819048329441556*^9}, {3.819647205250242*^9, 
   3.819647231814694*^9}, 3.8209283963512573`*^9, {3.820928432670466*^9, 
   3.8209284347838*^9}},ExpressionUUID->"eb7c4e41-c0f7-454d-996a-\
21e88629adde"],

Cell[BoxData[
 RowBox[{
  RowBox[{"shiftAllMound", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"verts_", ",", "vConst_", ",", "faces_", ",", "cPos_"}], "}"}], 
    ",", "scaleFactor_", ",", "startVol_", ",", "modulus_", ",", 
    "constraintTolerance_", ",", "const_", ",", "contactAngle_", ",", 
    "tension_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "force", ",", "move1", ",", "move2", ",", "totalMove", ",", "projected", 
      ",", "constraintPos"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"force", "=", 
      RowBox[{"scaleFactor", "*", 
       RowBox[{"projectedForcesMound", "[", 
        RowBox[{
        "verts", ",", "vConst", ",", "faces", ",", "modulus", ",", "const", 
         ",", "cPos", ",", "contactAngle", ",", "tension"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"move1", "=", 
      RowBox[{"verts", "+", "force"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"move2", "=", 
      RowBox[{"-", 
       RowBox[{"volumeRestoringMotionMound", "[", 
        RowBox[{"move1", ",", "faces", ",", "cPos", ",", "startVol"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"totalMove", "=", 
      RowBox[{"move1", "+", "move2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"projected", "=", 
      RowBox[{"projectedVerticesIterate", "[", 
       RowBox[{
       "totalMove", ",", "vConst", ",", "faces", ",", "const", ",", "cPos", 
        ",", "constraintTolerance"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"projected", ",", "vConst", ",", "faces", ",", "cPos"}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8202560883744297`*^9, 3.820256203118259*^9}, {
   3.8206763517770844`*^9, 3.8206763717556963`*^9}, {3.820852334100621*^9, 
   3.82085233513951*^9}, {3.820852723931376*^9, 3.820852725677017*^9}, {
   3.820852996383429*^9, 3.820852999677897*^9}, {3.8212820404802237`*^9, 
   3.821282154082581*^9}, {3.8212822774092283`*^9, 3.821282301040834*^9}, {
   3.821282363427929*^9, 3.8212824380696373`*^9}, {3.821282552196125*^9, 
   3.821282561287612*^9}, 3.821284703479886*^9, {3.821284753326508*^9, 
   3.821284755633376*^9}, {3.821284794075766*^9, 3.821284794350402*^9}, {
   3.8212848495596237`*^9, 3.8212848758203*^9}, {3.8212849785683613`*^9, 
   3.8212849800947237`*^9}, {3.821286127591936*^9, 3.8212861379770727`*^9}, {
   3.822999962223737*^9, 3.8229999627752857`*^9}, {3.823000055476694*^9, 
   3.8230000569599113`*^9}, {3.8242149047180443`*^9, 3.824214905310253*^9}, 
   3.824809338185163*^9, {3.824809747062402*^9, 3.824809767855465*^9}, 
   3.824810746769496*^9, 3.8248107817253227`*^9, 3.8248108153344097`*^9, 
   3.824810864593483*^9, {3.824810897548064*^9, 3.82481089817931*^9}, 
   3.824811147271824*^9, {3.824811218415965*^9, 3.824811227266564*^9}, {
   3.8248118010635033`*^9, 3.8248118916376867`*^9}, {3.824811921931748*^9, 
   3.824811922365155*^9}, 3.8248119787926397`*^9, {3.824814879780611*^9, 
   3.824814880723713*^9}, 3.824815419374634*^9, {3.8254238194637012`*^9, 
   3.82542382797482*^9}, {3.826021930981431*^9, 3.826021943354299*^9}, {
   3.826022212285078*^9, 3.8260223273832817`*^9}, {3.826022500896221*^9, 
   3.8260225019717693`*^9}, {3.826022649029628*^9, 3.826022663896496*^9}, {
   3.826022756191946*^9, 3.826022756784903*^9}, {3.826024294922265*^9, 
   3.82602431687759*^9}, {3.826024478314002*^9, 3.8260244815672293`*^9}, {
   3.826024663678549*^9, 3.8260246640125504`*^9}, {3.826024813462319*^9, 
   3.826024836303678*^9}, {3.826203106786532*^9, 3.826203115002849*^9}, {
   3.826203606712512*^9, 3.826203612047533*^9}, 3.826203756475528*^9, {
   3.826204243901349*^9, 3.826204299234275*^9}, {3.826204711820787*^9, 
   3.826204716879899*^9}, {3.8262894207455683`*^9, 3.826289435915963*^9}, {
   3.826289486274749*^9, 3.8262894874594727`*^9}, {3.8262896320135*^9, 
   3.826289632461443*^9}, {3.8278546655658693`*^9, 3.8278547228544807`*^9}, {
   3.827856044783988*^9, 3.8278560492668543`*^9}, {3.8278564212956743`*^9, 
   3.827856429671838*^9}, {3.827856767430094*^9, 3.82785679709653*^9}, 
   3.827856860803774*^9, {3.827857594195084*^9, 3.827857600098196*^9}, {
   3.8278576986220827`*^9, 3.827857730475802*^9}, {3.827858519255831*^9, 
   3.827858530389556*^9}, {3.82785867880998*^9, 3.8278586901953783`*^9}, {
   3.827939701885455*^9, 3.827939713171995*^9}, {3.827939811087565*^9, 
   3.82793981423009*^9}, {3.8279456197812023`*^9, 3.827945623853127*^9}, {
   3.8280083521018953`*^9, 3.828008378252947*^9}, {3.82800885357087*^9, 
   3.82800887908165*^9}, {3.828008917454093*^9, 3.828008976971781*^9}, 
   3.828028844692985*^9, {3.828039074753704*^9, 3.828039076342641*^9}, {
   3.8289900993975058`*^9, 3.8289900999872437`*^9}, {3.828990296870946*^9, 
   3.828990299215621*^9}},
 CellLabel->
  "In[145]:=",ExpressionUUID->"31bd69b3-b75b-4245-9600-12819e9bcd81"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iterateMound", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"v_", ",", "vConst_", ",", "f_", ",", "cPos_"}], "}"}], ",", 
    "startVol_", ",", 
    RowBox[{"OptionsPattern", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"scaleFactor", "->", ".05"}], ",", 
       RowBox[{"iter", "\[Rule]", "1"}], ",", 
       RowBox[{"modulus", "\[Rule]", "1"}], ",", 
       RowBox[{"cTolerance", "\[Rule]", ".0001"}], ",", 
       RowBox[{"vTolerance", "\[Rule]", ".0001"}], ",", 
       RowBox[{"constraintEq", "\[Rule]", "z"}], ",", 
       RowBox[{"contactAngle", "\[Rule]", "90"}], ",", 
       RowBox[{"tension", "\[Rule]", "1"}]}], "}"}], "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "newV", ",", "newVC", ",", "newF", ",", "newCPos", ",", "oldEnergy", ",",
       "newEnergy"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newV", ",", "newVC", ",", "newF", ",", "newCPos"}], "}"}], 
      "=", 
      RowBox[{"shiftAllMound", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v", ",", "vConst", ",", "f", ",", "cPos"}], "}"}], ",", 
        RowBox[{"OptionValue", "[", "scaleFactor", "]"}], ",", "startVol", 
        ",", 
        RowBox[{"OptionValue", "[", "modulus", "]"}], ",", 
        RowBox[{"OptionValue", "[", "cTolerance", "]"}], ",", 
        RowBox[{"OptionValue", "[", "constraintEq", "]"}], ",", 
        RowBox[{"OptionValue", "[", "contactAngle", "]"}], ",", 
        RowBox[{"OptionValue", "[", "tension", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"OptionValue", "[", "iter", "]"}], ">", "0"}], ",", 
       RowBox[{"iterateMound", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"newV", ",", "newVC", ",", "newF", ",", "newCPos"}], "}"}], 
         ",", "startVol", ",", 
         RowBox[{"scaleFactor", "->", 
          RowBox[{"OptionValue", "[", "scaleFactor", "]"}]}], ",", 
         RowBox[{"iter", "->", 
          RowBox[{
           RowBox[{"OptionValue", "[", "iter", "]"}], "-", "1"}]}], ",", 
         RowBox[{"modulus", "->", 
          RowBox[{"OptionValue", "[", "modulus", "]"}]}], ",", 
         RowBox[{"cTolerance", "->", 
          RowBox[{"OptionValue", "[", "cTolerance", "]"}]}], ",", 
         RowBox[{"contactAngle", "->", 
          RowBox[{"OptionValue", "[", "contactAngle", "]"}]}], ",", 
         RowBox[{"tension", "\[Rule]", 
          RowBox[{"OptionValue", "[", "tension", "]"}]}], ",", 
         RowBox[{"vTolerance", "->", 
          RowBox[{"OptionValue", "[", "vTolerance", "]"}]}]}], "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"Abs", "[", 
            RowBox[{"newV", "-", "v"}], "]"}], "]"}], ">", ".0005"}], ",", 
         RowBox[{"iterateMound", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"newV", ",", "newVC", ",", "newF", ",", "newCPos"}], 
            "}"}], ",", "startVol", ",", 
           RowBox[{"scaleFactor", "->", 
            RowBox[{"OptionValue", "[", "scaleFactor", "]"}]}], ",", 
           RowBox[{"iter", "->", 
            RowBox[{
             RowBox[{"OptionValue", "[", "iter", "]"}], "-", "1"}]}], ",", 
           RowBox[{"modulus", "->", 
            RowBox[{"OptionValue", "[", "modulus", "]"}]}], ",", 
           RowBox[{"cTolerance", "->", 
            RowBox[{"OptionValue", "[", "cTolerance", "]"}]}], ",", 
           RowBox[{"contactAngle", "->", 
            RowBox[{"OptionValue", "[", "contactAngle", "]"}]}], ",", 
           RowBox[{"tension", "\[Rule]", 
            RowBox[{"OptionValue", "[", "tension", "]"}]}], ",", 
           RowBox[{"vTolerance", "->", 
            RowBox[{"OptionValue", "[", "vTolerance", "]"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"v", ",", "vConst", ",", "f", ",", "cPos"}], "}"}]}], 
        "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.824809451962068*^9, 3.8248096932483*^9}, 
   3.824809728541819*^9, 3.824810448820383*^9, 3.824811110807199*^9, {
   3.82481128210227*^9, 3.824811294581511*^9}, 3.8248145147637587`*^9, 
   3.824815283804989*^9, 3.8248153672515717`*^9, {3.8254238327238407`*^9, 
   3.825423938023095*^9}, {3.8254243046925898`*^9, 3.825424366516431*^9}, {
   3.8254244376732283`*^9, 3.825424532623748*^9}, {3.8260222649827137`*^9, 
   3.826022268152923*^9}, {3.826022351860052*^9, 3.826022395511553*^9}, {
   3.8260243287749767`*^9, 3.8260243863886347`*^9}, {3.826024874383087*^9, 
   3.826024880333963*^9}, {3.826024933736301*^9, 3.8260249339027967`*^9}, {
   3.8260249755947104`*^9, 3.826024979133266*^9}, {3.826025050145277*^9, 
   3.826025056706744*^9}, {3.826025738856022*^9, 3.82602573904672*^9}, {
   3.8261246326759243`*^9, 3.826124634910371*^9}, {3.8261994721624413`*^9, 
   3.826199472676455*^9}, {3.82620312247584*^9, 3.826203138618791*^9}, {
   3.82628944413688*^9, 3.826289451168597*^9}, {3.826289491768244*^9, 
   3.8262895231235247`*^9}, {3.8262896299449587`*^9, 3.826289630641375*^9}, {
   3.826290022707951*^9, 3.826290066121709*^9}, {3.826290115369656*^9, 
   3.826290116659577*^9}, {3.826290442519917*^9, 3.826290472681566*^9}, {
   3.827854667770322*^9, 3.827854671272276*^9}, {3.827854728256971*^9, 
   3.8278547500758247`*^9}, {3.827855141786118*^9, 3.827855141912623*^9}, {
   3.827855214144557*^9, 3.827855214281623*^9}, {3.827855379833894*^9, 
   3.827855379947641*^9}, {3.827856366625845*^9, 3.82785638148492*^9}, {
   3.8278584304822693`*^9, 3.827858435405801*^9}, 3.827858559713705*^9, {
   3.827939664673429*^9, 3.827939696847143*^9}, {3.827939817584552*^9, 
   3.827939836559958*^9}, {3.827945630392769*^9, 3.82794566438017*^9}, 
   3.827945712602085*^9, {3.828008355301362*^9, 3.8280084123599567`*^9}, {
   3.8280364885869303`*^9, 3.82803651360585*^9}, {3.8280367006507483`*^9, 
   3.828036703241849*^9}, {3.828037498022954*^9, 3.828037498622509*^9}, 
   3.828037676035316*^9, {3.828037744888421*^9, 3.828037834101186*^9}, {
   3.828037868777872*^9, 3.828037877554603*^9}, {3.828037969296295*^9, 
   3.8280379887219753`*^9}, 3.828038020168803*^9, {3.8280388651334047`*^9, 
   3.8280389676036386`*^9}, {3.828441393544499*^9, 3.828441407754408*^9}, {
   3.828710734220179*^9, 3.8287107798173103`*^9}, {3.828710827693426*^9, 
   3.828710827833798*^9}, {3.8287123891817303`*^9, 3.8287123916406927`*^9}, {
   3.8287124493838987`*^9, 3.8287124500721083`*^9}, {3.828712528602131*^9, 
   3.82871252901548*^9}, {3.828716371537259*^9, 3.828716371651943*^9}, {
   3.8287171272514067`*^9, 3.828717144455934*^9}, 3.82871721837328*^9, {
   3.828717288035857*^9, 3.828717350534157*^9}, {3.82899011182892*^9, 
   3.828990119404173*^9}},
 CellLabel->
  "In[146]:=",ExpressionUUID->"d97ea47e-0a93-4a0e-994c-8c2e2fc448d3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.8248152485291777`*^9, 
  3.824815249919959*^9}},ExpressionUUID->"bee4f3b5-c7e9-4c83-9c6b-\
db93d489a254"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"obj", "=", 
   RowBox[{"Cube", "[", 
    RowBox[{"{", 
     RowBox[{".5", ",", ".5", ",", ".5"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tolerance", "=", ".001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cTol", "=", ".001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"v", ",", "vC", ",", "f", ",", "cPos"}], "}"}], "=", 
   RowBox[{"initGetMeshMound", "[", "obj", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initialVolume", "=", 
   RowBox[{"Volume", "[", 
    RowBox[{"meshedPoly", "[", 
     RowBox[{"v", ",", "f", ",", "cPos"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"contact", "=", "90"}], ";"}]}], "Input",
 CellChangeTimes->{{3.826289537218121*^9, 3.826289544866404*^9}, {
   3.826290422048876*^9, 3.826290425390975*^9}, {3.826290485297662*^9, 
   3.82629052816304*^9}, {3.826290658407545*^9, 3.8262906586904707`*^9}, {
   3.826626199025488*^9, 3.826626199066074*^9}, {3.827155463896944*^9, 
   3.827155464159397*^9}, {3.82715550674166*^9, 3.827155506867806*^9}, {
   3.8271624866304207`*^9, 3.827162486868916*^9}, {3.827162695906185*^9, 
   3.827162695978272*^9}, {3.827843840767055*^9, 3.8278438408781776`*^9}, {
   3.827854763137528*^9, 3.827854763570965*^9}, {3.82785485866507*^9, 
   3.827854867441543*^9}, 3.827858447820553*^9, {3.827858544526415*^9, 
   3.8278585512991953`*^9}, {3.827938750558*^9, 3.82793875063632*^9}, {
   3.827950315913084*^9, 3.827950353887637*^9}, {3.828008419208729*^9, 
   3.828008421415641*^9}, {3.8280407366397867`*^9, 3.828040736922482*^9}, {
   3.8286470473876467`*^9, 3.828647047474423*^9}, {3.828647402848009*^9, 
   3.828647402959626*^9}, {3.828647622077117*^9, 3.828647638290682*^9}, {
   3.828648137680496*^9, 3.8286481377331953`*^9}, {3.828693880499584*^9, 
   3.828693880596085*^9}, {3.828712554335483*^9, 3.828712556064929*^9}, {
   3.82871512711167*^9, 3.828715133829711*^9}, {3.8287159635178328`*^9, 
   3.828715964779319*^9}, {3.828716036130987*^9, 3.8287160367191687`*^9}, {
   3.828716189540874*^9, 3.8287162115762463`*^9}, {3.828717420118704*^9, 
   3.8287174202055387`*^9}, {3.828717481301858*^9, 3.82871748145689*^9}, {
   3.828965286967387*^9, 3.828965287029421*^9}, {3.828990130201387*^9, 
   3.828990132384281*^9}},
 CellLabel->
  "In[147]:=",ExpressionUUID->"ed55e9ec-5ff7-4338-bf72-175e2a7631cd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"step1", "=", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Polyhedron", "@@", 
       RowBox[{"{", 
        RowBox[{"v", ",", "f"}], "}"}]}], ",", 
      RowBox[{"InfinitePlane", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1", ",", "0"}], "}"}]}], "}"}], "]"}]}], 
     "}"}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"v", ",", "vC", ",", "f", ",", "cPos"}], "}"}], "=", 
   RowBox[{"iterateMound", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v", ",", "vC", ",", "f", ",", "cPos"}], "}"}], ",", 
     "initialVolume", ",", 
     RowBox[{"contactAngle", "\[Rule]", "contact"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"step2", "=", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Polyhedron", "@@", 
       RowBox[{"{", 
        RowBox[{"v", ",", "f"}], "}"}]}], ",", 
      RowBox[{"InfinitePlane", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1", ",", "0"}], "}"}]}], "}"}], "]"}]}], 
     "}"}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"v", ",", "vC", ",", "f", ",", "cPos"}], "}"}], "=", 
   RowBox[{"getMeshMound", "[", 
    RowBox[{"v", ",", "vC", ",", "f", ",", "cPos"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"v", ",", "vC", ",", "f", ",", "cPos"}], "}"}], "=", 
   RowBox[{"iterateMound", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v", ",", "vC", ",", "f", ",", "cPos"}], "}"}], ",", 
     "initialVolume", ",", 
     RowBox[{"contactAngle", "\[Rule]", "contact"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"step3", "=", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Polyhedron", "@@", 
       RowBox[{"{", 
        RowBox[{"v", ",", "f"}], "}"}]}], ",", 
      RowBox[{"InfinitePlane", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1", ",", "0"}], "}"}]}], "}"}], "]"}]}], 
     "}"}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"v", ",", "vC", ",", "f", ",", "cPos"}], "}"}], "=", 
   RowBox[{"getMeshMound", "[", 
    RowBox[{"v", ",", "vC", ",", "f", ",", "cPos"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"v", ",", "vC", ",", "f", ",", "cPos"}], "}"}], "=", 
   RowBox[{"iterateMound", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v", ",", "vC", ",", "f", ",", "cPos"}], "}"}], ",", 
     "initialVolume", ",", 
     RowBox[{"contactAngle", "\[Rule]", "contact"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"step4", "=", 
  RowBox[{"Graphics3D", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Polyhedron", "@@", 
      RowBox[{"{", 
       RowBox[{"v", ",", "f"}], "}"}]}], ",", 
     RowBox[{"InfinitePlane", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1", ",", "0"}], "}"}]}], "}"}], "]"}]}], 
    "}"}], "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8202566529516897`*^9, 3.8202566919856663`*^9}, 
   3.820256792655287*^9, 3.8202572627878723`*^9, {3.8202574250765123`*^9, 
   3.820257493759408*^9}, {3.820258158732257*^9, 3.82025822493463*^9}, {
   3.820675191892418*^9, 3.820675253798976*^9}, {3.820675363294653*^9, 
   3.820675394474579*^9}, {3.820675579711392*^9, 3.8206756147098513`*^9}, {
   3.820676095780999*^9, 3.820676101922632*^9}, {3.8206763888070717`*^9, 
   3.820676407790256*^9}, {3.820676443114524*^9, 3.820676443238077*^9}, {
   3.820676794638074*^9, 3.8206767948860083`*^9}, {3.820676831619481*^9, 
   3.820676863780723*^9}, 3.820852179846374*^9, {3.8208523000586357`*^9, 
   3.820852308617324*^9}, {3.8208523422133503`*^9, 3.820852363268197*^9}, {
   3.8208524745951633`*^9, 3.820852501225462*^9}, {3.820852596290237*^9, 
   3.820852596729938*^9}, {3.82085264214128*^9, 3.8208526559756603`*^9}, {
   3.8208538684119377`*^9, 3.8208538686172028`*^9}, {3.8208550094440107`*^9, 
   3.8208550114003353`*^9}, {3.8208550680951157`*^9, 3.820855083405179*^9}, {
   3.820855556149076*^9, 3.820855557534725*^9}, {3.8208591632107897`*^9, 
   3.820859169971287*^9}, {3.820859271312854*^9, 3.820859320097547*^9}, {
   3.820859356385603*^9, 3.820859376023468*^9}, {3.820859563013259*^9, 
   3.8208596583612757`*^9}, {3.820928632501548*^9, 3.820928726243164*^9}, {
   3.820929989771874*^9, 3.820930024443892*^9}, {3.821192479303022*^9, 
   3.821192517236437*^9}, {3.8212794035906267`*^9, 3.821279632899721*^9}, {
   3.821279671272073*^9, 3.821279695798986*^9}, {3.821279735091083*^9, 
   3.821279839410397*^9}, {3.82127987990703*^9, 3.821279895584388*^9}, {
   3.821280002265456*^9, 3.821280002359969*^9}, {3.821280998514889*^9, 
   3.8212810108612423`*^9}, {3.821281045039361*^9, 3.8212810586849623`*^9}, {
   3.8212814422015457`*^9, 3.821281487461522*^9}, {3.821281788716509*^9, 
   3.821281822231297*^9}, {3.8212819179531517`*^9, 3.82128193429692*^9}, {
   3.821530221059534*^9, 3.821530292322084*^9}, {3.8215304511548*^9, 
   3.821530483054681*^9}, {3.821531019867538*^9, 3.821531035049078*^9}, {
   3.821531266983388*^9, 3.821531267232239*^9}, {3.821531304095949*^9, 
   3.8215313738049107`*^9}, {3.8225776212669888`*^9, 3.822577621516759*^9}, {
   3.822578349294783*^9, 3.822578363671851*^9}, {3.822578396912531*^9, 
   3.822578399690667*^9}, {3.822578555883698*^9, 3.822578556860018*^9}, {
   3.822578590097849*^9, 3.822578597965301*^9}, {3.8225786530541477`*^9, 
   3.822578749729951*^9}, 3.82257888787357*^9, 3.8225789251748343`*^9, {
   3.822579002602724*^9, 3.8225790806035967`*^9}, {3.822579122083126*^9, 
   3.822579155171658*^9}, {3.822579248660515*^9, 3.822579263275393*^9}, {
   3.8225793152834263`*^9, 3.8225794223814373`*^9}, {3.822579469287463*^9, 
   3.822579486715478*^9}, {3.822579582642723*^9, 3.822579585081792*^9}, {
   3.822579619785828*^9, 3.822579666763192*^9}, {3.822579699611951*^9, 
   3.82257976284225*^9}, {3.8225798105477953`*^9, 3.822579840523944*^9}, {
   3.822579940245893*^9, 3.822579946732909*^9}, 3.82257998491737*^9, {
   3.822580017013583*^9, 3.8225800331998463`*^9}, {3.8230003726855164`*^9, 
   3.823000406286256*^9}, {3.823000439762891*^9, 3.823000512278216*^9}, {
   3.823605404035084*^9, 3.8236054101745157`*^9}, {3.823605857196456*^9, 
   3.823605875217909*^9}, {3.8236060665784273`*^9, 3.82360616438807*^9}, 
   3.823606196551153*^9, {3.823606243135713*^9, 3.823606243280201*^9}, {
   3.823606439709218*^9, 3.823606468071328*^9}, {3.823606499189307*^9, 
   3.823606521119773*^9}, {3.82360655777043*^9, 3.823606611183384*^9}, {
   3.82360670331703*^9, 3.8236067239606237`*^9}, {3.82360678602295*^9, 
   3.82360678969221*^9}, {3.823606820652409*^9, 3.8236068466148453`*^9}, {
   3.823607051808217*^9, 3.823607076677177*^9}, {3.823607121233717*^9, 
   3.823607129497675*^9}, {3.823607164182527*^9, 3.82360718604184*^9}, {
   3.823607268212598*^9, 3.8236072859860086`*^9}, {3.8237949461383867`*^9, 
   3.823794955295192*^9}, {3.824215120869668*^9, 3.824215126607683*^9}, {
   3.824305093678013*^9, 3.8243051657532253`*^9}, {3.824305262705901*^9, 
   3.824305266279784*^9}, {3.824809449688939*^9, 3.8248094501330976`*^9}, {
   3.824809698869791*^9, 3.824809730671735*^9}, {3.82481004835037*^9, 
   3.8248101078352013`*^9}, {3.824810178175168*^9, 3.824810211107188*^9}, {
   3.82481035711023*^9, 3.8248103588421497`*^9}, {3.824810435609084*^9, 
   3.824810435832616*^9}, {3.824810467705926*^9, 3.824810570903144*^9}, {
   3.824810638967781*^9, 3.8248107207014236`*^9}, {3.8248107574416647`*^9, 
   3.824810759338522*^9}, {3.824810795759466*^9, 3.8248108110795507`*^9}, {
   3.82481091962007*^9, 3.82481099380227*^9}, {3.8248111201563253`*^9, 
   3.824811120378463*^9}, {3.824811261690407*^9, 3.824811308949909*^9}, {
   3.824811882441607*^9, 3.824811882891325*^9}, {3.824811936848382*^9, 
   3.8248119369494677`*^9}, {3.824812031211809*^9, 3.824812033070765*^9}, {
   3.824814467570139*^9, 3.824814498835258*^9}, {3.8248145404184647`*^9, 
   3.824814542027297*^9}, {3.824815076245338*^9, 3.8248151175508842`*^9}, {
   3.8248151483939447`*^9, 3.824815165285357*^9}, 3.8248151991416388`*^9, {
   3.824815334272336*^9, 3.824815356574319*^9}, {3.82542457121392*^9, 
   3.825424576832386*^9}, {3.826022540305305*^9, 3.826022563083538*^9}, {
   3.82602441171976*^9, 3.82602444696765*^9}, {3.826024753587693*^9, 
   3.826024759943321*^9}, {3.826024847352227*^9, 3.8260248528576202`*^9}, 
   3.826025130247532*^9, {3.82602518490561*^9, 3.826025189770849*^9}, {
   3.826025257470001*^9, 3.8260252866497107`*^9}, {3.826025726280465*^9, 
   3.826025732157689*^9}, {3.82612458838153*^9, 3.826124589918363*^9}, {
   3.826199467025078*^9, 3.826199467423098*^9}, {3.826201439344924*^9, 
   3.826201441242865*^9}, 3.8262046734360332`*^9, 3.826289548292644*^9, {
   3.826289583171082*^9, 3.826289599804439*^9}, {3.82628966094512*^9, 
   3.8262896637192802`*^9}, 3.8262897276014013`*^9, 3.8262900074299173`*^9, {
   3.826290348444929*^9, 3.8262903722468452`*^9}, {3.826290430843782*^9, 
   3.8262904540260153`*^9}, {3.826290592615787*^9, 3.826290596515313*^9}, {
   3.827854770234316*^9, 3.827854823367269*^9}, {3.8278552248808193`*^9, 
   3.827855237981185*^9}, 3.827855329135419*^9, 3.827858740361142*^9, {
   3.827858806933852*^9, 3.8278588081940317`*^9}, {3.8279415408955927`*^9, 
   3.827941547520412*^9}, {3.827941577982856*^9, 3.827941581056498*^9}, {
   3.8279416156857347`*^9, 3.827941648276395*^9}, {3.827950360121126*^9, 
   3.827950368264844*^9}, {3.827950404535832*^9, 3.827950413620928*^9}, {
   3.8279521204632196`*^9, 3.827952127609576*^9}, {3.828008432503516*^9, 
   3.8280084456613417`*^9}, 3.828008678449757*^9, 3.828008989435936*^9, {
   3.828009030101132*^9, 3.8280090959204483`*^9}, {3.8280094544059887`*^9, 
   3.828009470226563*^9}, {3.828030219098585*^9, 3.828030222847484*^9}, {
   3.8280390976639843`*^9, 3.828039136519278*^9}, {3.828039474801906*^9, 
   3.8280394753199244`*^9}, {3.8280400522482967`*^9, 3.828040053516588*^9}, {
   3.828646960712572*^9, 3.828646965898375*^9}, {3.828647057579236*^9, 
   3.828647059402693*^9}, {3.828647185463574*^9, 3.8286472044980507`*^9}, {
   3.828647255590876*^9, 3.828647256679305*^9}, {3.8286475970182457`*^9, 
   3.828647606750968*^9}, {3.828647727440168*^9, 3.828647734124503*^9}, 
   3.828694175836898*^9, {3.82869420927144*^9, 3.828694246651116*^9}, {
   3.828694323706285*^9, 3.828694326564541*^9}, {3.8287107944212112`*^9, 
   3.8287108134490843`*^9}, {3.828716215001664*^9, 3.8287162865764103`*^9}, {
   3.8287171985676317`*^9, 3.828717200476787*^9}, {3.8287172345049667`*^9, 
   3.828717234724621*^9}, {3.828717322740739*^9, 3.828717323094139*^9}, {
   3.8287174035459213`*^9, 3.8287174158806677`*^9}, {3.82899013640343*^9, 
   3.8289901431724157`*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"7cd56961-a230-4268-877f-bf1bbbfc3b26"],

Cell[BoxData[
 Graphics3DBox[{
   TagBox[GraphicsComplex3DBox[CompressedData["
1:eJxTTMoPSmViYGDgA2JmBnTwwR47H5c4qQDdPEI0Iftg4g/QaBh4YI9dHS59
uPSj83HRH+wBtmYg8g==
     "], 
     Polygon3DBox[{{5, 6, 10}, {6, 2, 10}, {2, 1, 10}, {1, 5, 10}, {6, 7, 
      11}, {7, 3, 11}, {3, 2, 11}, {2, 6, 11}, {7, 8, 12}, {8, 4, 12}, {4, 3, 
      12}, {3, 7, 12}, {8, 5, 13}, {5, 1, 13}, {1, 4, 13}, {4, 8, 13}, {8, 7, 
      14}, {7, 6, 14}, {6, 5, 14}, {5, 8, 14}}]],
    "Polyhedron"], 
   TagBox[ConicHullRegion3DBox[{{0, 0, 0}, {1, 1, 0}, {-1, 1, 0}}],
    "InfinitePlane"]},
  ImageSize->{434.86666953241706`, 149.63585353734467`},
  ImageSizeRaw->Automatic,
  ViewPoint->{0.33902099931149704`, -3.3545089780847097`, 
   0.28693950229082826`},
  ViewVertical->{0.050254540705341036`, -0.43321786891359193`, 
   0.8998870813565784}]], "Output",
 CellChangeTimes->{{3.828037664257061*^9, 3.8280376853287077`*^9}, 
   3.828037883121891*^9, {3.828037994755659*^9, 3.828038023306951*^9}, 
   3.828038973519706*^9, {3.828039138837233*^9, 3.828039158836677*^9}, 
   3.828039551061068*^9, 3.828039651916697*^9, {3.82803992044917*^9, 
   3.828039929053303*^9}, 3.828040054577218*^9, 3.8280407697464447`*^9, {
   3.8286469144791937`*^9, 3.828646976121447*^9}, 3.828647022530549*^9, 
   3.828647147027066*^9, {3.828647205134288*^9, 3.828647211521475*^9}, 
   3.82864726522396*^9, {3.828647386374319*^9, 3.828647404568801*^9}, {
   3.8286476097314034`*^9, 3.828647639701354*^9}, {3.8286477077587852`*^9, 
   3.828647734449304*^9}, 3.828648139520978*^9, 3.828693788125243*^9, 
   3.828693882451128*^9, 3.828693935846961*^9, {3.828694176921657*^9, 
   3.828694181525034*^9}, {3.8286942366391582`*^9, 3.828694248440386*^9}, 
   3.828694330255031*^9, 3.828710783012478*^9, {3.8287108138602047`*^9, 
   3.828710819345571*^9}, {3.828710930539813*^9, 3.82871095563153*^9}, 
   3.8287123091080437`*^9, 3.828712399503759*^9, 3.828712458790243*^9, {
   3.828712534761818*^9, 3.828712557452269*^9}, 3.8287161626338377`*^9, {
   3.828716294284276*^9, 3.828716312749693*^9}, 3.8287163778733797`*^9, 
   3.828717051030943*^9, {3.828717081775515*^9, 3.8287170905246477`*^9}, 
   3.8287171488760643`*^9, 3.8287171905224533`*^9, {3.82871731802011*^9, 
   3.82871735322164*^9}, 3.828717422625012*^9, 3.828717483028571*^9, 
   3.8289652601576147`*^9, 3.828965351800434*^9, {3.828967635941729*^9, 
   3.828967654863311*^9}, {3.828990123613899*^9, 3.82899017287335*^9}, 
   3.828990203537469*^9, 3.828990251624481*^9, 3.828990311374551*^9},
 CellLabel->
  "Out[153]=",ExpressionUUID->"3b411223-d444-4ca6-8dd1-936ce48ce515"],

Cell[BoxData[
 Graphics3DBox[{
   TagBox[GraphicsComplex3DBox[CompressedData["
1:eJxTTMoPSmViYGDgA2JmIOZPvPvl9Zpz+5XXzK6be/WzPQMUKEH5SmjiilA+
H1QfTFwQykcXlxU5M1n+2DH7H794pCv8Xtm/f3X6rsnbp/a/oXwY/RYqDlMn
B9UHE1eE8uXRxCG2PECjYeCBvfDzN50eZz/ZpxvMPhXPdtdeCMqHyWdAxWH8
fot0f5esY/vToOKToXyYfBqaehg943egt+WSF/YA0X+Kjw==
     "], 
     Polygon3DBox[{{5, 6, 10}, {6, 2, 10}, {2, 1, 10}, {1, 5, 10}, {6, 7, 
      11}, {7, 3, 11}, {3, 2, 11}, {2, 6, 11}, {7, 8, 12}, {8, 4, 12}, {4, 3, 
      12}, {3, 7, 12}, {8, 5, 13}, {5, 1, 13}, {1, 4, 13}, {4, 8, 13}, {8, 7, 
      14}, {7, 6, 14}, {6, 5, 14}, {5, 8, 14}}]],
    "Polyhedron"], 
   TagBox[ConicHullRegion3DBox[{{0, 0, 0}, {1, 1, 0}, {-1, 1, 0}}],
    "InfinitePlane"]},
  ImageSize->{434.86666953241706`, 149.63585353734467`},
  ImageSizeRaw->Automatic,
  ViewPoint->{0.33902099931149704`, -3.3545089780847097`, 
   0.28693950229082826`},
  ViewVertical->{0.050254540705341036`, -0.43321786891359193`, 
   0.8998870813565784}]], "Output",
 CellChangeTimes->{{3.828037664257061*^9, 3.8280376853287077`*^9}, 
   3.828037883121891*^9, {3.828037994755659*^9, 3.828038023306951*^9}, 
   3.828038973519706*^9, {3.828039138837233*^9, 3.828039158836677*^9}, 
   3.828039551061068*^9, 3.828039651916697*^9, {3.82803992044917*^9, 
   3.828039929053303*^9}, 3.828040054577218*^9, 3.8280407697464447`*^9, {
   3.8286469144791937`*^9, 3.828646976121447*^9}, 3.828647022530549*^9, 
   3.828647147027066*^9, {3.828647205134288*^9, 3.828647211521475*^9}, 
   3.82864726522396*^9, {3.828647386374319*^9, 3.828647404568801*^9}, {
   3.8286476097314034`*^9, 3.828647639701354*^9}, {3.8286477077587852`*^9, 
   3.828647734449304*^9}, 3.828648139520978*^9, 3.828693788125243*^9, 
   3.828693882451128*^9, 3.828693935846961*^9, {3.828694176921657*^9, 
   3.828694181525034*^9}, {3.8286942366391582`*^9, 3.828694248440386*^9}, 
   3.828694330255031*^9, 3.828710783012478*^9, {3.8287108138602047`*^9, 
   3.828710819345571*^9}, {3.828710930539813*^9, 3.82871095563153*^9}, 
   3.8287123091080437`*^9, 3.828712399503759*^9, 3.828712458790243*^9, {
   3.828712534761818*^9, 3.828712557452269*^9}, 3.8287161626338377`*^9, {
   3.828716294284276*^9, 3.828716312749693*^9}, 3.8287163778733797`*^9, 
   3.828717051030943*^9, {3.828717081775515*^9, 3.8287170905246477`*^9}, 
   3.8287171488760643`*^9, 3.8287171905224533`*^9, {3.82871731802011*^9, 
   3.82871735322164*^9}, 3.828717422625012*^9, 3.828717483028571*^9, 
   3.8289652601576147`*^9, 3.828965351800434*^9, {3.828967635941729*^9, 
   3.828967654863311*^9}, {3.828990123613899*^9, 3.82899017287335*^9}, 
   3.828990203537469*^9, 3.828990251624481*^9, 3.8289903129022007`*^9},
 CellLabel->
  "Out[155]=",ExpressionUUID->"10a5dc9e-755e-4195-9563-4aeccea6e6db"],

Cell[BoxData[
 Graphics3DBox[{
   TagBox[GraphicsComplex3DBox[CompressedData["
1:eJxTTMoPSmViYGDQA2JmIGbpvlX5zXH//jUr5qbLf/lozwAF66D8tWjiq6F8
Lqg+mPibLgj/YRequDpL2/uSAyfs/9fJHXl0/qX9Dw0nl1alJ3D+Pyj9FSoO
42tC9cHUy0L5cmjiEFseoNEw8MA+/bv1sacJn+xfW+m89bt8G86Hyb+AisP4
vrvvG+qxH97/CCruA+XD5B+jqYfRl3SOcKo5PbdnhPJvfLo5y7XxlX1sxz5u
v3lP7bPfW/QWL3hqH/b4eLap8wf79o8bWc/veGhvotj3VGL/Fbh4J1T8X+IS
4VKfD/b/ofQBp/Nf1O2u21doWh/7E/nCfnP4wY1njny23+d/+N99t4twd8hO
dtTgXfMVHg6OUcLPeWacs98CVX8Eqp69XuKli+zk/QxJEPNPQ82/BXU3zB/R
UPeHQt1nDnUvzJ0wd+dA/dcGFYeZ+6MOYs9JqPkwdzhA3XUA6h5UdyPiEeZP
mL/3o/l3qcmMKS9/HYWHswXUfRXXfnyMOjthfxPUPRlQ99lCxZuh4pHQcEiG
0heh7rSAum/JXq6+VLVz+/dC7f33HwTu25f7sC002XANns7LoO5bgKZ+MdR9
MPfC3BkAdQfMXTD3xEHFYf6AicPMhYUDzPwKqDsY0cJtGVS9NdQfMPUvLtRs
PLD+ib1VHNvcugXX7A9dnJi0ct8zewso3xpKH4aKv4Sqh9EH0dTDzIOZAwD3
CAeO
     "], 
     Polygon3DBox[{{16, 15, 6}, {17, 16, 10}, {15, 17, 5}, {15, 16, 17}, {19, 
      18, 2}, {16, 19, 10}, {18, 16, 6}, {18, 19, 16}, {21, 20, 1}, {19, 21, 
      10}, {20, 19, 2}, {20, 21, 19}, {17, 22, 5}, {21, 17, 10}, {22, 21, 
      1}, {22, 17, 21}, {24, 23, 7}, {25, 24, 11}, {23, 25, 6}, {23, 24, 
      25}, {27, 26, 3}, {24, 27, 11}, {26, 24, 7}, {26, 27, 24}, {29, 28, 
      2}, {27, 29, 11}, {28, 27, 3}, {28, 29, 27}, {25, 18, 6}, {29, 25, 
      11}, {18, 29, 2}, {18, 25, 29}, {31, 30, 8}, {32, 31, 12}, {30, 32, 
      7}, {30, 31, 32}, {34, 33, 4}, {31, 34, 12}, {33, 31, 8}, {33, 34, 
      31}, {36, 35, 3}, {34, 36, 12}, {35, 34, 4}, {35, 36, 34}, {32, 26, 
      7}, {36, 32, 12}, {26, 36, 3}, {26, 32, 36}, {38, 37, 5}, {39, 38, 
      13}, {37, 39, 8}, {37, 38, 39}, {40, 22, 1}, {38, 40, 13}, {22, 38, 
      5}, {22, 40, 38}, {42, 41, 4}, {40, 42, 13}, {41, 40, 1}, {41, 42, 
      40}, {39, 33, 8}, {42, 39, 13}, {33, 42, 4}, {33, 39, 42}, {43, 30, 
      7}, {44, 43, 14}, {30, 44, 8}, {30, 43, 44}, {45, 23, 6}, {43, 45, 
      14}, {23, 43, 7}, {23, 45, 43}, {46, 15, 5}, {45, 46, 14}, {15, 45, 
      6}, {15, 46, 45}, {44, 37, 8}, {46, 44, 14}, {37, 46, 5}, {37, 44, 
      46}}]],
    "Polyhedron"], 
   TagBox[ConicHullRegion3DBox[{{0, 0, 0}, {1, 1, 0}, {-1, 1, 0}}],
    "InfinitePlane"]},
  ImageSize->{434.86666953241706`, 149.63585353734467`},
  ImageSizeRaw->Automatic,
  ViewPoint->{0.33902099931149704`, -3.3545089780847097`, 
   0.28693950229082826`},
  ViewVertical->{0.050254540705341036`, -0.43321786891359193`, 
   0.8998870813565784}]], "Output",
 CellChangeTimes->{{3.828037664257061*^9, 3.8280376853287077`*^9}, 
   3.828037883121891*^9, {3.828037994755659*^9, 3.828038023306951*^9}, 
   3.828038973519706*^9, {3.828039138837233*^9, 3.828039158836677*^9}, 
   3.828039551061068*^9, 3.828039651916697*^9, {3.82803992044917*^9, 
   3.828039929053303*^9}, 3.828040054577218*^9, 3.8280407697464447`*^9, {
   3.8286469144791937`*^9, 3.828646976121447*^9}, 3.828647022530549*^9, 
   3.828647147027066*^9, {3.828647205134288*^9, 3.828647211521475*^9}, 
   3.82864726522396*^9, {3.828647386374319*^9, 3.828647404568801*^9}, {
   3.8286476097314034`*^9, 3.828647639701354*^9}, {3.8286477077587852`*^9, 
   3.828647734449304*^9}, 3.828648139520978*^9, 3.828693788125243*^9, 
   3.828693882451128*^9, 3.828693935846961*^9, {3.828694176921657*^9, 
   3.828694181525034*^9}, {3.8286942366391582`*^9, 3.828694248440386*^9}, 
   3.828694330255031*^9, 3.828710783012478*^9, {3.8287108138602047`*^9, 
   3.828710819345571*^9}, {3.828710930539813*^9, 3.82871095563153*^9}, 
   3.8287123091080437`*^9, 3.828712399503759*^9, 3.828712458790243*^9, {
   3.828712534761818*^9, 3.828712557452269*^9}, 3.8287161626338377`*^9, {
   3.828716294284276*^9, 3.828716312749693*^9}, 3.8287163778733797`*^9, 
   3.828717051030943*^9, {3.828717081775515*^9, 3.8287170905246477`*^9}, 
   3.8287171488760643`*^9, 3.8287171905224533`*^9, {3.82871731802011*^9, 
   3.82871735322164*^9}, 3.828717422625012*^9, 3.828717483028571*^9, 
   3.8289652601576147`*^9, 3.828965351800434*^9, {3.828967635941729*^9, 
   3.828967654863311*^9}, {3.828990123613899*^9, 3.82899017287335*^9}, 
   3.828990203537469*^9, 3.828990251624481*^9, 3.828990321980439*^9},
 CellLabel->
  "Out[158]=",ExpressionUUID->"f9fbe234-95a5-421f-ba7e-8030038db91c"],

Cell[BoxData[
 Graphics3DBox[{
   TagBox[GraphicsComplex3DBox[CompressedData["
1:eJxllgtUjGkYx7vZs21EbCeXyKLSusVu7KJ9LKtjhTatSdSwLlsppOtuqFWp
lHTQZTcszrrfJ4oon8m2KRwzZNIMUqZGEukml7Kc/s/s2c+c03nP+8w77/N/
/s/v+b4+W7J67nIjAwODI+/+jN/9rT3oMHzSmDwhLCsmu3nbczLAJwJ7cTwU
+xj8juOLsJ8nitsci5XXTC0hI8vdqS4n62hLjlleN8VDMsSe12RRfCh+x+et
sOc1FfGuLA9EK38eUF5qxYanc5poUkHEkQs7NPo9f/8V4ry/t/6aeWhEoTAG
cd7z946i87wGdjjESRx0ZIj9VgvXdXHLHtNiM8txY+fVUN+NGUe9N9eQva7O
JM22kRa8tki3XlFFFa03D7noyvRxb8TVKz0elQ1sJA3W5bfzj/tlqihdcl1a
PPARudcFX2iOaiZbyaLsJTcVeh3O4cEx96a36n24vr80rjrxBs3F+RE4n1b+
/uL1wl3cvxL3b4durkMK/XbQdxd6WSfr7of6vBDneyXIE4D7Wcc16LKDnv/r
/q+PXGca6rYT1Xs575b505X/6H1WQ9/mtOZQo9IYQQI9ltA3GnFPxOV3uvTV
YA2DzovQlzwzU7PrxVVhOPJ2vn3/qaTnd0pMw61u6zlnfQmi86yP9bLOBdDB
ulhPEuJcB+uPx70ZyMP3N0GHoci3LThfiDrscd5qRNDr/fu0pDlsY3omV0W7
sq1ln8fW0h3s1aJ4X5zndSfiFTjH9/H51J5pumM3qilxX53FmYQGehQx1jxS
9pA2mlzLH/FES9nz/B4GjHtMyaub/INatXQ436TK4KyOfEb/lhpq20Brf/16
j+ZeNRmhnqEdL33sZzVSaaXk3Ke3qsjfxnTDeUU1lb+4btnh+ZzWhow6ZH6i
kr6QN3QkSdWkQjwa8foH5Y4HFqspSaSnIL7NuXOrQp93PfJ2tvnGH7JX0RmR
zp8vuOf2jXpCK143jeowbSJ7a/nH1lPKyLXNYYLVgOf6NfrgghbrycVk373v
kFs2T2mQzaHBd+ubaLvNR+pkiZxcPCov7uuuo1LVRM9tvZvoasvAncIWNTn1
9PDZO0xLwUp5U/zgZvrl6QZTK0FFl9+Y+gxxrKc1sgp5gte7OZ1Ya5+09x5Z
OE0aJ3dv0K9nS+YPuG/xgPJ3zWgo21FOFjVObs8KWshYnWPkMkdOgwbFRcnc
iilk6ZMKj/4tek52O0ffv250gmygMws6TeB/urNqhdashTa0Wx81z1PSziqv
6QW55XqdkdA5VLZwk+U4rT5vR0VX3rB26Z4+Ix9/kLdHjzvJ4XSZglHXGtSl
9LRb1bYmh/qgrguoK9br25jcWqXeNwV8s7ANnj2xZz4FoC9j0JfsZbuDQ2Qy
gfuSiL5sAgdPwIUOPJxGv7n/3Hdv8CGAF+aEuWSfSsAn8zcePK4Dhxxnfplb
5pLnphZ6OO8RzAfPBXPJ85QEnVx/b/gxUsTnKfgRBx+433vR/3T0vQT+xsFv
9pn7vQP9D0ffmcte6Cf3sTf6p0A/z6OPzAfz0glOQsFHCHjR//8AnXaYpzTo
ZC7Z/yjwyTp5niKgk/PyfBhhLphLng/Oy3UVYv5WoS72h+f4Gvzxh/9+eE44
wH/mbIsmO2hR4WnSor+vwNnsw9LgH8YX02b0MR+c9UrpjF1YlvvB8zDx++io
ctPtwt/gjTnbub7SWxmdI6wGV77gLBPxIMRTwNk2kZ6D4Gy4KG8cOHOHzhTo
7BzWxdkMTebqOrdLgiPqPQ7ODmNNAW8J4KyxfUq3KmmxwH2MAWfSXFXetrRL
QhH8zAJnWcnmGRNMSoQg9NEMnG33Dgxv/ClD4OdhHjg7h7UAvA0BZ9+llU8u
eHFTeAPegsDZzRSZr5u/Qv8eHwrOXol0sv+StvlHt45RCGvB25fg7A+RzvPg
jPMy5w7g7IYoL3M2E3UFoq6p4EwCf67AH19w9g38HwX/mTPuM/fXDf3j5wbz
Ngz9Fj9nAsEZ110E3rLAE/PFXHHcCTxyfDP08Bywnn7Iy+/hdcjrCp2vMR+s
k+vk+eJ6X6BPtuhbBvrlCb+mwT/27Xf0iZ8Pa9AvH/jO71v23wX9K0A/+b2m
RP8cRc+NZujJBO/MD3NjDD/XgZ8d0MPvVeZnOvIOA7+cl3kNFj0nI6Gf54Of
VwvhA78/2QdX+GmA98Vo+DnrE3up8fxqMgibFVCpVNCPtu6B8x1qyfBZodp1
so56D4mc6ZegJBk5F/3pX6OfC5s8x4NR6SoacKq0de/dWlL4K68Ye1bTspE+
q9rdNWQWf0CqNdXRUuyXi+IB9bJpL900ZCjKa458vbCeRt6NRV4ze2XqaDb0
zsV5I+jk9STOh/zle2xKjpbY//4inbyynljcHwhdHrifdcbge9ZpAX2cV+xP
GPJzXvZBnJfr4fyc921oly8rkZ/zDoTvXBf7z+e5n3z+XxHqn5A=
     "], 
     Polygon3DBox[CompressedData["
1:eJwNxWdbMQoAANB2nhYqJCFKymwr0kDDioysUKJkRBO9okgaRIUihcrqV957
vhyMwSEx1NXU1CzW1tTU//8oFTg22kQdA1FHxybGQZMTLeOT4PGJyekpMG26
cYoGnJqmjVNBU+Ng6hSQOj41O9NJn62boXfNzNLnGF0Tcy2MCRBjbmKMCZof
a2LOdzLH5hkzXUwGaIbZOcNgLi50Ly3WLixBFhaX2CzIHLuFNdfFYs/ROV3L
9DrOcjeHvsxagHBYXQuc7gUWZ3UFOr3auDINXlmdnlwDsydb1tiQtUn2EhfC
W6rl8qDcJd7aCpi7BlnhQlfWuAI+TCho5gt7+AKhaL1HLGpdF8PXRWLJBlwq
adqQwjYk0nV+z8Y6nL8B469vyGW9m/J62SZCJt9UKhAiZatC1KNQioSqHrWw
WaXuVQnVChlCpeiRqXplCtWWpk+7VafRIjVbWr0OqdS36pQInV65uY3Y2azf
3unb3tzRaZDbOoRmu0+j2543dErmmwwSuGFeIt6F68Wtu3rkrlivNSJntXXG
2U6jdnbXADfuIg3GTsOucc+E2t8DmPbRpr39AzPactBmtvSbDyw2a7/d1my1
o6w2u9mEtpr7TVaUyWx1HGKcjoZDJ/bQ4Tw+wh4ctx0doI+OD/ZP0Kf7gJNT
zMn+6dEh9uQIfXiCOTw6OT8bcJ3Xn7kGz85dHvfgsafNfYx1e46dF9h/zoaL
fwMXzn/us8ELN/bsYuDMfaH29trUzV5bv1dts1z2eyxtl57BS4vH5RuUu+p9
8l6fS37p7fddDnp9vd5L35Ufd33V6L8e8l9dBwNDN8H2wA0+ELy5DeHDt4BQ
GBe6DQf8Q6EA3h/C+QMh3h30nld7dz98x7t/fBgOPrY/BIceHoPXkaHV68bI
KjRyvfpwNxx5GLqLQO8eIk/RkdhTQzRGiD7FnuOEx+f2+ONw/Pnx/mX49b72
5XXk5f41HiW8xIejLyPR+MtpAnN7Ckjc4hOntzdJ/PNNe/KZkLx5jqUIjlhD
yoFJxRzJBD6VJCRSmEQyZX9Dvdub396Jb/b3TJr4kelIf5DSmY/PLGnvE5Dd
Q2U/99JvxGya9JZFvaWz0i9YTtr0lSN/SXOFPDlT6MhniPlC5v2bKHhv/hbA
vt8F+S/yd5749Q37yn/TfoC/tMafX8oP7bdUpBRKHcUCuVgq5Mrk0VxTeRRY
zo0WfyjlIvmnDPwplsMV3GcYUPkkVcKfH1VS6aOjWqJUP0q/f5Sr38a/K9zf
71W1QvqrUip/uEr17z8hUEp0
      "]]],
    "Polyhedron"], 
   TagBox[ConicHullRegion3DBox[{{0, 0, 0}, {1, 1, 0}, {-1, 1, 0}}],
    "InfinitePlane"]},
  ImageSize->{434.86666953241706`, 149.63585353734467`},
  ImageSizeRaw->Automatic,
  ViewPoint->{0.33902099931149704`, -3.3545089780847097`, 
   0.28693950229082826`},
  ViewVertical->{0.050254540705341036`, -0.43321786891359193`, 
   0.8998870813565784}]], "Output",
 CellChangeTimes->{{3.828037664257061*^9, 3.8280376853287077`*^9}, 
   3.828037883121891*^9, {3.828037994755659*^9, 3.828038023306951*^9}, 
   3.828038973519706*^9, {3.828039138837233*^9, 3.828039158836677*^9}, 
   3.828039551061068*^9, 3.828039651916697*^9, {3.82803992044917*^9, 
   3.828039929053303*^9}, 3.828040054577218*^9, 3.8280407697464447`*^9, {
   3.8286469144791937`*^9, 3.828646976121447*^9}, 3.828647022530549*^9, 
   3.828647147027066*^9, {3.828647205134288*^9, 3.828647211521475*^9}, 
   3.82864726522396*^9, {3.828647386374319*^9, 3.828647404568801*^9}, {
   3.8286476097314034`*^9, 3.828647639701354*^9}, {3.8286477077587852`*^9, 
   3.828647734449304*^9}, 3.828648139520978*^9, 3.828693788125243*^9, 
   3.828693882451128*^9, 3.828693935846961*^9, {3.828694176921657*^9, 
   3.828694181525034*^9}, {3.8286942366391582`*^9, 3.828694248440386*^9}, 
   3.828694330255031*^9, 3.828710783012478*^9, {3.8287108138602047`*^9, 
   3.828710819345571*^9}, {3.828710930539813*^9, 3.82871095563153*^9}, 
   3.8287123091080437`*^9, 3.828712399503759*^9, 3.828712458790243*^9, {
   3.828712534761818*^9, 3.828712557452269*^9}, 3.8287161626338377`*^9, {
   3.828716294284276*^9, 3.828716312749693*^9}, 3.8287163778733797`*^9, 
   3.828717051030943*^9, {3.828717081775515*^9, 3.8287170905246477`*^9}, 
   3.8287171488760643`*^9, 3.8287171905224533`*^9, {3.82871731802011*^9, 
   3.82871735322164*^9}, 3.828717422625012*^9, 3.828717483028571*^9, 
   3.8289652601576147`*^9, 3.828965351800434*^9, {3.828967635941729*^9, 
   3.828967654863311*^9}, {3.828990123613899*^9, 3.82899017287335*^9}, 
   3.828990203537469*^9, 3.828990251624481*^9, 3.8289903270463047`*^9},
 CellLabel->
  "Out[161]=",ExpressionUUID->"0abe8514-6d7c-4e2d-9014-01db0aa7df2d"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440, 761},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.2 for Mac OS X x86 (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"7e7b52df-039c-4b9a-8fb1-da60eed717e5"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 207, 3, 69, "Chapter",ExpressionUUID->"818c2ad3-6a9a-4903-ba69-c0dd7780c612"],
Cell[CellGroupData[{
Cell[812, 29, 220, 4, 45, "Subsubsection",ExpressionUUID->"0cf3efc0-a5a0-49a1-8a99-81d7273f1606"],
Cell[1035, 35, 3310, 83, 341, "Input",ExpressionUUID->"57041e54-ee36-440f-92a4-46c3fe028804",
 InitializationCell->True],
Cell[4348, 120, 1620, 38, 131, "Input",ExpressionUUID->"a844ee21-7da9-4555-b685-9e28ba3f7971",
 InitializationCell->True],
Cell[5971, 160, 8733, 222, 677, "Input",ExpressionUUID->"c7572464-bd93-4893-b3d2-603d04fa3529",
 InitializationCell->True],
Cell[14707, 384, 1977, 44, 152, "Input",ExpressionUUID->"a3e000a2-a08e-4266-81ba-c2107912dc04",
 InitializationCell->True],
Cell[16687, 430, 379, 7, 58, "Text",ExpressionUUID->"26ed7b5a-b5e8-41f4-ba47-fad7391bd5ed"],
Cell[17069, 439, 6851, 163, 530, "Input",ExpressionUUID->"efd066c8-6526-4d75-b2b9-1cef3ca0eb24",
 InitializationCell->True],
Cell[23923, 604, 22926, 489, 1181, "Input",ExpressionUUID->"8a35217b-af0b-4d8d-94db-2860902cf2a4",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[46886, 1098, 314, 5, 45, "Subsubsection",ExpressionUUID->"56b99d3d-c174-4a58-8196-4073c4c9888b"],
Cell[47203, 1105, 4112, 97, 236, "Input",ExpressionUUID->"dd6dd3cc-6174-4d7c-8ceb-2c81d4fb6bc0",
 InitializationCell->True],
Cell[51318, 1204, 2878, 62, 257, "Input",ExpressionUUID->"f6f6e060-07bc-45ec-aa89-5eaf7c671f86",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[54233, 1271, 319, 5, 45, "Subsubsection",ExpressionUUID->"fff93588-f784-4bde-9d48-035b33b74fbb"],
Cell[54555, 1278, 5593, 125, 341, "Input",ExpressionUUID->"fd515b46-42af-4462-9f96-281447306491",
 InitializationCell->True],
Cell[60151, 1405, 2405, 57, 257, "Input",ExpressionUUID->"0bed3e5b-3f93-4423-aa59-b591783ec6ba",
 InitializationCell->True],
Cell[62559, 1464, 2475, 54, 173, "Input",ExpressionUUID->"d312aaa7-2182-487f-89f4-f69cc031b550",
 InitializationCell->True],
Cell[65037, 1520, 2621, 64, 236, "Input",ExpressionUUID->"259d9f3f-113a-4986-8c88-69a97b8f676a",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[67683, 1588, 310, 7, 30, "Input",ExpressionUUID->"00ddc38d-189c-490e-9e33-6ac3705624ec"],
Cell[67996, 1597, 943, 13, 34, "Output",ExpressionUUID->"e7da5908-fc7e-48d5-a420-bf3db1f80d7f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[68988, 1616, 330, 5, 45, "Subsubsection",ExpressionUUID->"45dabb29-5493-4e6f-8079-168b8f7d9dc9"],
Cell[69321, 1623, 2866, 53, 173, "Input",ExpressionUUID->"443df707-1f10-4107-ad7c-4957454a535c",
 InitializationCell->True],
Cell[72190, 1678, 1041, 23, 46, "Input",ExpressionUUID->"0fb74f3d-f036-4776-810d-5797c03f36af",
 InitializationCell->True],
Cell[73234, 1703, 4442, 99, 278, "Input",ExpressionUUID->"98716ddd-8f52-4410-bcaf-7fe183121df6",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[77713, 1807, 218, 4, 45, "Subsubsection",ExpressionUUID->"60545c68-3c84-4344-89d5-7de2d537ab48"],
Cell[CellGroupData[{
Cell[77956, 1815, 9798, 213, 325, "Input",ExpressionUUID->"c91f22f1-d8f4-4197-87a7-1b892870328f"],
Cell[87757, 2030, 1460, 21, 34, "Output",ExpressionUUID->"1e89ad95-eb94-4603-89a6-321b60b84963"],
Cell[89220, 2053, 2226, 37, 303, "Output",ExpressionUUID->"39321961-8787-46ae-8ecb-9249ec525914"],
Cell[91449, 2092, 2336, 39, 303, "Output",ExpressionUUID->"067a998f-97d0-4a03-a798-ff44e5b7f881"],
Cell[93788, 2133, 3844, 59, 303, "Output",ExpressionUUID->"ccb5aba8-7450-44fb-9208-02fbff5b98c5"],
Cell[97635, 2194, 5360, 90, 303, "Output",ExpressionUUID->"6795f314-ac5f-47e4-92c6-fe780e23fe78"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[103056, 2291, 163, 3, 69, "Chapter",ExpressionUUID->"820625db-92ca-4aa7-9399-8c6b7481f298"],
Cell[CellGroupData[{
Cell[103244, 2298, 220, 4, 45, "Subsubsection",ExpressionUUID->"e34122ed-4a14-4e0c-8af0-ff206e27353b"],
Cell[103467, 2304, 3383, 84, 341, "Input",ExpressionUUID->"99e58367-76ac-4fd4-8920-7ea8dd916e8e",
 InitializationCell->True],
Cell[106853, 2390, 2672, 69, 194, "Input",ExpressionUUID->"c290eddc-7f41-490d-8987-c8e9c0e1e35e",
 InitializationCell->True],
Cell[109528, 2461, 2938, 67, 215, "Input",ExpressionUUID->"6f16e406-ef11-4223-b8dd-9ba97eb828c9",
 InitializationCell->True],
Cell[112469, 2530, 13618, 312, 1118, "Input",ExpressionUUID->"6ce00081-2d6e-44fc-a9c1-f70c490c5a40",
 InitializationCell->True],
Cell[126090, 2844, 4867, 107, 404, "Input",ExpressionUUID->"b1465758-fd8f-489d-acad-817d5f8c03f5",
 InitializationCell->True],
Cell[130960, 2953, 1604, 47, 89, "Input",ExpressionUUID->"692f4030-bb90-4d2f-9089-0fa8ff8f6b76",
 InitializationCell->True],
Cell[132567, 3002, 7044, 166, 530, "Input",ExpressionUUID->"53b752cf-6e34-40a3-a697-cfd7dbc06ca1",
 InitializationCell->True],
Cell[139614, 3170, 24124, 506, 1202, "Input",ExpressionUUID->"ea015046-0fb3-433a-be44-a743e473368e",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[163775, 3681, 370, 5, 45, "Subsubsection",ExpressionUUID->"1779e47b-3002-48ab-844b-2169551cff03"],
Cell[164148, 3688, 4168, 99, 236, "Input",ExpressionUUID->"835b3b74-f6cf-4245-900e-97e08378d075",
 InitializationCell->True],
Cell[168319, 3789, 5872, 141, 425, "Input",ExpressionUUID->"547ee091-1369-4265-a8d8-f6e8fc59da32",
 InitializationCell->True],
Cell[174194, 3932, 9606, 230, 467, "Input",ExpressionUUID->"60311f9b-f1ff-423b-b3d3-b7152c502cba",
 InitializationCell->True],
Cell[183803, 4164, 5513, 109, 236, "Input",ExpressionUUID->"a09f5df4-a740-4338-a6d4-a75bb4f482ee",
 InitializationCell->True],
Cell[189319, 4275, 2004, 42, 152, "Input",ExpressionUUID->"4de4ce7a-3d63-4f32-9e72-f012e00badd1",
 InitializationCell->True],
Cell[191326, 4319, 7277, 153, 425, "Input",ExpressionUUID->"086a9ad5-9ad8-47c6-9f13-4d34d9f07ea3",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[198640, 4477, 319, 5, 45, "Subsubsection",ExpressionUUID->"dfbd5f20-9529-401a-84c8-6d3c52c95ad7"],
Cell[198962, 4484, 5583, 125, 320, "Input",ExpressionUUID->"cb2bb02f-582e-4bc6-9473-d5a711e1003d",
 InitializationCell->True],
Cell[204548, 4611, 2483, 59, 257, "Input",ExpressionUUID->"42f7599d-8690-4853-ab62-e9cb72d4d8f8",
 InitializationCell->True],
Cell[207034, 4672, 2549, 53, 173, "Input",ExpressionUUID->"01d73e1c-e61f-455b-83ce-c84c04506609",
 InitializationCell->True],
Cell[209586, 4727, 3140, 72, 236, "Input",ExpressionUUID->"b24708f3-efa0-4f60-bfb9-a0983273be46",
 InitializationCell->True],
Cell[212729, 4801, 4139, 83, 194, "Input",ExpressionUUID->"b9d0c400-23e7-457c-aa76-5ba54eefda2c",
 InitializationCell->True],
Cell[216871, 4886, 4790, 91, 194, "Input",ExpressionUUID->"3a7b5cee-3307-4c88-b1e6-108662578107",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[221698, 4982, 330, 5, 45, "Subsubsection",ExpressionUUID->"eb7c4e41-c0f7-454d-996a-21e88629adde"],
Cell[222031, 4989, 4929, 85, 215, "Input",ExpressionUUID->"31bd69b3-b75b-4245-9600-12819e9bcd81",
 InitializationCell->True],
Cell[226963, 5076, 6959, 134, 299, "Input",ExpressionUUID->"d97ea47e-0a93-4a0e-994c-8c2e2fc448d3",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[233959, 5215, 160, 3, 45, "Subsubsection",ExpressionUUID->"bee4f3b5-c7e9-4c83-9c6b-db93d489a254"],
Cell[234122, 5220, 2431, 48, 136, "Input",ExpressionUUID->"ed55e9ec-5ff7-4338-bf72-175e2a7631cd"],
Cell[CellGroupData[{
Cell[236578, 5272, 11858, 229, 283, "Input",ExpressionUUID->"7cd56961-a230-4268-877f-bf1bbbfc3b26"],
Cell[248439, 5503, 2582, 43, 167, "Output",ExpressionUUID->"3b411223-d444-4ca6-8dd1-936ce48ce515"],
Cell[251024, 5548, 2734, 45, 167, "Output",ExpressionUUID->"10a5dc9e-755e-4195-9563-4aeccea6e6db"],
Cell[253761, 5595, 4168, 67, 167, "Output",ExpressionUUID->"f9fbe234-95a5-421f-ba7e-8030038db91c"],
Cell[257932, 5664, 6067, 102, 167, "Output",ExpressionUUID->"0abe8514-6d7c-4e2d-9014-01db0aa7df2d"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

